ddc5f929fb7d380983a07c8afc004046
'use client';
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    useEnhancedPageState: function() {
        return useEnhancedPageState;
    },
    useLegacyPageInterface: function() {
        return useLegacyPageInterface;
    },
    usePageComponentState: function() {
        return usePageComponentState;
    }
});
const _react = require("react");
const _useTryonWorkflow = require("./useTryonWorkflow");
const _index = require("./index");
/**
 * Default migration options
 */ const DEFAULT_MIGRATION_OPTIONS = {
    enableNewFeatures: true,
    showDeprecationWarnings: process.env.NODE_ENV === 'development',
    onStateChange: ()=>{},
    enhancedErrorHandling: true,
    enableProgressTracking: true
};
function useLegacyPageInterface(options = {}) {
    const finalOptions = {
        ...DEFAULT_MIGRATION_OPTIONS,
        ...options
    };
    const { showToast } = (0, _index.useToast)();
    const deprecationWarnings = (0, _react.useRef)([]);
    // Use the new workflow internally
    const workflow = (0, _useTryonWorkflow.useTryonWorkflow)({
        timeoutMs: 60000,
        compressionLimitKB: 2048,
        debug: process.env.NODE_ENV === 'development'
    }, showToast);
    // Track deprecation warnings
    const addDeprecationWarning = (0, _react.useCallback)((method, suggestion)=>{
        if (finalOptions.showDeprecationWarnings) {
            const warning = `DEPRECATED: ${method} - ${suggestion}`;
            if (!deprecationWarnings.current.includes(warning)) {
                deprecationWarnings.current.push(warning);
                console.warn(warning);
            }
        }
    }, [
        finalOptions.showDeprecationWarnings
    ]);
    // Map new state to legacy state format (exact field mapping)
    const legacyState = {
        isCapturing: workflow.isCapturing,
        leftCardImage: workflow.leftCardImage,
        rightCardImage: workflow.rightCardImage,
        showPolaroid: workflow.showPolaroid,
        userImageFile: workflow.userImageFile,
        apparelImageFile: workflow.apparelImageFile,
        generatedImage: workflow.generatedImage,
        hasError: workflow.hasError
    };
    // Notify about state changes for migration assistance
    (0, _react.useEffect)(()=>{
        if (finalOptions.onStateChange) {
            finalOptions.onStateChange(workflow, legacyState);
        }
    }, [
        workflow,
        legacyState,
        finalOptions
    ]);
    // Legacy handlers that map to new workflow methods
    const legacyHandlers = {
        handleUserFileUpload: (0, _react.useCallback)((file)=>{
            if (finalOptions.showDeprecationWarnings) {
                addDeprecationWarning('handleUserFileUpload', 'Consider using useBridgeLayer().actions.uploadUserImage for enhanced validation and progress tracking');
            }
            workflow.handleUserFileUpload(file);
        }, [
            workflow,
            addDeprecationWarning,
            finalOptions.showDeprecationWarnings
        ]),
        handleApparelFileUpload: (0, _react.useCallback)((file)=>{
            if (finalOptions.showDeprecationWarnings) {
                addDeprecationWarning('handleApparelFileUpload', 'Consider using useBridgeLayer().actions.uploadApparelImage for enhanced validation and progress tracking');
            }
            workflow.handleApparelFileUpload(file);
        }, [
            workflow,
            addDeprecationWarning,
            finalOptions.showDeprecationWarnings
        ]),
        handleLeftCardImageUpload: (0, _react.useCallback)(async (imageUrl)=>{
            if (finalOptions.showDeprecationWarnings) {
                addDeprecationWarning('handleLeftCardImageUpload', 'Consider using useBridgeLayer().actions.uploadUserImage with File objects for better type safety');
            }
            await workflow.handleLeftCardImageUpload(imageUrl);
        }, [
            workflow,
            addDeprecationWarning,
            finalOptions.showDeprecationWarnings
        ]),
        handleRightCardImageUpload: (0, _react.useCallback)(async (imageUrl)=>{
            if (finalOptions.showDeprecationWarnings) {
                addDeprecationWarning('handleRightCardImageUpload', 'Consider using useBridgeLayer().actions.uploadApparelImage with File objects for better type safety');
            }
            await workflow.handleRightCardImageUpload(imageUrl);
        }, [
            workflow,
            addDeprecationWarning,
            finalOptions.showDeprecationWarnings
        ]),
        handleCameraButtonClick: (0, _react.useCallback)(async ()=>{
            if (finalOptions.showDeprecationWarnings) {
                addDeprecationWarning('handleCameraButtonClick', 'Consider using useBridgeLayer().actions.generate for enhanced error handling and progress tracking');
            }
            await workflow.startGeneration();
        }, [
            workflow,
            addDeprecationWarning,
            finalOptions.showDeprecationWarnings
        ]),
        handleGenerationStart: (0, _react.useCallback)(()=>{
            if (finalOptions.showDeprecationWarnings) {
                addDeprecationWarning('handleGenerationStart', 'This callback is now handled automatically by the workflow. Consider using onGenerationStart in BridgeLayerConfig');
            }
            console.log('Generation started (legacy handler)');
        }, [
            addDeprecationWarning,
            finalOptions.showDeprecationWarnings
        ]),
        handleGenerationComplete: (0, _react.useCallback)((imageUrl)=>{
            if (finalOptions.showDeprecationWarnings) {
                addDeprecationWarning('handleGenerationComplete', 'This callback is now handled automatically by the workflow. Consider using onGenerationComplete in BridgeLayerConfig');
            }
            console.log('Generation complete (legacy handler):', imageUrl);
        }, [
            addDeprecationWarning,
            finalOptions.showDeprecationWarnings
        ]),
        handleClosePolaroid: (0, _react.useCallback)(()=>{
            if (finalOptions.showDeprecationWarnings) {
                addDeprecationWarning('handleClosePolaroid', 'Consider using useBridgeLayer().actions.hideResult for consistent naming');
            }
            workflow.closePolaroid();
        }, [
            workflow,
            addDeprecationWarning,
            finalOptions.showDeprecationWarnings
        ]),
        handleRetryGeneration: (0, _react.useCallback)(()=>{
            if (finalOptions.showDeprecationWarnings) {
                addDeprecationWarning('handleRetryGeneration', 'Consider using useBridgeLayer().actions.retry for enhanced retry logic');
            }
            workflow.retryGeneration();
        }, [
            workflow,
            addDeprecationWarning,
            finalOptions.showDeprecationWarnings
        ])
    };
    // Migration helper
    const migrateToNewInterface = (0, _react.useCallback)(()=>{
        return {
            // Import suggestion
            import: 'import { useBridgeLayer } from "@/hooks/useBridgeLayer"',
            // New hook usage
            hookUsage: `
const { state, actions } = useBridgeLayer({
  workflow: { timeoutMs: 60000, compressionLimitKB: 2048 },
  ui: { showDetailedProgress: true },
  callbacks: {
    onGenerationStart: () => console.log('Generation started'),
    onGenerationComplete: (imageUrl) => console.log('Generation complete:', imageUrl)
  }
});`,
            // State mapping
            stateMapping: {
                'isCapturing': 'state.isLoading',
                'leftCardImage': 'state.userImagePreview',
                'rightCardImage': 'state.apparelImagePreview',
                'showPolaroid': 'state.showResult',
                'userImageFile': 'advanced.workflow.userImageFile',
                'apparelImageFile': 'advanced.workflow.apparelImageFile',
                'generatedImage': 'state.resultImage',
                'hasError': '!!state.errorMessage'
            },
            // Action mapping
            actionMapping: {
                'handleUserFileUpload': 'actions.uploadUserImage',
                'handleApparelFileUpload': 'actions.uploadApparelImage',
                'handleCameraButtonClick': 'actions.generate',
                'handleClosePolaroid': 'actions.hideResult',
                'handleRetryGeneration': 'actions.retry'
            },
            // Enhanced features available
            enhancedFeatures: [
                'Built-in validation with user-friendly error messages',
                'Progress tracking with detailed status updates',
                'Automatic retry logic with exponential backoff',
                'Thumbnail generation and preview management',
                'Drag and drop support',
                'Image processing and optimization',
                'Download and share functionality',
                'Type-safe interfaces throughout'
            ]
        };
    }, []);
    return {
        // Legacy state (exact match)
        ...legacyState,
        // Legacy handlers (exact match)
        ...legacyHandlers,
        // Migration assistance
        migration: {
            isUsingNewArchitecture: true,
            newWorkflowState: workflow.workflowState,
            deprecationWarnings: deprecationWarnings.current,
            migrateToNewInterface
        }
    };
}
function usePageComponentState() {
    const compatibility = useLegacyPageInterface();
    // Return only the exact state and handlers that page.tsx expects
    return {
        isCapturing: compatibility.isCapturing,
        leftCardImage: compatibility.leftCardImage,
        rightCardImage: compatibility.rightCardImage,
        showPolaroid: compatibility.showPolaroid,
        userImageFile: compatibility.userImageFile,
        apparelImageFile: compatibility.apparelImageFile,
        generatedImage: compatibility.generatedImage,
        hasError: compatibility.hasError,
        handleUserFileUpload: compatibility.handleUserFileUpload,
        handleApparelFileUpload: compatibility.handleApparelFileUpload,
        handleLeftCardImageUpload: compatibility.handleLeftCardImageUpload,
        handleRightCardImageUpload: compatibility.handleRightCardImageUpload,
        handleCameraButtonClick: compatibility.handleCameraButtonClick,
        handleGenerationStart: compatibility.handleGenerationStart,
        handleGenerationComplete: compatibility.handleGenerationComplete,
        handleClosePolaroid: compatibility.handleClosePolaroid,
        handleRetryGeneration: compatibility.handleRetryGeneration
    };
}
function useEnhancedPageState(migrationOptions = {}) {
    const compatibility = useLegacyPageInterface(migrationOptions);
    return {
        // All legacy functionality
        ...compatibility,
        // Additional enhanced features
        enhanced: {
            progress: compatibility.migration.newWorkflowState === WorkflowState.GENERATING ? compatibility.progress || 0 : 0,
            canGenerate: !compatibility.isCapturing && !!compatibility.userImageFile && !!compatibility.apparelImageFile,
            canRetry: compatibility.hasError,
            validationErrors: [],
            // New enhanced actions
            reset: ()=>compatibility.resetWorkflow?.(),
            clearError: ()=>compatibility.clearError?.(),
            // Migration helper
            getMigrationGuide: compatibility.migration.migrateToNewInterface
        }
    };
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy93aWxsc3RyZWV0ZXIvV2Vic3Rvcm1Qcm9qZWN0cy92aWJlLWNvZGluZy90aG9zZS1wZW9wbGUvVGhlLVN1cy1GaXQtZ3Avc3JjL2hvb2tzL3VzZUJhY2t3YXJkQ29tcGF0aWJpbGl0eS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIGNsaWVudCc7XG5cbi8vIEJhY2t3YXJkIENvbXBhdGliaWxpdHkgTGF5ZXJcbi8vIE1haW50YWlucyBjb21wYXRpYmlsaXR5IHdpdGggZXhpc3RpbmcgcGFnZSBjb21wb25lbnQgc3RhdGUgc3RydWN0dXJlIHdoaWxlIHByb3ZpZGluZyBtaWdyYXRpb24gcGF0aFxuXG5pbXBvcnQgeyB1c2VDYWxsYmFjaywgdXNlRWZmZWN0LCB1c2VSZWYgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyB1c2VUcnlvbldvcmtmbG93LCB0eXBlIFdvcmtmbG93U3RhdGUgfSBmcm9tICcuL3VzZVRyeW9uV29ya2Zsb3cnO1xuaW1wb3J0IHsgdXNlVG9hc3QgfSBmcm9tICcuL2luZGV4JztcblxuLyoqXG4gKiBMZWdhY3kgcGFnZSBjb21wb25lbnQgc3RhdGUgaW50ZXJmYWNlIChleGFjdCBtYXRjaCBmcm9tIHBhZ2UudHN4KVxuICovXG5leHBvcnQgaW50ZXJmYWNlIExlZ2FjeVBhZ2VTdGF0ZSB7XG4gIGlzQ2FwdHVyaW5nOiBib29sZWFuO1xuICBsZWZ0Q2FyZEltYWdlOiBzdHJpbmcgfCBudWxsO1xuICByaWdodENhcmRJbWFnZTogc3RyaW5nIHwgbnVsbDtcbiAgc2hvd1BvbGFyb2lkOiBib29sZWFuO1xuICB1c2VySW1hZ2VGaWxlOiBGaWxlIHwgbnVsbDtcbiAgYXBwYXJlbEltYWdlRmlsZTogRmlsZSB8IG51bGw7XG4gIGdlbmVyYXRlZEltYWdlOiBzdHJpbmcgfCBudWxsO1xuICBoYXNFcnJvcjogYm9vbGVhbjtcbn1cblxuLyoqXG4gKiBMZWdhY3kgcGFnZSBjb21wb25lbnQgaGFuZGxlcnMgaW50ZXJmYWNlIChleGFjdCBtYXRjaCBmcm9tIHBhZ2UudHN4KVxuICovXG5leHBvcnQgaW50ZXJmYWNlIExlZ2FjeVBhZ2VIYW5kbGVycyB7XG4gIGhhbmRsZVVzZXJGaWxlVXBsb2FkOiAoZmlsZTogRmlsZSkgPT4gdm9pZDtcbiAgaGFuZGxlQXBwYXJlbEZpbGVVcGxvYWQ6IChmaWxlOiBGaWxlKSA9PiB2b2lkO1xuICBoYW5kbGVMZWZ0Q2FyZEltYWdlVXBsb2FkOiAoaW1hZ2VVcmw6IHN0cmluZykgPT4gUHJvbWlzZTx2b2lkPjtcbiAgaGFuZGxlUmlnaHRDYXJkSW1hZ2VVcGxvYWQ6IChpbWFnZVVybDogc3RyaW5nKSA9PiBQcm9taXNlPHZvaWQ+O1xuICBoYW5kbGVDYW1lcmFCdXR0b25DbGljazogKCkgPT4gUHJvbWlzZTx2b2lkPjtcbiAgaGFuZGxlR2VuZXJhdGlvblN0YXJ0OiAoKSA9PiB2b2lkO1xuICBoYW5kbGVHZW5lcmF0aW9uQ29tcGxldGU6IChpbWFnZVVybDogc3RyaW5nKSA9PiB2b2lkO1xuICBoYW5kbGVDbG9zZVBvbGFyb2lkOiAoKSA9PiB2b2lkO1xuICBoYW5kbGVSZXRyeUdlbmVyYXRpb246ICgpID0+IHZvaWQ7XG59XG5cbi8qKlxuICogTWlncmF0aW9uIG9wdGlvbnMgZm9yIGdyYWR1YWwgdHJhbnNpdGlvblxuICovXG5leHBvcnQgaW50ZXJmYWNlIE1pZ3JhdGlvbk9wdGlvbnMge1xuICAvKiogRW5hYmxlIG5ldyBmZWF0dXJlcyB3aGlsZSBtYWludGFpbmluZyBsZWdhY3kgaW50ZXJmYWNlICovXG4gIGVuYWJsZU5ld0ZlYXR1cmVzPzogYm9vbGVhbjtcbiAgLyoqIFNob3cgZGVwcmVjYXRpb24gd2FybmluZ3MgaW4gZGV2ZWxvcG1lbnQgKi9cbiAgc2hvd0RlcHJlY2F0aW9uV2FybmluZ3M/OiBib29sZWFuO1xuICAvKiogQ3VzdG9tIG1pZ3JhdGlvbiBjYWxsYmFja3MgKi9cbiAgb25TdGF0ZUNoYW5nZT86IChuZXdTdGF0ZTogYW55LCBsZWdhY3lTdGF0ZTogTGVnYWN5UGFnZVN0YXRlKSA9PiB2b2lkO1xuICAvKiogRW5hYmxlIGVuaGFuY2VkIGVycm9yIGhhbmRsaW5nICovXG4gIGVuaGFuY2VkRXJyb3JIYW5kbGluZz86IGJvb2xlYW47XG4gIC8qKiBFbmFibGUgcHJvZ3Jlc3MgdHJhY2tpbmcgKi9cbiAgZW5hYmxlUHJvZ3Jlc3NUcmFja2luZz86IGJvb2xlYW47XG59XG5cbi8qKlxuICogRGVmYXVsdCBtaWdyYXRpb24gb3B0aW9uc1xuICovXG5jb25zdCBERUZBVUxUX01JR1JBVElPTl9PUFRJT05TOiBSZXF1aXJlZDxNaWdyYXRpb25PcHRpb25zPiA9IHtcbiAgZW5hYmxlTmV3RmVhdHVyZXM6IHRydWUsXG4gIHNob3dEZXByZWNhdGlvbldhcm5pbmdzOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyxcbiAgb25TdGF0ZUNoYW5nZTogKCkgPT4ge30sXG4gIGVuaGFuY2VkRXJyb3JIYW5kbGluZzogdHJ1ZSxcbiAgZW5hYmxlUHJvZ3Jlc3NUcmFja2luZzogdHJ1ZVxufTtcblxuLyoqXG4gKiBCYWNrd2FyZCBjb21wYXRpYmlsaXR5IGhvb2sgdGhhdCBwcm92aWRlcyBleGFjdCBsZWdhY3kgaW50ZXJmYWNlXG4gKiB3aGlsZSBpbnRlcm5hbGx5IHVzaW5nIHRoZSBuZXcgYnJpZGdlIGxheWVyIGFyY2hpdGVjdHVyZVxuICovXG5leHBvcnQgZnVuY3Rpb24gdXNlTGVnYWN5UGFnZUludGVyZmFjZShcbiAgb3B0aW9uczogTWlncmF0aW9uT3B0aW9ucyA9IHt9XG4pOiBMZWdhY3lQYWdlU3RhdGUgJiBMZWdhY3lQYWdlSGFuZGxlcnMgJiB7XG4gIC8vIEFkZGl0aW9uYWwgaGVscGVyIG1ldGhvZHMgZm9yIG1pZ3JhdGlvblxuICBtaWdyYXRpb246IHtcbiAgICBpc1VzaW5nTmV3QXJjaGl0ZWN0dXJlOiBib29sZWFuO1xuICAgIG5ld1dvcmtmbG93U3RhdGU6IFdvcmtmbG93U3RhdGU7XG4gICAgZGVwcmVjYXRpb25XYXJuaW5nczogc3RyaW5nW107XG4gICAgbWlncmF0ZVRvTmV3SW50ZXJmYWNlOiAoKSA9PiBhbnk7XG4gIH07XG59IHtcbiAgY29uc3QgZmluYWxPcHRpb25zID0geyAuLi5ERUZBVUxUX01JR1JBVElPTl9PUFRJT05TLCAuLi5vcHRpb25zIH07XG4gIGNvbnN0IHsgc2hvd1RvYXN0IH0gPSB1c2VUb2FzdCgpO1xuICBjb25zdCBkZXByZWNhdGlvbldhcm5pbmdzID0gdXNlUmVmPHN0cmluZ1tdPihbXSk7XG5cbiAgLy8gVXNlIHRoZSBuZXcgd29ya2Zsb3cgaW50ZXJuYWxseVxuICBjb25zdCB3b3JrZmxvdyA9IHVzZVRyeW9uV29ya2Zsb3coXG4gICAge1xuICAgICAgdGltZW91dE1zOiA2MDAwMCxcbiAgICAgIGNvbXByZXNzaW9uTGltaXRLQjogMjA0OCxcbiAgICAgIGRlYnVnOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50J1xuICAgIH0sXG4gICAgc2hvd1RvYXN0XG4gICk7XG5cbiAgLy8gVHJhY2sgZGVwcmVjYXRpb24gd2FybmluZ3NcbiAgY29uc3QgYWRkRGVwcmVjYXRpb25XYXJuaW5nID0gdXNlQ2FsbGJhY2soKG1ldGhvZDogc3RyaW5nLCBzdWdnZXN0aW9uOiBzdHJpbmcpID0+IHtcbiAgICBpZiAoZmluYWxPcHRpb25zLnNob3dEZXByZWNhdGlvbldhcm5pbmdzKSB7XG4gICAgICBjb25zdCB3YXJuaW5nID0gYERFUFJFQ0FURUQ6ICR7bWV0aG9kfSAtICR7c3VnZ2VzdGlvbn1gO1xuICAgICAgaWYgKCFkZXByZWNhdGlvbldhcm5pbmdzLmN1cnJlbnQuaW5jbHVkZXMod2FybmluZykpIHtcbiAgICAgICAgZGVwcmVjYXRpb25XYXJuaW5ncy5jdXJyZW50LnB1c2god2FybmluZyk7XG4gICAgICAgIGNvbnNvbGUud2Fybih3YXJuaW5nKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIFtmaW5hbE9wdGlvbnMuc2hvd0RlcHJlY2F0aW9uV2FybmluZ3NdKTtcblxuICAvLyBNYXAgbmV3IHN0YXRlIHRvIGxlZ2FjeSBzdGF0ZSBmb3JtYXQgKGV4YWN0IGZpZWxkIG1hcHBpbmcpXG4gIGNvbnN0IGxlZ2FjeVN0YXRlOiBMZWdhY3lQYWdlU3RhdGUgPSB7XG4gICAgaXNDYXB0dXJpbmc6IHdvcmtmbG93LmlzQ2FwdHVyaW5nLFxuICAgIGxlZnRDYXJkSW1hZ2U6IHdvcmtmbG93LmxlZnRDYXJkSW1hZ2UsXG4gICAgcmlnaHRDYXJkSW1hZ2U6IHdvcmtmbG93LnJpZ2h0Q2FyZEltYWdlLFxuICAgIHNob3dQb2xhcm9pZDogd29ya2Zsb3cuc2hvd1BvbGFyb2lkLFxuICAgIHVzZXJJbWFnZUZpbGU6IHdvcmtmbG93LnVzZXJJbWFnZUZpbGUsXG4gICAgYXBwYXJlbEltYWdlRmlsZTogd29ya2Zsb3cuYXBwYXJlbEltYWdlRmlsZSxcbiAgICBnZW5lcmF0ZWRJbWFnZTogd29ya2Zsb3cuZ2VuZXJhdGVkSW1hZ2UsXG4gICAgaGFzRXJyb3I6IHdvcmtmbG93Lmhhc0Vycm9yXG4gIH07XG5cbiAgLy8gTm90aWZ5IGFib3V0IHN0YXRlIGNoYW5nZXMgZm9yIG1pZ3JhdGlvbiBhc3Npc3RhbmNlXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKGZpbmFsT3B0aW9ucy5vblN0YXRlQ2hhbmdlKSB7XG4gICAgICBmaW5hbE9wdGlvbnMub25TdGF0ZUNoYW5nZSh3b3JrZmxvdywgbGVnYWN5U3RhdGUpO1xuICAgIH1cbiAgfSwgW3dvcmtmbG93LCBsZWdhY3lTdGF0ZSwgZmluYWxPcHRpb25zXSk7XG5cbiAgLy8gTGVnYWN5IGhhbmRsZXJzIHRoYXQgbWFwIHRvIG5ldyB3b3JrZmxvdyBtZXRob2RzXG4gIGNvbnN0IGxlZ2FjeUhhbmRsZXJzOiBMZWdhY3lQYWdlSGFuZGxlcnMgPSB7XG4gICAgaGFuZGxlVXNlckZpbGVVcGxvYWQ6IHVzZUNhbGxiYWNrKChmaWxlOiBGaWxlKSA9PiB7XG4gICAgICBpZiAoZmluYWxPcHRpb25zLnNob3dEZXByZWNhdGlvbldhcm5pbmdzKSB7XG4gICAgICAgIGFkZERlcHJlY2F0aW9uV2FybmluZyhcbiAgICAgICAgICAnaGFuZGxlVXNlckZpbGVVcGxvYWQnLCBcbiAgICAgICAgICAnQ29uc2lkZXIgdXNpbmcgdXNlQnJpZGdlTGF5ZXIoKS5hY3Rpb25zLnVwbG9hZFVzZXJJbWFnZSBmb3IgZW5oYW5jZWQgdmFsaWRhdGlvbiBhbmQgcHJvZ3Jlc3MgdHJhY2tpbmcnXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICB3b3JrZmxvdy5oYW5kbGVVc2VyRmlsZVVwbG9hZChmaWxlKTtcbiAgICB9LCBbd29ya2Zsb3csIGFkZERlcHJlY2F0aW9uV2FybmluZywgZmluYWxPcHRpb25zLnNob3dEZXByZWNhdGlvbldhcm5pbmdzXSksXG5cbiAgICBoYW5kbGVBcHBhcmVsRmlsZVVwbG9hZDogdXNlQ2FsbGJhY2soKGZpbGU6IEZpbGUpID0+IHtcbiAgICAgIGlmIChmaW5hbE9wdGlvbnMuc2hvd0RlcHJlY2F0aW9uV2FybmluZ3MpIHtcbiAgICAgICAgYWRkRGVwcmVjYXRpb25XYXJuaW5nKFxuICAgICAgICAgICdoYW5kbGVBcHBhcmVsRmlsZVVwbG9hZCcsIFxuICAgICAgICAgICdDb25zaWRlciB1c2luZyB1c2VCcmlkZ2VMYXllcigpLmFjdGlvbnMudXBsb2FkQXBwYXJlbEltYWdlIGZvciBlbmhhbmNlZCB2YWxpZGF0aW9uIGFuZCBwcm9ncmVzcyB0cmFja2luZydcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHdvcmtmbG93LmhhbmRsZUFwcGFyZWxGaWxlVXBsb2FkKGZpbGUpO1xuICAgIH0sIFt3b3JrZmxvdywgYWRkRGVwcmVjYXRpb25XYXJuaW5nLCBmaW5hbE9wdGlvbnMuc2hvd0RlcHJlY2F0aW9uV2FybmluZ3NdKSxcblxuICAgIGhhbmRsZUxlZnRDYXJkSW1hZ2VVcGxvYWQ6IHVzZUNhbGxiYWNrKGFzeW5jIChpbWFnZVVybDogc3RyaW5nKSA9PiB7XG4gICAgICBpZiAoZmluYWxPcHRpb25zLnNob3dEZXByZWNhdGlvbldhcm5pbmdzKSB7XG4gICAgICAgIGFkZERlcHJlY2F0aW9uV2FybmluZyhcbiAgICAgICAgICAnaGFuZGxlTGVmdENhcmRJbWFnZVVwbG9hZCcsIFxuICAgICAgICAgICdDb25zaWRlciB1c2luZyB1c2VCcmlkZ2VMYXllcigpLmFjdGlvbnMudXBsb2FkVXNlckltYWdlIHdpdGggRmlsZSBvYmplY3RzIGZvciBiZXR0ZXIgdHlwZSBzYWZldHknXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICBhd2FpdCB3b3JrZmxvdy5oYW5kbGVMZWZ0Q2FyZEltYWdlVXBsb2FkKGltYWdlVXJsKTtcbiAgICB9LCBbd29ya2Zsb3csIGFkZERlcHJlY2F0aW9uV2FybmluZywgZmluYWxPcHRpb25zLnNob3dEZXByZWNhdGlvbldhcm5pbmdzXSksXG5cbiAgICBoYW5kbGVSaWdodENhcmRJbWFnZVVwbG9hZDogdXNlQ2FsbGJhY2soYXN5bmMgKGltYWdlVXJsOiBzdHJpbmcpID0+IHtcbiAgICAgIGlmIChmaW5hbE9wdGlvbnMuc2hvd0RlcHJlY2F0aW9uV2FybmluZ3MpIHtcbiAgICAgICAgYWRkRGVwcmVjYXRpb25XYXJuaW5nKFxuICAgICAgICAgICdoYW5kbGVSaWdodENhcmRJbWFnZVVwbG9hZCcsIFxuICAgICAgICAgICdDb25zaWRlciB1c2luZyB1c2VCcmlkZ2VMYXllcigpLmFjdGlvbnMudXBsb2FkQXBwYXJlbEltYWdlIHdpdGggRmlsZSBvYmplY3RzIGZvciBiZXR0ZXIgdHlwZSBzYWZldHknXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICBhd2FpdCB3b3JrZmxvdy5oYW5kbGVSaWdodENhcmRJbWFnZVVwbG9hZChpbWFnZVVybCk7XG4gICAgfSwgW3dvcmtmbG93LCBhZGREZXByZWNhdGlvbldhcm5pbmcsIGZpbmFsT3B0aW9ucy5zaG93RGVwcmVjYXRpb25XYXJuaW5nc10pLFxuXG4gICAgaGFuZGxlQ2FtZXJhQnV0dG9uQ2xpY2s6IHVzZUNhbGxiYWNrKGFzeW5jICgpID0+IHtcbiAgICAgIGlmIChmaW5hbE9wdGlvbnMuc2hvd0RlcHJlY2F0aW9uV2FybmluZ3MpIHtcbiAgICAgICAgYWRkRGVwcmVjYXRpb25XYXJuaW5nKFxuICAgICAgICAgICdoYW5kbGVDYW1lcmFCdXR0b25DbGljaycsIFxuICAgICAgICAgICdDb25zaWRlciB1c2luZyB1c2VCcmlkZ2VMYXllcigpLmFjdGlvbnMuZ2VuZXJhdGUgZm9yIGVuaGFuY2VkIGVycm9yIGhhbmRsaW5nIGFuZCBwcm9ncmVzcyB0cmFja2luZydcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIGF3YWl0IHdvcmtmbG93LnN0YXJ0R2VuZXJhdGlvbigpO1xuICAgIH0sIFt3b3JrZmxvdywgYWRkRGVwcmVjYXRpb25XYXJuaW5nLCBmaW5hbE9wdGlvbnMuc2hvd0RlcHJlY2F0aW9uV2FybmluZ3NdKSxcblxuICAgIGhhbmRsZUdlbmVyYXRpb25TdGFydDogdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgICAgaWYgKGZpbmFsT3B0aW9ucy5zaG93RGVwcmVjYXRpb25XYXJuaW5ncykge1xuICAgICAgICBhZGREZXByZWNhdGlvbldhcm5pbmcoXG4gICAgICAgICAgJ2hhbmRsZUdlbmVyYXRpb25TdGFydCcsIFxuICAgICAgICAgICdUaGlzIGNhbGxiYWNrIGlzIG5vdyBoYW5kbGVkIGF1dG9tYXRpY2FsbHkgYnkgdGhlIHdvcmtmbG93LiBDb25zaWRlciB1c2luZyBvbkdlbmVyYXRpb25TdGFydCBpbiBCcmlkZ2VMYXllckNvbmZpZydcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIGNvbnNvbGUubG9nKCdHZW5lcmF0aW9uIHN0YXJ0ZWQgKGxlZ2FjeSBoYW5kbGVyKScpO1xuICAgIH0sIFthZGREZXByZWNhdGlvbldhcm5pbmcsIGZpbmFsT3B0aW9ucy5zaG93RGVwcmVjYXRpb25XYXJuaW5nc10pLFxuXG4gICAgaGFuZGxlR2VuZXJhdGlvbkNvbXBsZXRlOiB1c2VDYWxsYmFjaygoaW1hZ2VVcmw6IHN0cmluZykgPT4ge1xuICAgICAgaWYgKGZpbmFsT3B0aW9ucy5zaG93RGVwcmVjYXRpb25XYXJuaW5ncykge1xuICAgICAgICBhZGREZXByZWNhdGlvbldhcm5pbmcoXG4gICAgICAgICAgJ2hhbmRsZUdlbmVyYXRpb25Db21wbGV0ZScsIFxuICAgICAgICAgICdUaGlzIGNhbGxiYWNrIGlzIG5vdyBoYW5kbGVkIGF1dG9tYXRpY2FsbHkgYnkgdGhlIHdvcmtmbG93LiBDb25zaWRlciB1c2luZyBvbkdlbmVyYXRpb25Db21wbGV0ZSBpbiBCcmlkZ2VMYXllckNvbmZpZydcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIGNvbnNvbGUubG9nKCdHZW5lcmF0aW9uIGNvbXBsZXRlIChsZWdhY3kgaGFuZGxlcik6JywgaW1hZ2VVcmwpO1xuICAgIH0sIFthZGREZXByZWNhdGlvbldhcm5pbmcsIGZpbmFsT3B0aW9ucy5zaG93RGVwcmVjYXRpb25XYXJuaW5nc10pLFxuXG4gICAgaGFuZGxlQ2xvc2VQb2xhcm9pZDogdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgICAgaWYgKGZpbmFsT3B0aW9ucy5zaG93RGVwcmVjYXRpb25XYXJuaW5ncykge1xuICAgICAgICBhZGREZXByZWNhdGlvbldhcm5pbmcoXG4gICAgICAgICAgJ2hhbmRsZUNsb3NlUG9sYXJvaWQnLCBcbiAgICAgICAgICAnQ29uc2lkZXIgdXNpbmcgdXNlQnJpZGdlTGF5ZXIoKS5hY3Rpb25zLmhpZGVSZXN1bHQgZm9yIGNvbnNpc3RlbnQgbmFtaW5nJ1xuICAgICAgICApO1xuICAgICAgfVxuICAgICAgd29ya2Zsb3cuY2xvc2VQb2xhcm9pZCgpO1xuICAgIH0sIFt3b3JrZmxvdywgYWRkRGVwcmVjYXRpb25XYXJuaW5nLCBmaW5hbE9wdGlvbnMuc2hvd0RlcHJlY2F0aW9uV2FybmluZ3NdKSxcblxuICAgIGhhbmRsZVJldHJ5R2VuZXJhdGlvbjogdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgICAgaWYgKGZpbmFsT3B0aW9ucy5zaG93RGVwcmVjYXRpb25XYXJuaW5ncykge1xuICAgICAgICBhZGREZXByZWNhdGlvbldhcm5pbmcoXG4gICAgICAgICAgJ2hhbmRsZVJldHJ5R2VuZXJhdGlvbicsIFxuICAgICAgICAgICdDb25zaWRlciB1c2luZyB1c2VCcmlkZ2VMYXllcigpLmFjdGlvbnMucmV0cnkgZm9yIGVuaGFuY2VkIHJldHJ5IGxvZ2ljJ1xuICAgICAgICApO1xuICAgICAgfVxuICAgICAgd29ya2Zsb3cucmV0cnlHZW5lcmF0aW9uKCk7XG4gICAgfSwgW3dvcmtmbG93LCBhZGREZXByZWNhdGlvbldhcm5pbmcsIGZpbmFsT3B0aW9ucy5zaG93RGVwcmVjYXRpb25XYXJuaW5nc10pXG4gIH07XG5cbiAgLy8gTWlncmF0aW9uIGhlbHBlclxuICBjb25zdCBtaWdyYXRlVG9OZXdJbnRlcmZhY2UgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC8vIEltcG9ydCBzdWdnZXN0aW9uXG4gICAgICBpbXBvcnQ6ICdpbXBvcnQgeyB1c2VCcmlkZ2VMYXllciB9IGZyb20gXCJAL2hvb2tzL3VzZUJyaWRnZUxheWVyXCInLFxuICAgICAgXG4gICAgICAvLyBOZXcgaG9vayB1c2FnZVxuICAgICAgaG9va1VzYWdlOiBgXG5jb25zdCB7IHN0YXRlLCBhY3Rpb25zIH0gPSB1c2VCcmlkZ2VMYXllcih7XG4gIHdvcmtmbG93OiB7IHRpbWVvdXRNczogNjAwMDAsIGNvbXByZXNzaW9uTGltaXRLQjogMjA0OCB9LFxuICB1aTogeyBzaG93RGV0YWlsZWRQcm9ncmVzczogdHJ1ZSB9LFxuICBjYWxsYmFja3M6IHtcbiAgICBvbkdlbmVyYXRpb25TdGFydDogKCkgPT4gY29uc29sZS5sb2coJ0dlbmVyYXRpb24gc3RhcnRlZCcpLFxuICAgIG9uR2VuZXJhdGlvbkNvbXBsZXRlOiAoaW1hZ2VVcmwpID0+IGNvbnNvbGUubG9nKCdHZW5lcmF0aW9uIGNvbXBsZXRlOicsIGltYWdlVXJsKVxuICB9XG59KTtgLFxuICAgICAgXG4gICAgICAvLyBTdGF0ZSBtYXBwaW5nXG4gICAgICBzdGF0ZU1hcHBpbmc6IHtcbiAgICAgICAgJ2lzQ2FwdHVyaW5nJzogJ3N0YXRlLmlzTG9hZGluZycsXG4gICAgICAgICdsZWZ0Q2FyZEltYWdlJzogJ3N0YXRlLnVzZXJJbWFnZVByZXZpZXcnLFxuICAgICAgICAncmlnaHRDYXJkSW1hZ2UnOiAnc3RhdGUuYXBwYXJlbEltYWdlUHJldmlldycsIFxuICAgICAgICAnc2hvd1BvbGFyb2lkJzogJ3N0YXRlLnNob3dSZXN1bHQnLFxuICAgICAgICAndXNlckltYWdlRmlsZSc6ICdhZHZhbmNlZC53b3JrZmxvdy51c2VySW1hZ2VGaWxlJyxcbiAgICAgICAgJ2FwcGFyZWxJbWFnZUZpbGUnOiAnYWR2YW5jZWQud29ya2Zsb3cuYXBwYXJlbEltYWdlRmlsZScsXG4gICAgICAgICdnZW5lcmF0ZWRJbWFnZSc6ICdzdGF0ZS5yZXN1bHRJbWFnZScsXG4gICAgICAgICdoYXNFcnJvcic6ICchIXN0YXRlLmVycm9yTWVzc2FnZSdcbiAgICAgIH0sXG4gICAgICBcbiAgICAgIC8vIEFjdGlvbiBtYXBwaW5nXG4gICAgICBhY3Rpb25NYXBwaW5nOiB7XG4gICAgICAgICdoYW5kbGVVc2VyRmlsZVVwbG9hZCc6ICdhY3Rpb25zLnVwbG9hZFVzZXJJbWFnZScsXG4gICAgICAgICdoYW5kbGVBcHBhcmVsRmlsZVVwbG9hZCc6ICdhY3Rpb25zLnVwbG9hZEFwcGFyZWxJbWFnZScsXG4gICAgICAgICdoYW5kbGVDYW1lcmFCdXR0b25DbGljayc6ICdhY3Rpb25zLmdlbmVyYXRlJyxcbiAgICAgICAgJ2hhbmRsZUNsb3NlUG9sYXJvaWQnOiAnYWN0aW9ucy5oaWRlUmVzdWx0JyxcbiAgICAgICAgJ2hhbmRsZVJldHJ5R2VuZXJhdGlvbic6ICdhY3Rpb25zLnJldHJ5J1xuICAgICAgfSxcbiAgICAgIFxuICAgICAgLy8gRW5oYW5jZWQgZmVhdHVyZXMgYXZhaWxhYmxlXG4gICAgICBlbmhhbmNlZEZlYXR1cmVzOiBbXG4gICAgICAgICdCdWlsdC1pbiB2YWxpZGF0aW9uIHdpdGggdXNlci1mcmllbmRseSBlcnJvciBtZXNzYWdlcycsXG4gICAgICAgICdQcm9ncmVzcyB0cmFja2luZyB3aXRoIGRldGFpbGVkIHN0YXR1cyB1cGRhdGVzJyxcbiAgICAgICAgJ0F1dG9tYXRpYyByZXRyeSBsb2dpYyB3aXRoIGV4cG9uZW50aWFsIGJhY2tvZmYnLFxuICAgICAgICAnVGh1bWJuYWlsIGdlbmVyYXRpb24gYW5kIHByZXZpZXcgbWFuYWdlbWVudCcsXG4gICAgICAgICdEcmFnIGFuZCBkcm9wIHN1cHBvcnQnLFxuICAgICAgICAnSW1hZ2UgcHJvY2Vzc2luZyBhbmQgb3B0aW1pemF0aW9uJyxcbiAgICAgICAgJ0Rvd25sb2FkIGFuZCBzaGFyZSBmdW5jdGlvbmFsaXR5JyxcbiAgICAgICAgJ1R5cGUtc2FmZSBpbnRlcmZhY2VzIHRocm91Z2hvdXQnXG4gICAgICBdXG4gICAgfTtcbiAgfSwgW10pO1xuXG4gIHJldHVybiB7XG4gICAgLy8gTGVnYWN5IHN0YXRlIChleGFjdCBtYXRjaClcbiAgICAuLi5sZWdhY3lTdGF0ZSxcbiAgICBcbiAgICAvLyBMZWdhY3kgaGFuZGxlcnMgKGV4YWN0IG1hdGNoKVxuICAgIC4uLmxlZ2FjeUhhbmRsZXJzLFxuICAgIFxuICAgIC8vIE1pZ3JhdGlvbiBhc3Npc3RhbmNlXG4gICAgbWlncmF0aW9uOiB7XG4gICAgICBpc1VzaW5nTmV3QXJjaGl0ZWN0dXJlOiB0cnVlLFxuICAgICAgbmV3V29ya2Zsb3dTdGF0ZTogd29ya2Zsb3cud29ya2Zsb3dTdGF0ZSxcbiAgICAgIGRlcHJlY2F0aW9uV2FybmluZ3M6IGRlcHJlY2F0aW9uV2FybmluZ3MuY3VycmVudCxcbiAgICAgIG1pZ3JhdGVUb05ld0ludGVyZmFjZVxuICAgIH1cbiAgfTtcbn1cblxuLyoqXG4gKiBEaXJlY3QgcmVwbGFjZW1lbnQgaG9vayBmb3IgZXhpc3RpbmcgcGFnZS50c3hcbiAqIERyb3AtaW4gcmVwbGFjZW1lbnQgdGhhdCByZXF1aXJlcyBubyBjb2RlIGNoYW5nZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZVBhZ2VDb21wb25lbnRTdGF0ZSgpIHtcbiAgY29uc3QgY29tcGF0aWJpbGl0eSA9IHVzZUxlZ2FjeVBhZ2VJbnRlcmZhY2UoKTtcbiAgXG4gIC8vIFJldHVybiBvbmx5IHRoZSBleGFjdCBzdGF0ZSBhbmQgaGFuZGxlcnMgdGhhdCBwYWdlLnRzeCBleHBlY3RzXG4gIHJldHVybiB7XG4gICAgaXNDYXB0dXJpbmc6IGNvbXBhdGliaWxpdHkuaXNDYXB0dXJpbmcsXG4gICAgbGVmdENhcmRJbWFnZTogY29tcGF0aWJpbGl0eS5sZWZ0Q2FyZEltYWdlLFxuICAgIHJpZ2h0Q2FyZEltYWdlOiBjb21wYXRpYmlsaXR5LnJpZ2h0Q2FyZEltYWdlLFxuICAgIHNob3dQb2xhcm9pZDogY29tcGF0aWJpbGl0eS5zaG93UG9sYXJvaWQsXG4gICAgdXNlckltYWdlRmlsZTogY29tcGF0aWJpbGl0eS51c2VySW1hZ2VGaWxlLFxuICAgIGFwcGFyZWxJbWFnZUZpbGU6IGNvbXBhdGliaWxpdHkuYXBwYXJlbEltYWdlRmlsZSxcbiAgICBnZW5lcmF0ZWRJbWFnZTogY29tcGF0aWJpbGl0eS5nZW5lcmF0ZWRJbWFnZSxcbiAgICBoYXNFcnJvcjogY29tcGF0aWJpbGl0eS5oYXNFcnJvcixcbiAgICBcbiAgICBoYW5kbGVVc2VyRmlsZVVwbG9hZDogY29tcGF0aWJpbGl0eS5oYW5kbGVVc2VyRmlsZVVwbG9hZCxcbiAgICBoYW5kbGVBcHBhcmVsRmlsZVVwbG9hZDogY29tcGF0aWJpbGl0eS5oYW5kbGVBcHBhcmVsRmlsZVVwbG9hZCxcbiAgICBoYW5kbGVMZWZ0Q2FyZEltYWdlVXBsb2FkOiBjb21wYXRpYmlsaXR5LmhhbmRsZUxlZnRDYXJkSW1hZ2VVcGxvYWQsXG4gICAgaGFuZGxlUmlnaHRDYXJkSW1hZ2VVcGxvYWQ6IGNvbXBhdGliaWxpdHkuaGFuZGxlUmlnaHRDYXJkSW1hZ2VVcGxvYWQsXG4gICAgaGFuZGxlQ2FtZXJhQnV0dG9uQ2xpY2s6IGNvbXBhdGliaWxpdHkuaGFuZGxlQ2FtZXJhQnV0dG9uQ2xpY2ssXG4gICAgaGFuZGxlR2VuZXJhdGlvblN0YXJ0OiBjb21wYXRpYmlsaXR5LmhhbmRsZUdlbmVyYXRpb25TdGFydCxcbiAgICBoYW5kbGVHZW5lcmF0aW9uQ29tcGxldGU6IGNvbXBhdGliaWxpdHkuaGFuZGxlR2VuZXJhdGlvbkNvbXBsZXRlLFxuICAgIGhhbmRsZUNsb3NlUG9sYXJvaWQ6IGNvbXBhdGliaWxpdHkuaGFuZGxlQ2xvc2VQb2xhcm9pZCxcbiAgICBoYW5kbGVSZXRyeUdlbmVyYXRpb246IGNvbXBhdGliaWxpdHkuaGFuZGxlUmV0cnlHZW5lcmF0aW9uXG4gIH07XG59XG5cbi8qKlxuICogRW5oYW5jZWQgaG9vayB0aGF0IGFkZHMgbmV3IGZlYXR1cmVzIHdoaWxlIG1haW50YWluaW5nIGNvbXBhdGliaWxpdHlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZUVuaGFuY2VkUGFnZVN0YXRlKG1pZ3JhdGlvbk9wdGlvbnM6IE1pZ3JhdGlvbk9wdGlvbnMgPSB7fSkge1xuICBjb25zdCBjb21wYXRpYmlsaXR5ID0gdXNlTGVnYWN5UGFnZUludGVyZmFjZShtaWdyYXRpb25PcHRpb25zKTtcbiAgXG4gIHJldHVybiB7XG4gICAgLy8gQWxsIGxlZ2FjeSBmdW5jdGlvbmFsaXR5XG4gICAgLi4uY29tcGF0aWJpbGl0eSxcbiAgICBcbiAgICAvLyBBZGRpdGlvbmFsIGVuaGFuY2VkIGZlYXR1cmVzXG4gICAgZW5oYW5jZWQ6IHtcbiAgICAgIHByb2dyZXNzOiBjb21wYXRpYmlsaXR5Lm1pZ3JhdGlvbi5uZXdXb3JrZmxvd1N0YXRlID09PSBXb3JrZmxvd1N0YXRlLkdFTkVSQVRJTkcgPyBcbiAgICAgICAgKGNvbXBhdGliaWxpdHkgYXMgYW55KS5wcm9ncmVzcyB8fCAwIDogMCxcbiAgICAgIFxuICAgICAgY2FuR2VuZXJhdGU6ICFjb21wYXRpYmlsaXR5LmlzQ2FwdHVyaW5nICYmIFxuICAgICAgICAgICAgICAgICAgICEhY29tcGF0aWJpbGl0eS51c2VySW1hZ2VGaWxlICYmIFxuICAgICAgICAgICAgICAgICAgICEhY29tcGF0aWJpbGl0eS5hcHBhcmVsSW1hZ2VGaWxlLFxuICAgICAgXG4gICAgICBjYW5SZXRyeTogY29tcGF0aWJpbGl0eS5oYXNFcnJvcixcbiAgICAgIFxuICAgICAgdmFsaWRhdGlvbkVycm9yczogW10gYXMgc3RyaW5nW10sIC8vIENvdWxkIGJlIGV4cGFuZGVkIHRvIHNob3cgdmFsaWRhdGlvbiBkZXRhaWxzXG4gICAgICBcbiAgICAgIC8vIE5ldyBlbmhhbmNlZCBhY3Rpb25zXG4gICAgICByZXNldDogKCkgPT4gKGNvbXBhdGliaWxpdHkgYXMgYW55KS5yZXNldFdvcmtmbG93Py4oKSxcbiAgICAgIGNsZWFyRXJyb3I6ICgpID0+IChjb21wYXRpYmlsaXR5IGFzIGFueSkuY2xlYXJFcnJvcj8uKCksXG4gICAgICBcbiAgICAgIC8vIE1pZ3JhdGlvbiBoZWxwZXJcbiAgICAgIGdldE1pZ3JhdGlvbkd1aWRlOiBjb21wYXRpYmlsaXR5Lm1pZ3JhdGlvbi5taWdyYXRlVG9OZXdJbnRlcmZhY2VcbiAgICB9XG4gIH07XG59Il0sIm5hbWVzIjpbInVzZUVuaGFuY2VkUGFnZVN0YXRlIiwidXNlTGVnYWN5UGFnZUludGVyZmFjZSIsInVzZVBhZ2VDb21wb25lbnRTdGF0ZSIsIkRFRkFVTFRfTUlHUkFUSU9OX09QVElPTlMiLCJlbmFibGVOZXdGZWF0dXJlcyIsInNob3dEZXByZWNhdGlvbldhcm5pbmdzIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwib25TdGF0ZUNoYW5nZSIsImVuaGFuY2VkRXJyb3JIYW5kbGluZyIsImVuYWJsZVByb2dyZXNzVHJhY2tpbmciLCJvcHRpb25zIiwiZmluYWxPcHRpb25zIiwic2hvd1RvYXN0IiwidXNlVG9hc3QiLCJkZXByZWNhdGlvbldhcm5pbmdzIiwidXNlUmVmIiwid29ya2Zsb3ciLCJ1c2VUcnlvbldvcmtmbG93IiwidGltZW91dE1zIiwiY29tcHJlc3Npb25MaW1pdEtCIiwiZGVidWciLCJhZGREZXByZWNhdGlvbldhcm5pbmciLCJ1c2VDYWxsYmFjayIsIm1ldGhvZCIsInN1Z2dlc3Rpb24iLCJ3YXJuaW5nIiwiY3VycmVudCIsImluY2x1ZGVzIiwicHVzaCIsImNvbnNvbGUiLCJ3YXJuIiwibGVnYWN5U3RhdGUiLCJpc0NhcHR1cmluZyIsImxlZnRDYXJkSW1hZ2UiLCJyaWdodENhcmRJbWFnZSIsInNob3dQb2xhcm9pZCIsInVzZXJJbWFnZUZpbGUiLCJhcHBhcmVsSW1hZ2VGaWxlIiwiZ2VuZXJhdGVkSW1hZ2UiLCJoYXNFcnJvciIsInVzZUVmZmVjdCIsImxlZ2FjeUhhbmRsZXJzIiwiaGFuZGxlVXNlckZpbGVVcGxvYWQiLCJmaWxlIiwiaGFuZGxlQXBwYXJlbEZpbGVVcGxvYWQiLCJoYW5kbGVMZWZ0Q2FyZEltYWdlVXBsb2FkIiwiaW1hZ2VVcmwiLCJoYW5kbGVSaWdodENhcmRJbWFnZVVwbG9hZCIsImhhbmRsZUNhbWVyYUJ1dHRvbkNsaWNrIiwic3RhcnRHZW5lcmF0aW9uIiwiaGFuZGxlR2VuZXJhdGlvblN0YXJ0IiwibG9nIiwiaGFuZGxlR2VuZXJhdGlvbkNvbXBsZXRlIiwiaGFuZGxlQ2xvc2VQb2xhcm9pZCIsImNsb3NlUG9sYXJvaWQiLCJoYW5kbGVSZXRyeUdlbmVyYXRpb24iLCJyZXRyeUdlbmVyYXRpb24iLCJtaWdyYXRlVG9OZXdJbnRlcmZhY2UiLCJpbXBvcnQiLCJob29rVXNhZ2UiLCJzdGF0ZU1hcHBpbmciLCJhY3Rpb25NYXBwaW5nIiwiZW5oYW5jZWRGZWF0dXJlcyIsIm1pZ3JhdGlvbiIsImlzVXNpbmdOZXdBcmNoaXRlY3R1cmUiLCJuZXdXb3JrZmxvd1N0YXRlIiwid29ya2Zsb3dTdGF0ZSIsImNvbXBhdGliaWxpdHkiLCJtaWdyYXRpb25PcHRpb25zIiwiZW5oYW5jZWQiLCJwcm9ncmVzcyIsIldvcmtmbG93U3RhdGUiLCJHRU5FUkFUSU5HIiwiY2FuR2VuZXJhdGUiLCJjYW5SZXRyeSIsInZhbGlkYXRpb25FcnJvcnMiLCJyZXNldCIsInJlc2V0V29ya2Zsb3ciLCJjbGVhckVycm9y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