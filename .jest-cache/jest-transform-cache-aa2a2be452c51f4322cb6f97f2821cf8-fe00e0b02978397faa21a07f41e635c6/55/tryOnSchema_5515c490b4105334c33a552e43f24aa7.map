{"version":3,"sources":["/Users/willstreeter/WebstormProjects/vibe-coding/those-people/The-Sus-Fit-gp/src/lib/tryOnSchema.ts"],"sourcesContent":["/**\n * Try-On Service Schema Definitions\n * \n * Provides compile-time and runtime contracts for inputs and outputs of the OpenAI\n * Images Edit wrapper. These schemas ensure type safety and validate base64 image data.\n * \n * @see https://platform.openai.com/docs/api-reference/images/edit\n */\n\nimport { z } from 'zod';\n\n/**\n * Base64 regex pattern for validating image data\n * Matches both data URLs (data:image/...;base64,...) and pure base64 strings\n * with optional padding\n */\nconst base64Regex = /^(?:data:image\\/[a-zA-Z]+;base64,)?(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/;\n\n/**\n * Utility function to normalize base64 strings\n * Strips data URL prefix if present, returns pure base64\n * \n * @param base64String - The base64 string to normalize\n * @returns Pure base64 string without data URL prefix\n * \n * @example\n * // Input: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==\"\n * // Output: \"iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==\"\n */\nexport const normalizeBase64 = (base64String: string): string => {\n  // If it's a data URL, extract the base64 part\n  if (base64String.startsWith('data:image/')) {\n    const commaIndex = base64String.indexOf(',');\n    if (commaIndex !== -1) {\n      return base64String.substring(commaIndex + 1);\n    }\n  }\n  // If it's already pure base64, return as is\n  return base64String;\n};\n\n/**\n * Zod schema for validating base64-encoded image strings\n * Accepts both data URLs and pure base64 strings\n * \n * @example\n * // Valid data URL: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==\"\n * // Valid pure base64: \"iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==\"\n * // Invalid: \"not-base64-data\"\n */\nexport const Base64Str = z.string().regex(base64Regex, 'Invalid base64 image data');\n\n/**\n * Schema for try-on service input parameters\n * \n * @example\n * {\n *   modelImage: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==\",\n *   apparelImages: [\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==\"]\n * }\n */\nexport const TryOnParamsSchema = z.object({\n  modelImage: Base64Str,\n  apparelImages: z.array(Base64Str).min(1, 'At least one apparel image is required')\n});\n\n/**\n * Schema for try-on service output result\n * \n * @example\n * {\n *   imgGenerated: \"iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==\"\n * }\n */\nexport const TryOnResultSchema = z.object({\n  imgGenerated: Base64Str\n});\n\n/**\n * TypeScript type for try-on service input parameters\n * Inferred from TryOnParamsSchema for compile-time type safety\n */\nexport type TryOnParams = z.infer<typeof TryOnParamsSchema>;\n\n/**\n * TypeScript type for try-on service output result\n * Inferred from TryOnResultSchema for compile-time type safety\n */\nexport type TryOnResult = z.infer<typeof TryOnResultSchema>; "],"names":["Base64Str","TryOnParamsSchema","TryOnResultSchema","normalizeBase64","base64Regex","base64String","startsWith","commaIndex","indexOf","substring","z","string","regex","object","modelImage","apparelImages","array","min","imgGenerated"],"mappings":"AAAA;;;;;;;CAOC;;;;;;;;;;;IA2CYA,SAAS;eAATA;;IAWAC,iBAAiB;eAAjBA;;IAaAC,iBAAiB;eAAjBA;;IA7CAC,eAAe;eAAfA;;;qBApBK;AAElB;;;;CAIC,GACD,MAAMC,cAAc;AAab,MAAMD,kBAAkB,CAACE;IAC9B,8CAA8C;IAC9C,IAAIA,aAAaC,UAAU,CAAC,gBAAgB;QAC1C,MAAMC,aAAaF,aAAaG,OAAO,CAAC;QACxC,IAAID,eAAe,CAAC,GAAG;YACrB,OAAOF,aAAaI,SAAS,CAACF,aAAa;QAC7C;IACF;IACA,4CAA4C;IAC5C,OAAOF;AACT;AAWO,MAAML,YAAYU,MAAC,CAACC,MAAM,GAAGC,KAAK,CAACR,aAAa;AAWhD,MAAMH,oBAAoBS,MAAC,CAACG,MAAM,CAAC;IACxCC,YAAYd;IACZe,eAAeL,MAAC,CAACM,KAAK,CAAChB,WAAWiB,GAAG,CAAC,GAAG;AAC3C;AAUO,MAAMf,oBAAoBQ,MAAC,CAACG,MAAM,CAAC;IACxCK,cAAclB;AAChB"}