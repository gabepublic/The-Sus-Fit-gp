{"version":3,"names":["HISTORY_QUERY_KEYS","cov_ehs10y23g","f","s","useTryonHistory","useTryonHistoryEntry","useTryonHistoryStats","all","entries","options","entry","id","stats","DEFAULT_CONFIG","historyService","_tryonHistoryService","defaultHistoryService","defaultQueryOptions","page","pageSize","sortBy","sortDirection","enableRefetch","refetchInterval","staleTime","cacheTime","queryOptions","b","config","queryClient","_reactquery","useQueryClient","mergedConfig","_react","useMemo","mergedQueryOptions","historyQuery","useQuery","queryKey","queryFn","getEntries","refetchOnWindowFocus","retry","addEntryMutation","useMutation","mutationFn","addEntry","onSuccess","newEntry","invalidateQueries","setQueryData","oldData","totalCount","lastUpdated","Date","toISOString","updateEntryMutation","updates","updateEntry","updatedEntry","map","deleteEntryMutation","deleteEntry","success","deletedId","removeQueries","filter","Math","max","clearAllMutation","clearAll","currentPage","hasMore","useCallback","mutateAsync","loadMore","data","isFetching","nextPage","nextPageOptions","nextPageData","fetchQuery","refresh","isLoading","error","getEntry","enabled","Boolean","getStorageStats"],"sources":["/Users/willstreeter/WebstormProjects/vibe-coding/those-people/The-Sus-Fit-gp/src/business-layer/hooks/useTryonHistory.ts"],"sourcesContent":["// Try-On History React Query Hooks\n// Provides React Query integration for history management with caching and synchronization\n\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { useCallback, useMemo } from 'react';\nimport type {\n  TryonHistoryEntry,\n  TryonHistoryCollection,\n  TryonHistoryQueryOptions,\n  CreateTryonHistoryEntryOptions,\n  UseTryonHistoryReturn,\n  TryonHistoryService\n} from '../types/history.types';\nimport { defaultHistoryService } from '../services/tryonHistoryService';\n\n/**\n * Query keys for history-related React Query operations\n */\nexport const HISTORY_QUERY_KEYS = {\n  all: ['tryon-history'] as const,\n  entries: (options?: TryonHistoryQueryOptions) => ['tryon-history', 'entries', options] as const,\n  entry: (id: string) => ['tryon-history', 'entry', id] as const,\n  stats: () => ['tryon-history', 'stats'] as const\n} as const;\n\n/**\n * Configuration for history hooks\n */\ninterface UseTryonHistoryConfig {\n  /** History service instance to use */\n  historyService?: TryonHistoryService;\n  /** Default query options */\n  defaultQueryOptions?: TryonHistoryQueryOptions;\n  /** Enable automatic refetch */\n  enableRefetch?: boolean;\n  /** Refetch interval in milliseconds */\n  refetchInterval?: number;\n  /** Stale time in milliseconds */\n  staleTime?: number;\n  /** Cache time in milliseconds */\n  cacheTime?: number;\n}\n\n/**\n * Default hook configuration\n */\nconst DEFAULT_CONFIG: Required<UseTryonHistoryConfig> = {\n  historyService: defaultHistoryService,\n  defaultQueryOptions: {\n    page: 0,\n    pageSize: 20,\n    sortBy: 'timestamp',\n    sortDirection: 'desc'\n  },\n  enableRefetch: false,\n  refetchInterval: 0,\n  staleTime: 5 * 60 * 1000, // 5 minutes\n  cacheTime: 10 * 60 * 1000 // 10 minutes\n};\n\n/**\n * Hook for managing try-on history with React Query\n */\nexport function useTryonHistory(\n  queryOptions: TryonHistoryQueryOptions = {},\n  config: UseTryonHistoryConfig = {}\n): UseTryonHistoryReturn {\n  const queryClient = useQueryClient();\n  \n  // Merge configuration with defaults\n  const mergedConfig = useMemo(() => ({\n    ...DEFAULT_CONFIG,\n    ...config\n  }), [config]);\n\n  // Merge query options with defaults\n  const mergedQueryOptions = useMemo(() => ({\n    ...mergedConfig.defaultQueryOptions,\n    ...queryOptions\n  }), [mergedConfig.defaultQueryOptions, queryOptions]);\n\n  // Query for history entries\n  const historyQuery = useQuery({\n    queryKey: HISTORY_QUERY_KEYS.entries(mergedQueryOptions),\n    queryFn: () => mergedConfig.historyService.getEntries(mergedQueryOptions),\n    staleTime: mergedConfig.staleTime,\n    cacheTime: mergedConfig.cacheTime,\n    refetchInterval: mergedConfig.enableRefetch ? mergedConfig.refetchInterval : false,\n    refetchOnWindowFocus: false,\n    retry: 2\n  });\n\n  // Mutation for adding new entries\n  const addEntryMutation = useMutation({\n    mutationFn: (options: CreateTryonHistoryEntryOptions) => \n      mergedConfig.historyService.addEntry(options),\n    onSuccess: (newEntry) => {\n      // Invalidate and refetch history entries\n      queryClient.invalidateQueries({ queryKey: HISTORY_QUERY_KEYS.all });\n      \n      // Optimistically update the cache\n      queryClient.setQueryData<TryonHistoryCollection>(\n        HISTORY_QUERY_KEYS.entries(mergedQueryOptions),\n        (oldData) => {\n          if (!oldData) return oldData;\n          \n          return {\n            ...oldData,\n            entries: [newEntry, ...oldData.entries],\n            totalCount: oldData.totalCount + 1,\n            lastUpdated: new Date().toISOString()\n          };\n        }\n      );\n    }\n  });\n\n  // Mutation for updating entries\n  const updateEntryMutation = useMutation({\n    mutationFn: ({ id, updates }: { id: string; updates: Partial<TryonHistoryEntry> }) =>\n      mergedConfig.historyService.updateEntry(id, updates),\n    onSuccess: (updatedEntry) => {\n      // Invalidate related queries\n      queryClient.invalidateQueries({ queryKey: HISTORY_QUERY_KEYS.entry(updatedEntry.id) });\n      queryClient.invalidateQueries({ queryKey: HISTORY_QUERY_KEYS.entries() });\n      \n      // Update the entry in all relevant caches\n      queryClient.setQueryData(HISTORY_QUERY_KEYS.entry(updatedEntry.id), updatedEntry);\n      \n      // Update the entry in the entries list cache\n      queryClient.setQueryData<TryonHistoryCollection>(\n        HISTORY_QUERY_KEYS.entries(mergedQueryOptions),\n        (oldData) => {\n          if (!oldData) return oldData;\n          \n          return {\n            ...oldData,\n            entries: oldData.entries.map(entry => \n              entry.id === updatedEntry.id ? updatedEntry : entry\n            ),\n            lastUpdated: new Date().toISOString()\n          };\n        }\n      );\n    }\n  });\n\n  // Mutation for deleting entries\n  const deleteEntryMutation = useMutation({\n    mutationFn: (id: string) => mergedConfig.historyService.deleteEntry(id),\n    onSuccess: (success, deletedId) => {\n      if (success) {\n        // Remove from all caches\n        queryClient.removeQueries({ queryKey: HISTORY_QUERY_KEYS.entry(deletedId) });\n        queryClient.invalidateQueries({ queryKey: HISTORY_QUERY_KEYS.entries() });\n        \n        // Optimistically remove from entries list\n        queryClient.setQueryData<TryonHistoryCollection>(\n          HISTORY_QUERY_KEYS.entries(mergedQueryOptions),\n          (oldData) => {\n            if (!oldData) return oldData;\n            \n            return {\n              ...oldData,\n              entries: oldData.entries.filter(entry => entry.id !== deletedId),\n              totalCount: Math.max(0, oldData.totalCount - 1),\n              lastUpdated: new Date().toISOString()\n            };\n          }\n        );\n      }\n    }\n  });\n\n  // Mutation for clearing all entries\n  const clearAllMutation = useMutation({\n    mutationFn: () => mergedConfig.historyService.clearAll(),\n    onSuccess: (success) => {\n      if (success) {\n        // Clear all history-related caches\n        queryClient.removeQueries({ queryKey: HISTORY_QUERY_KEYS.all });\n        \n        // Set empty state\n        queryClient.setQueryData<TryonHistoryCollection>(\n          HISTORY_QUERY_KEYS.entries(mergedQueryOptions),\n          {\n            entries: [],\n            totalCount: 0,\n            currentPage: 0,\n            pageSize: mergedQueryOptions.pageSize!,\n            hasMore: false,\n            lastUpdated: new Date().toISOString()\n          }\n        );\n      }\n    }\n  });\n\n  // Memoized callback functions\n  const addEntry = useCallback(async (options: CreateTryonHistoryEntryOptions) => {\n    return addEntryMutation.mutateAsync(options);\n  }, [addEntryMutation]);\n\n  const updateEntry = useCallback(async (id: string, updates: Partial<TryonHistoryEntry>) => {\n    await updateEntryMutation.mutateAsync({ id, updates });\n  }, [updateEntryMutation]);\n\n  const deleteEntry = useCallback(async (id: string) => {\n    await deleteEntryMutation.mutateAsync(id);\n  }, [deleteEntryMutation]);\n\n  const loadMore = useCallback(async () => {\n    if (!historyQuery.data?.hasMore || historyQuery.isFetching) return;\n    \n    const nextPage = historyQuery.data.currentPage + 1;\n    const nextPageOptions = { ...mergedQueryOptions, page: nextPage };\n    \n    // Fetch next page\n    const nextPageData = await queryClient.fetchQuery({\n      queryKey: HISTORY_QUERY_KEYS.entries(nextPageOptions),\n      queryFn: () => mergedConfig.historyService.getEntries(nextPageOptions),\n      staleTime: mergedConfig.staleTime\n    });\n    \n    // Merge with current data\n    queryClient.setQueryData<TryonHistoryCollection>(\n      HISTORY_QUERY_KEYS.entries(mergedQueryOptions),\n      (oldData) => {\n        if (!oldData) return nextPageData;\n        \n        return {\n          ...nextPageData,\n          entries: [...oldData.entries, ...nextPageData.entries],\n          currentPage: nextPage\n        };\n      }\n    );\n  }, [historyQuery.data, historyQuery.isFetching, mergedQueryOptions, queryClient, mergedConfig.historyService, mergedConfig.staleTime]);\n\n  const refresh = useCallback(async () => {\n    await queryClient.invalidateQueries({ queryKey: HISTORY_QUERY_KEYS.entries(mergedQueryOptions) });\n  }, [queryClient, mergedQueryOptions]);\n\n  const clearAll = useCallback(async () => {\n    await clearAllMutation.mutateAsync();\n  }, [clearAllMutation]);\n\n  // Return hook interface\n  return useMemo<UseTryonHistoryReturn>(() => ({\n    entries: historyQuery.data?.entries || [],\n    isLoading: historyQuery.isLoading || historyQuery.isFetching,\n    error: historyQuery.error,\n    hasMore: historyQuery.data?.hasMore || false,\n    currentPage: historyQuery.data?.currentPage || 0,\n    totalCount: historyQuery.data?.totalCount || 0,\n    addEntry,\n    updateEntry,\n    deleteEntry,\n    loadMore,\n    refresh,\n    clearAll\n  }), [\n    historyQuery.data,\n    historyQuery.isLoading,\n    historyQuery.isFetching,\n    historyQuery.error,\n    addEntry,\n    updateEntry,\n    deleteEntry,\n    loadMore,\n    refresh,\n    clearAll\n  ]);\n}\n\n/**\n * Hook for getting a single history entry by ID\n */\nexport function useTryonHistoryEntry(\n  id: string,\n  config: Pick<UseTryonHistoryConfig, 'historyService' | 'staleTime' | 'cacheTime'> = {}\n) {\n  const mergedConfig = useMemo(() => ({\n    historyService: defaultHistoryService,\n    staleTime: 5 * 60 * 1000,\n    cacheTime: 10 * 60 * 1000,\n    ...config\n  }), [config]);\n\n  return useQuery({\n    queryKey: HISTORY_QUERY_KEYS.entry(id),\n    queryFn: () => mergedConfig.historyService.getEntry(id),\n    staleTime: mergedConfig.staleTime,\n    cacheTime: mergedConfig.cacheTime,\n    enabled: Boolean(id),\n    retry: 2\n  });\n}\n\n/**\n * Hook for getting storage statistics\n */\nexport function useTryonHistoryStats(\n  config: Pick<UseTryonHistoryConfig, 'historyService' | 'staleTime' | 'cacheTime'> = {}\n) {\n  const mergedConfig = useMemo(() => ({\n    historyService: defaultHistoryService,\n    staleTime: 60 * 1000, // 1 minute\n    cacheTime: 5 * 60 * 1000, // 5 minutes\n    ...config\n  }), [config]);\n\n  return useQuery({\n    queryKey: HISTORY_QUERY_KEYS.stats(),\n    queryFn: () => mergedConfig.historyService.getStorageStats(),\n    staleTime: mergedConfig.staleTime,\n    cacheTime: mergedConfig.cacheTime,\n    refetchOnWindowFocus: false\n  });\n}"],"mappings":"AAAA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}