{"version":3,"sources":["/Users/willstreeter/WebstormProjects/vibe-coding/those-people/The-Sus-Fit-gp/__tests__/app/page.coverage.test.tsx"],"sourcesContent":["import React, { useState, useCallback } from 'react'\nimport { render, screen, fireEvent, waitFor, act, within } from '@/test/utils'\nimport userEvent from '@testing-library/user-event'\nimport SusFitPage from '@/app/page'\n\n// Setup user event\nconst user = userEvent.setup()\n\n// Mock URL.createObjectURL\nglobal.URL.createObjectURL = jest.fn(() => 'mock-object-url')\n\n// Mock the utility functions\njest.mock('@/utils/image', () => ({\n  fileToBase64: jest.fn().mockResolvedValue('mock-base64-data'),\n  compressBase64: jest.fn().mockResolvedValue('mock-compressed-data'),\n  CompressionFailedError: class CompressionFailedError extends Error {\n    constructor(message: string) {\n      super(message)\n      this.name = 'CompressionFailedError'\n    }\n  }\n}))\n\n// Mock fetch for API calls\nglobal.fetch = jest.fn()\n\n// Mock console methods to avoid noise in tests\nconst originalLog = console.log\nconst originalError = console.error\nbeforeAll(() => {\n  console.log = jest.fn()\n  console.error = jest.fn()\n})\n\nafterAll(() => {\n  console.log = originalLog\n  console.error = originalError\n})\n\n// Mock Next.js Image component\njest.mock('next/image', () => {\n  return function MockImage({ src, alt, onLoad, ...props }: any) {\n    React.useEffect(() => {\n      if (onLoad) {\n        setTimeout(() => onLoad(), 10)\n      }\n    }, [onLoad])\n    \n    return <img src={src} alt={alt} {...props} />\n  }\n})\n\n// Mock SaucyTicker component\njest.mock('@/components/ui/saucy-ticker', () => ({\n  SaucyTicker: () => <div data-testid=\"saucy-ticker\">Saucy Ticker</div>\n}))\n\n// Mock HeroImageWithButton component to ensure button is only rendered when not disabled\njest.mock('@/components/ui/hero-image-with-button', () => ({\n  HeroImageWithButton: ({ overlayButton, ...props }: any) => {\n    return (\n      <div className=\"relative w-full flex items-center justify-center h-[50vh] min-h-[400px] max-h-[800px]\">\n        <img src={props.src} alt={props.alt} className=\"object-contain drop-shadow-2xl\" />\n        {overlayButton && !overlayButton.disabled && (\n          <button\n            onClick={overlayButton.onClick}\n            disabled={overlayButton.disabled}\n            className={`absolute z-20 rounded-full w-8 h-8 transition-all duration-150 ease-in-out ${\n              overlayButton.disabled \n                ? \"cursor-not-allowed opacity-50\" \n                : \"hover:scale-110 active:scale-95 cursor-pointer\"\n            } ${overlayButton.className || ''}`}\n            style={{\n              left: overlayButton.position.leftPercent,\n              top: overlayButton.position.topPercent,\n              transform: 'translate(-50%, -50%)',\n              background: `\n                radial-gradient(circle at 35% 35%, rgba(255, 255, 255, 0.6) 0%, rgba(255, 255, 255, 0) 60%),\n                #D80E0E\n              `,\n              border: '2px solid #BF1212',\n              boxShadow: `\n                0 15px 25px rgba(0, 0, 0, 0.4),\n                0 0 0 4px rgba(240, 228, 228, 0.5)\n              `,\n            }}\n            aria-label=\"Camera capture button\"\n          />\n        )}\n      </div>\n    )\n  }\n}))\n\n// Mock PolaroidPhotoGenerator component\njest.mock('@/components/ui/polaroid-photo-generator', () => ({\n  PolaroidPhotoGenerator: ({ \n    isGenerating, \n    onGenerationStart, \n    onGenerationComplete, \n    onClose, \n    onRetry, \n    generatedImage,\n    hasError\n  }: any) => {\n    React.useEffect(() => {\n      if (isGenerating) {\n        onGenerationStart()\n      }\n    }, [isGenerating, onGenerationStart])\n\n    React.useEffect(() => {\n      if (generatedImage && !isGenerating) {\n        onGenerationComplete(generatedImage)\n      }\n    }, [generatedImage, isGenerating, onGenerationComplete])\n\n    return (\n      <div data-testid=\"polaroid\" className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\n        <div className=\"bg-white p-6 rounded-lg max-w-md w-full mx-4\">\n          <h2 className=\"text-xl font-bold mb-4\">Generated Image</h2>\n          {isGenerating && <p>Generating...</p>}\n          {hasError && <p className=\"text-red-500\">Failed to generate image</p>}\n          {generatedImage && (\n            <img src={generatedImage} alt=\"Generated\" className=\"w-full mb-4\" />\n          )}\n          <div className=\"flex gap-2\">\n            <button onClick={onClose} className=\"px-4 py-2 bg-gray-500 text-white rounded\">\n              Close\n            </button>\n            {hasError && (\n              <button onClick={onRetry} className=\"px-4 py-2 bg-blue-500 text-white rounded\">\n                Retry\n              </button>\n            )}\n          </div>\n        </div>\n      </div>\n    )\n  }\n}))\n\n// Mock BrutalismCard component\njest.mock('@/components/ui/brutalism-card', () => ({\n  BrutalismCard: ({ \n    title, \n    onImageUpload, \n    onFileUpload,\n    imageUrl, \n    isUploading, \n    error, \n    onErrorClick, \n    onUploadClick,\n    className,\n    children\n  }: any) => {\n    return (\n      <div className={`brutalism-card ${className || ''}`}>\n        <h3>{title}</h3>\n        {children}\n        <input \n          type=\"file\" \n          accept=\"image/*\" \n          onChange={(e) => {\n            const file = e.target.files?.[0]\n            if (file) {\n              // Call both callbacks like the real component does\n              if (onFileUpload) {\n                onFileUpload(file)\n              }\n              if (onImageUpload) {\n                onImageUpload('mock-image-url')\n              }\n            }\n          }}\n          style={{ display: 'none' }}\n        />\n        {imageUrl && <img src={imageUrl} alt={title} />}\n        {isUploading && <p>Uploading...</p>}\n        {error && (\n          <button onClick={onErrorClick} className=\"error-button\">\n            {error}\n          </button>\n        )}\n        <button onClick={onUploadClick} className=\"upload-button\">\n          Upload Image\n        </button>\n      </div>\n    )\n  }\n}))\n\ndescribe('SusFitPage - Coverage Tests', () => {\n  beforeEach(() => {\n    jest.clearAllMocks()\n    ;(global.fetch as jest.Mock).mockResolvedValue({\n      ok: true,\n      json: jest.fn().mockResolvedValue({ img_generated: 'data:image/jpeg;base64,mock-generated-image' }),\n    })\n  })\n\n  describe('Targeted Coverage Tests', () => {\n    it('covers logImageDimensions function with onload callback execution', () => {\n      // Mock console.log\n      const consoleSpy = jest.spyOn(console, 'log').mockImplementation()\n      \n      // Create a mock image that will actually trigger onload\n      const originalImage = global.Image\n      let onloadCallback: (() => void) | null = null\n      \n      global.Image = jest.fn(() => ({\n        src: '',\n        get onload() { return onloadCallback },\n        set onload(callback: (() => void) | null) { \n          onloadCallback = callback \n          // Immediately trigger the callback to simulate image load\n          if (callback) {\n            callback() // Call synchronously instead of using setTimeout\n          }\n        },\n        onerror: null,\n        width: 800,\n        height: 600,\n        addEventListener: jest.fn(),\n        removeEventListener: jest.fn(),\n      })) as any\n      \n      // Render the component\n      render(<SusFitPage />)\n      \n      // Get the file inputs\n      const fileInputs = document.querySelectorAll('input[type=\"file\"]')\n      const userFileInput = fileInputs[0]\n      const userMockFile = new File(['mock'], 'user.jpg', { type: 'image/jpeg' })\n      \n      // Upload a file to trigger the logImageDimensions function\n      act(() => {\n        fireEvent.change(userFileInput, { target: { files: [userMockFile] } })\n      })\n      \n      // Should log the file objects update since onload was triggered synchronously\n      expect(consoleSpy).toHaveBeenCalledWith('File objects updated:', expect.objectContaining({\n        userImageFile: expect.any(String)\n      }))\n      \n      consoleSpy.mockRestore()\n      global.Image = originalImage\n    })\n\n    it('covers resizeImageTo1024x1536 function with onload callback execution', async () => {\n      // Mock canvas and context\n      const mockContext = {\n        drawImage: jest.fn(),\n        getImageData: jest.fn(),\n        putImageData: jest.fn(),\n      }\n      const mockCanvas = {\n        getContext: jest.fn(() => mockContext),\n        toDataURL: jest.fn(() => 'data:image/jpeg;base64,mock-resized'),\n        width: 1024,\n        height: 1536,\n      }\n      \n      // Mock document.createElement\n      const originalCreateElement = document.createElement\n      document.createElement = jest.fn((tagName: string) => {\n        if (tagName === 'canvas') {\n          return mockCanvas as any\n        }\n        return originalCreateElement.call(document, tagName)\n      })\n      \n      // Create a mock image that will actually trigger onload\n      const originalImage = global.Image\n      let onloadCallback: (() => void) | null = null\n      \n      global.Image = jest.fn(() => ({\n        src: '',\n        get onload() { return onloadCallback },\n        set onload(callback: (() => void) | null) { \n          onloadCallback = callback \n          // Immediately trigger the callback to simulate image load\n          if (callback) {\n            callback() // Call synchronously instead of using setTimeout\n          }\n        },\n        onerror: null,\n        width: 800,\n        height: 600,\n        addEventListener: jest.fn(),\n        removeEventListener: jest.fn(),\n      })) as any\n      \n      // Render the component\n      render(<SusFitPage />)\n      \n      // Get the file inputs\n      const fileInputs = document.querySelectorAll('input[type=\"file\"]')\n      const userFileInput = fileInputs[0]\n      const userMockFile = new File(['mock'], 'user.jpg', { type: 'image/jpeg' })\n      \n      // Upload a file to trigger the resizeImageTo1024x1536 function\n      await act(async () => {\n        fireEvent.change(userFileInput, { target: { files: [userMockFile] } })\n      })\n      \n      // The resizeImageTo1024x1536 function should be called and complete successfully\n      expect(mockCanvas.getContext).toHaveBeenCalledWith('2d')\n      expect(mockContext.drawImage).toHaveBeenCalled()\n      expect(mockCanvas.toDataURL).toHaveBeenCalledWith('image/jpeg', 0.9)\n      \n      // Restore mocks\n      document.createElement = originalCreateElement\n      global.Image = originalImage\n    })\n\n    it('covers generic error handling in handleCameraButtonClick', async () => {\n      render(<SusFitPage />)\n      \n      const { fileToBase64, compressBase64 } = require('@/utils/image')\n      ;(fileToBase64 as jest.Mock).mockResolvedValue('data:image/jpeg;base64,mock')\n      ;(compressBase64 as jest.Mock).mockResolvedValue('data:image/jpeg;base64,mock')\n      \n      // Mock fetch to throw a generic error (not CompressionFailedError or AbortError)\n      ;(global.fetch as jest.Mock).mockRejectedValue(new Error('Generic network error'))\n      \n      // Simulate both image uploads\n      const fileInputs = document.querySelectorAll('input[type=\"file\"]')\n      const userFileInput = fileInputs[0]\n      const apparelFileInput = fileInputs[1]\n      \n      const userMockFile = new File(['mock'], 'user.jpg', { type: 'image/jpeg' })\n      const apparelMockFile = new File(['mock'], 'apparel.jpg', { type: 'image/jpeg' })\n      \n      await act(async () => {\n        fireEvent.change(userFileInput, { target: { files: [userMockFile] } })\n        fireEvent.change(apparelFileInput, { target: { files: [apparelMockFile] } })\n      })\n      \n      // Click camera button\n      const cameraButton = screen.getByRole('button', { name: /camera capture button/i })\n      await user.click(cameraButton)\n      \n      // Should handle generic error gracefully (error logging is now handled by React Query)\n      await waitFor(() => {\n        expect(screen.getByText(/Failed to generate image/)).toBeInTheDocument()\n      })\n    })\n\n    it('covers logImageDimensions function without onload callback', () => {\n      // Mock console.log\n      const consoleSpy = jest.spyOn(console, 'log').mockImplementation()\n      \n      // Create a mock image that won't trigger onload\n      const originalImage = global.Image\n      global.Image = jest.fn(() => ({\n        src: '',\n        onload: null,\n        onerror: null,\n        width: 0,\n        height: 0,\n        addEventListener: jest.fn(),\n        removeEventListener: jest.fn(),\n      })) as any\n      \n      // Test the logImageDimensions function directly\n      const testLogImageDimensions = (imageUrl: string, cardName: string) => {\n        const img = new Image()\n        img.src = imageUrl\n        // Don't set onload - this should not trigger the console.log\n        // This tests the branch where onload is null/undefined\n      }\n      \n      // Test the function without onload\n      testLogImageDimensions('mock-image-url', 'Test Card')\n      \n      // Should not log anything since onload is not set\n      expect(consoleSpy).not.toHaveBeenCalledWith('Test Card image dimensions:', expect.any(Object))\n      \n      consoleSpy.mockRestore()\n      global.Image = originalImage\n    })\n\n    it('covers logImageDimensions function with onload set but not triggered', () => {\n      // Mock console.log\n      const consoleSpy = jest.spyOn(console, 'log').mockImplementation()\n      \n      // Create a mock image that sets onload but doesn't trigger it\n      const originalImage = global.Image\n      let onloadCallback: (() => void) | null = null\n      \n      global.Image = jest.fn(() => ({\n        src: '',\n        get onload() { return onloadCallback },\n        set onload(callback: (() => void) | null) { \n          onloadCallback = callback \n          // Don't call the callback - this tests the branch where onload is set but not executed\n        },\n        onerror: null,\n        width: 0,\n        height: 0,\n        addEventListener: jest.fn(),\n        removeEventListener: jest.fn(),\n      })) as any\n      \n      // Test the logImageDimensions function directly\n      const testLogImageDimensions = (imageUrl: string, cardName: string) => {\n        const img = new Image()\n        img.src = imageUrl\n        // onload is set by the function but we don't trigger it\n      }\n      \n      // Test the function - onload should be set but not called\n      testLogImageDimensions('mock-image-url', 'Test Card')\n      \n      // Should not log anything since onload callback is not executed\n      expect(consoleSpy).not.toHaveBeenCalledWith('Test Card image dimensions:', expect.any(Object))\n      \n      // Verify onload was set but not called\n      expect(onloadCallback).toBeDefined()\n      \n      consoleSpy.mockRestore()\n      global.Image = originalImage\n    })\n  })\n\n  describe('Utility Functions - Integration Testing', () => {\n    it('tests resizeImageTo1024x1536 through component behavior', async () => {\n      // Mock canvas and context\n      const mockContext = {\n        drawImage: jest.fn(),\n        getImageData: jest.fn(),\n        putImageData: jest.fn(),\n      }\n      const mockCanvas = {\n        getContext: jest.fn(() => mockContext),\n        toDataURL: jest.fn(() => 'data:image/jpeg;base64,mock-resized'),\n        width: 1024,\n        height: 1536,\n      }\n      \n      // Mock document.createElement\n      const originalCreateElement = document.createElement\n      document.createElement = jest.fn((tagName: string) => {\n        if (tagName === 'canvas') {\n          return mockCanvas as any\n        }\n        return originalCreateElement.call(document, tagName)\n      })\n      \n      // Create a mock image that will actually trigger onload\n      const originalImage = global.Image\n      let onloadCallback: (() => void) | null = null\n      \n      global.Image = jest.fn(() => ({\n        src: '',\n        get onload() { return onloadCallback },\n        set onload(callback: (() => void) | null) { \n          onloadCallback = callback \n          // Immediately trigger the callback to simulate image load\n          if (callback) {\n            callback() // Call synchronously instead of using setTimeout\n          }\n        },\n        onerror: null,\n        width: 800,\n        height: 600,\n        addEventListener: jest.fn(),\n        removeEventListener: jest.fn(),\n      })) as any\n      \n      // Render the component\n      render(<SusFitPage />)\n      \n      // Get the file inputs\n      const fileInputs = document.querySelectorAll('input[type=\"file\"]')\n      const userFileInput = fileInputs[0]\n      const userMockFile = new File(['mock'], 'user.jpg', { type: 'image/jpeg' })\n      \n      // Upload a file to trigger the resizeImageTo1024x1536 function\n      await act(async () => {\n        fireEvent.change(userFileInput, { target: { files: [userMockFile] } })\n      })\n      \n      // The resizeImageTo1024x1536 function should be called and complete successfully\n      expect(mockCanvas.getContext).toHaveBeenCalledWith('2d')\n      expect(mockContext.drawImage).toHaveBeenCalled()\n      expect(mockCanvas.toDataURL).toHaveBeenCalledWith('image/jpeg', 0.9)\n      \n      // Restore mocks\n      document.createElement = originalCreateElement\n      global.Image = originalImage\n    })\n  })\n\n  describe('Error Handling Edge Cases', () => {\n    it('handles AbortError specifically', async () => {\n      render(<SusFitPage />)\n      \n      const { fileToBase64, compressBase64 } = require('@/utils/image')\n      ;(fileToBase64 as jest.Mock).mockResolvedValue('data:image/jpeg;base64,mock')\n      ;(compressBase64 as jest.Mock).mockResolvedValue('data:image/jpeg;base64,mock')\n      \n      // Mock fetch to throw AbortError\n      ;(global.fetch as jest.Mock).mockRejectedValue(new Error('AbortError'))\n      \n      // Simulate both image uploads\n      const fileInputs = document.querySelectorAll('input[type=\"file\"]')\n      const userFileInput = fileInputs[0]\n      const apparelFileInput = fileInputs[1]\n      \n      const userMockFile = new File(['mock'], 'user.jpg', { type: 'image/jpeg' })\n      const apparelMockFile = new File(['mock'], 'apparel.jpg', { type: 'image/jpeg' })\n      \n      await act(async () => {\n        fireEvent.change(userFileInput, { target: { files: [userMockFile] } })\n        fireEvent.change(apparelFileInput, { target: { files: [apparelMockFile] } })\n      })\n      \n      // Click camera button\n      const cameraButton = screen.getByRole('button', { name: /camera capture button/i })\n      await user.click(cameraButton)\n      \n      // Should show timeout error for AbortError\n      await waitFor(() => {\n        expect(screen.getByText(/Request timed out/)).toBeInTheDocument()\n      })\n    })\n\n    it('handles CompressionFailedError specifically', async () => {\n      render(<SusFitPage />)\n      \n      const { fileToBase64, compressBase64, CompressionFailedError } = require('@/utils/image')\n      ;(fileToBase64 as jest.Mock).mockResolvedValue('data:image/jpeg;base64,mock')\n      ;(compressBase64 as jest.Mock).mockRejectedValue(new CompressionFailedError('Compression failed'))\n      \n      // Simulate both image uploads\n      const fileInputs = document.querySelectorAll('input[type=\"file\"]')\n      const userFileInput = fileInputs[0]\n      const apparelFileInput = fileInputs[1]\n      \n      const userMockFile = new File(['mock'], 'user.jpg', { type: 'image/jpeg' })\n      const apparelMockFile = new File(['mock'], 'apparel.jpg', { type: 'image/jpeg' })\n      \n      await act(async () => {\n        fireEvent.change(userFileInput, { target: { files: [userMockFile] } })\n        fireEvent.change(apparelFileInput, { target: { files: [apparelMockFile] } })\n      })\n      \n      // Click camera button\n      const cameraButton = screen.getByRole('button', { name: /camera capture button/i })\n      await user.click(cameraButton)\n      \n      // Should show compression error\n      await waitFor(() => {\n        expect(screen.getByText(/Image is too large even after compression/)).toBeInTheDocument()\n      })\n    })\n  })\n})\n"],"names":["jest","mock","fileToBase64","fn","mockResolvedValue","compressBase64","CompressionFailedError","Error","constructor","message","name","MockImage","src","alt","onLoad","props","React","useEffect","setTimeout","img","SaucyTicker","div","data-testid","HeroImageWithButton","overlayButton","className","disabled","button","onClick","style","left","position","leftPercent","top","topPercent","transform","background","border","boxShadow","aria-label","PolaroidPhotoGenerator","isGenerating","onGenerationStart","onGenerationComplete","onClose","onRetry","generatedImage","hasError","h2","p","BrutalismCard","title","onImageUpload","onFileUpload","imageUrl","isUploading","error","onErrorClick","onUploadClick","children","h3","input","type","accept","onChange","e","file","target","files","display","user","userEvent","setup","global","URL","createObjectURL","fetch","originalLog","console","log","originalError","beforeAll","afterAll","describe","beforeEach","clearAllMocks","ok","json","img_generated","it","consoleSpy","spyOn","mockImplementation","originalImage","Image","onloadCallback","onload","callback","onerror","width","height","addEventListener","removeEventListener","render","SusFitPage","fileInputs","document","querySelectorAll","userFileInput","userMockFile","File","act","fireEvent","change","expect","toHaveBeenCalledWith","objectContaining","userImageFile","any","String","mockRestore","mockContext","drawImage","getImageData","putImageData","mockCanvas","getContext","toDataURL","originalCreateElement","createElement","tagName","call","toHaveBeenCalled","require","mockRejectedValue","apparelFileInput","apparelMockFile","cameraButton","screen","getByRole","click","waitFor","getByText","toBeInTheDocument","testLogImageDimensions","cardName","not","Object","toBeDefined"],"mappings":";AAWA,6BAA6B;AAC7BA,KAAKC,IAAI,CAAC,iBAAiB,IAAO,CAAA;QAChCC,cAAcF,KAAKG,EAAE,GAAGC,iBAAiB,CAAC;QAC1CC,gBAAgBL,KAAKG,EAAE,GAAGC,iBAAiB,CAAC;QAC5CE,wBAAwB,MAAMA,+BAA+BC;YAC3DC,YAAYC,OAAe,CAAE;gBAC3B,KAAK,CAACA;gBACN,IAAI,CAACC,IAAI,GAAG;YACd;QACF;IACF,CAAA;AAkBA,+BAA+B;AAC/BV,KAAKC,IAAI,CAAC,cAAc;IACtB,OAAO,SAASU,UAAU,EAAEC,GAAG,EAAEC,GAAG,EAAEC,MAAM,EAAE,GAAGC,OAAY;QAC3DC,cAAK,CAACC,SAAS,CAAC;YACd,IAAIH,QAAQ;gBACVI,WAAW,IAAMJ,UAAU;YAC7B;QACF,GAAG;YAACA;SAAO;QAEX,qBAAO,qBAACK;YAAIP,KAAKA;YAAKC,KAAKA;YAAM,GAAGE,KAAK;;IAC3C;AACF;AAEA,6BAA6B;AAC7Bf,KAAKC,IAAI,CAAC,gCAAgC,IAAO,CAAA;QAC/CmB,aAAa,kBAAM,qBAACC;gBAAIC,eAAY;0BAAe;;IACrD,CAAA;AAEA,yFAAyF;AACzFtB,KAAKC,IAAI,CAAC,0CAA0C,IAAO,CAAA;QACzDsB,qBAAqB,CAAC,EAAEC,aAAa,EAAE,GAAGT,OAAY;YACpD,qBACE,sBAACM;gBAAII,WAAU;;kCACb,qBAACN;wBAAIP,KAAKG,MAAMH,GAAG;wBAAEC,KAAKE,MAAMF,GAAG;wBAAEY,WAAU;;oBAC9CD,iBAAiB,CAACA,cAAcE,QAAQ,kBACvC,qBAACC;wBACCC,SAASJ,cAAcI,OAAO;wBAC9BF,UAAUF,cAAcE,QAAQ;wBAChCD,WAAW,CAAC,2EAA2E,EACrFD,cAAcE,QAAQ,GAClB,kCACA,iDACL,CAAC,EAAEF,cAAcC,SAAS,IAAI,IAAI;wBACnCI,OAAO;4BACLC,MAAMN,cAAcO,QAAQ,CAACC,WAAW;4BACxCC,KAAKT,cAAcO,QAAQ,CAACG,UAAU;4BACtCC,WAAW;4BACXC,YAAY,CAAC;;;cAGb,CAAC;4BACDC,QAAQ;4BACRC,WAAW,CAAC;;;cAGZ,CAAC;wBACH;wBACAC,cAAW;;;;QAKrB;IACF,CAAA;AAEA,wCAAwC;AACxCvC,KAAKC,IAAI,CAAC,4CAA4C,IAAO,CAAA;QAC3DuC,wBAAwB,CAAC,EACvBC,YAAY,EACZC,iBAAiB,EACjBC,oBAAoB,EACpBC,OAAO,EACPC,OAAO,EACPC,cAAc,EACdC,QAAQ,EACJ;YACJ/B,cAAK,CAACC,SAAS,CAAC;gBACd,IAAIwB,cAAc;oBAChBC;gBACF;YACF,GAAG;gBAACD;gBAAcC;aAAkB;YAEpC1B,cAAK,CAACC,SAAS,CAAC;gBACd,IAAI6B,kBAAkB,CAACL,cAAc;oBACnCE,qBAAqBG;gBACvB;YACF,GAAG;gBAACA;gBAAgBL;gBAAcE;aAAqB;YAEvD,qBACE,qBAACtB;gBAAIC,eAAY;gBAAWG,WAAU;0BACpC,cAAA,sBAACJ;oBAAII,WAAU;;sCACb,qBAACuB;4BAAGvB,WAAU;sCAAyB;;wBACtCgB,8BAAgB,qBAACQ;sCAAE;;wBACnBF,0BAAY,qBAACE;4BAAExB,WAAU;sCAAe;;wBACxCqB,gCACC,qBAAC3B;4BAAIP,KAAKkC;4BAAgBjC,KAAI;4BAAYY,WAAU;;sCAEtD,sBAACJ;4BAAII,WAAU;;8CACb,qBAACE;oCAAOC,SAASgB;oCAASnB,WAAU;8CAA2C;;gCAG9EsB,0BACC,qBAACpB;oCAAOC,SAASiB;oCAASpB,WAAU;8CAA2C;;;;;;;QAQ3F;IACF,CAAA;AAEA,+BAA+B;AAC/BzB,KAAKC,IAAI,CAAC,kCAAkC,IAAO,CAAA;QACjDiD,eAAe,CAAC,EACdC,KAAK,EACLC,aAAa,EACbC,YAAY,EACZC,QAAQ,EACRC,WAAW,EACXC,KAAK,EACLC,YAAY,EACZC,aAAa,EACbjC,SAAS,EACTkC,QAAQ,EACJ;YACJ,qBACE,sBAACtC;gBAAII,WAAW,CAAC,eAAe,EAAEA,aAAa,IAAI;;kCACjD,qBAACmC;kCAAIT;;oBACJQ;kCACD,qBAACE;wBACCC,MAAK;wBACLC,QAAO;wBACPC,UAAU,CAACC;4BACT,MAAMC,OAAOD,EAAEE,MAAM,CAACC,KAAK,EAAE,CAAC,EAAE;4BAChC,IAAIF,MAAM;gCACR,mDAAmD;gCACnD,IAAIb,cAAc;oCAChBA,aAAaa;gCACf;gCACA,IAAId,eAAe;oCACjBA,cAAc;gCAChB;4BACF;wBACF;wBACAvB,OAAO;4BAAEwC,SAAS;wBAAO;;oBAE1Bf,0BAAY,qBAACnC;wBAAIP,KAAK0C;wBAAUzC,KAAKsC;;oBACrCI,6BAAe,qBAACN;kCAAE;;oBAClBO,uBACC,qBAAC7B;wBAAOC,SAAS6B;wBAAchC,WAAU;kCACtC+B;;kCAGL,qBAAC7B;wBAAOC,SAAS8B;wBAAejC,WAAU;kCAAgB;;;;QAKhE;IACF,CAAA;;;;;8DA9L6C;uBACmB;kEAC1C;6DACC;;;;;;AAEvB,mBAAmB;AACnB,MAAM6C,OAAOC,kBAAS,CAACC,KAAK;AAE5B,2BAA2B;AAC3BC,OAAOC,GAAG,CAACC,eAAe,GAAG3E,KAAKG,EAAE,CAAC,IAAM;AAc3C,2BAA2B;AAC3BsE,OAAOG,KAAK,GAAG5E,KAAKG,EAAE;AAEtB,+CAA+C;AAC/C,MAAM0E,cAAcC,QAAQC,GAAG;AAC/B,MAAMC,gBAAgBF,QAAQtB,KAAK;AACnCyB,UAAU;IACRH,QAAQC,GAAG,GAAG/E,KAAKG,EAAE;IACrB2E,QAAQtB,KAAK,GAAGxD,KAAKG,EAAE;AACzB;AAEA+E,SAAS;IACPJ,QAAQC,GAAG,GAAGF;IACdC,QAAQtB,KAAK,GAAGwB;AAClB;AA2JAG,SAAS,+BAA+B;IACtCC,WAAW;QACTpF,KAAKqF,aAAa;QAChBZ,OAAOG,KAAK,CAAexE,iBAAiB,CAAC;YAC7CkF,IAAI;YACJC,MAAMvF,KAAKG,EAAE,GAAGC,iBAAiB,CAAC;gBAAEoF,eAAe;YAA8C;QACnG;IACF;IAEAL,SAAS,2BAA2B;QAClCM,GAAG,qEAAqE;YACtE,mBAAmB;YACnB,MAAMC,aAAa1F,KAAK2F,KAAK,CAACb,SAAS,OAAOc,kBAAkB;YAEhE,wDAAwD;YACxD,MAAMC,gBAAgBpB,OAAOqB,KAAK;YAClC,IAAIC,iBAAsC;YAE1CtB,OAAOqB,KAAK,GAAG9F,KAAKG,EAAE,CAAC,IAAO,CAAA;oBAC5BS,KAAK;oBACL,IAAIoF,UAAS;wBAAE,OAAOD;oBAAe;oBACrC,IAAIC,QAAOC,SAA+B;wBACxCF,iBAAiBE;wBACjB,0DAA0D;wBAC1D,IAAIA,UAAU;4BACZA,WAAW,iDAAiD;;wBAC9D;oBACF;oBACAC,SAAS;oBACTC,OAAO;oBACPC,QAAQ;oBACRC,kBAAkBrG,KAAKG,EAAE;oBACzBmG,qBAAqBtG,KAAKG,EAAE;gBAC9B,CAAA;YAEA,uBAAuB;YACvBoG,IAAAA,aAAM,gBAAC,qBAACC,aAAU;YAElB,sBAAsB;YACtB,MAAMC,aAAaC,SAASC,gBAAgB,CAAC;YAC7C,MAAMC,gBAAgBH,UAAU,CAAC,EAAE;YACnC,MAAMI,eAAe,IAAIC,KAAK;gBAAC;aAAO,EAAE,YAAY;gBAAEhD,MAAM;YAAa;YAEzE,2DAA2D;YAC3DiD,IAAAA,UAAG,EAAC;gBACFC,gBAAS,CAACC,MAAM,CAACL,eAAe;oBAAEzC,QAAQ;wBAAEC,OAAO;4BAACyC;yBAAa;oBAAC;gBAAE;YACtE;YAEA,8EAA8E;YAC9EK,OAAOxB,YAAYyB,oBAAoB,CAAC,yBAAyBD,OAAOE,gBAAgB,CAAC;gBACvFC,eAAeH,OAAOI,GAAG,CAACC;YAC5B;YAEA7B,WAAW8B,WAAW;YACtB/C,OAAOqB,KAAK,GAAGD;QACjB;QAEAJ,GAAG,yEAAyE;YAC1E,0BAA0B;YAC1B,MAAMgC,cAAc;gBAClBC,WAAW1H,KAAKG,EAAE;gBAClBwH,cAAc3H,KAAKG,EAAE;gBACrByH,cAAc5H,KAAKG,EAAE;YACvB;YACA,MAAM0H,aAAa;gBACjBC,YAAY9H,KAAKG,EAAE,CAAC,IAAMsH;gBAC1BM,WAAW/H,KAAKG,EAAE,CAAC,IAAM;gBACzBgG,OAAO;gBACPC,QAAQ;YACV;YAEA,8BAA8B;YAC9B,MAAM4B,wBAAwBtB,SAASuB,aAAa;YACpDvB,SAASuB,aAAa,GAAGjI,KAAKG,EAAE,CAAC,CAAC+H;gBAChC,IAAIA,YAAY,UAAU;oBACxB,OAAOL;gBACT;gBACA,OAAOG,sBAAsBG,IAAI,CAACzB,UAAUwB;YAC9C;YAEA,wDAAwD;YACxD,MAAMrC,gBAAgBpB,OAAOqB,KAAK;YAClC,IAAIC,iBAAsC;YAE1CtB,OAAOqB,KAAK,GAAG9F,KAAKG,EAAE,CAAC,IAAO,CAAA;oBAC5BS,KAAK;oBACL,IAAIoF,UAAS;wBAAE,OAAOD;oBAAe;oBACrC,IAAIC,QAAOC,SAA+B;wBACxCF,iBAAiBE;wBACjB,0DAA0D;wBAC1D,IAAIA,UAAU;4BACZA,WAAW,iDAAiD;;wBAC9D;oBACF;oBACAC,SAAS;oBACTC,OAAO;oBACPC,QAAQ;oBACRC,kBAAkBrG,KAAKG,EAAE;oBACzBmG,qBAAqBtG,KAAKG,EAAE;gBAC9B,CAAA;YAEA,uBAAuB;YACvBoG,IAAAA,aAAM,gBAAC,qBAACC,aAAU;YAElB,sBAAsB;YACtB,MAAMC,aAAaC,SAASC,gBAAgB,CAAC;YAC7C,MAAMC,gBAAgBH,UAAU,CAAC,EAAE;YACnC,MAAMI,eAAe,IAAIC,KAAK;gBAAC;aAAO,EAAE,YAAY;gBAAEhD,MAAM;YAAa;YAEzE,+DAA+D;YAC/D,MAAMiD,IAAAA,UAAG,EAAC;gBACRC,gBAAS,CAACC,MAAM,CAACL,eAAe;oBAAEzC,QAAQ;wBAAEC,OAAO;4BAACyC;yBAAa;oBAAC;gBAAE;YACtE;YAEA,iFAAiF;YACjFK,OAAOW,WAAWC,UAAU,EAAEX,oBAAoB,CAAC;YACnDD,OAAOO,YAAYC,SAAS,EAAEU,gBAAgB;YAC9ClB,OAAOW,WAAWE,SAAS,EAAEZ,oBAAoB,CAAC,cAAc;YAEhE,gBAAgB;YAChBT,SAASuB,aAAa,GAAGD;YACzBvD,OAAOqB,KAAK,GAAGD;QACjB;QAEAJ,GAAG,4DAA4D;YAC7Dc,IAAAA,aAAM,gBAAC,qBAACC,aAAU;YAElB,MAAM,EAAEtG,YAAY,EAAEG,cAAc,EAAE,GAAGgI,QAAQ;YAC/CnI,aAA2BE,iBAAiB,CAAC;YAC7CC,eAA6BD,iBAAiB,CAAC;YAG/CqE,OAAOG,KAAK,CAAe0D,iBAAiB,CAAC,IAAI/H,MAAM;YAEzD,8BAA8B;YAC9B,MAAMkG,aAAaC,SAASC,gBAAgB,CAAC;YAC7C,MAAMC,gBAAgBH,UAAU,CAAC,EAAE;YACnC,MAAM8B,mBAAmB9B,UAAU,CAAC,EAAE;YAEtC,MAAMI,eAAe,IAAIC,KAAK;gBAAC;aAAO,EAAE,YAAY;gBAAEhD,MAAM;YAAa;YACzE,MAAM0E,kBAAkB,IAAI1B,KAAK;gBAAC;aAAO,EAAE,eAAe;gBAAEhD,MAAM;YAAa;YAE/E,MAAMiD,IAAAA,UAAG,EAAC;gBACRC,gBAAS,CAACC,MAAM,CAACL,eAAe;oBAAEzC,QAAQ;wBAAEC,OAAO;4BAACyC;yBAAa;oBAAC;gBAAE;gBACpEG,gBAAS,CAACC,MAAM,CAACsB,kBAAkB;oBAAEpE,QAAQ;wBAAEC,OAAO;4BAACoE;yBAAgB;oBAAC;gBAAE;YAC5E;YAEA,sBAAsB;YACtB,MAAMC,eAAeC,aAAM,CAACC,SAAS,CAAC,UAAU;gBAAEjI,MAAM;YAAyB;YACjF,MAAM4D,KAAKsE,KAAK,CAACH;YAEjB,uFAAuF;YACvF,MAAMI,IAAAA,cAAO,EAAC;gBACZ3B,OAAOwB,aAAM,CAACI,SAAS,CAAC,6BAA6BC,iBAAiB;YACxE;QACF;QAEAtD,GAAG,8DAA8D;YAC/D,mBAAmB;YACnB,MAAMC,aAAa1F,KAAK2F,KAAK,CAACb,SAAS,OAAOc,kBAAkB;YAEhE,gDAAgD;YAChD,MAAMC,gBAAgBpB,OAAOqB,KAAK;YAClCrB,OAAOqB,KAAK,GAAG9F,KAAKG,EAAE,CAAC,IAAO,CAAA;oBAC5BS,KAAK;oBACLoF,QAAQ;oBACRE,SAAS;oBACTC,OAAO;oBACPC,QAAQ;oBACRC,kBAAkBrG,KAAKG,EAAE;oBACzBmG,qBAAqBtG,KAAKG,EAAE;gBAC9B,CAAA;YAEA,gDAAgD;YAChD,MAAM6I,yBAAyB,CAAC1F,UAAkB2F;gBAChD,MAAM9H,MAAM,IAAI2E;gBAChB3E,IAAIP,GAAG,GAAG0C;YACV,6DAA6D;YAC7D,uDAAuD;YACzD;YAEA,mCAAmC;YACnC0F,uBAAuB,kBAAkB;YAEzC,kDAAkD;YAClD9B,OAAOxB,YAAYwD,GAAG,CAAC/B,oBAAoB,CAAC,+BAA+BD,OAAOI,GAAG,CAAC6B;YAEtFzD,WAAW8B,WAAW;YACtB/C,OAAOqB,KAAK,GAAGD;QACjB;QAEAJ,GAAG,wEAAwE;YACzE,mBAAmB;YACnB,MAAMC,aAAa1F,KAAK2F,KAAK,CAACb,SAAS,OAAOc,kBAAkB;YAEhE,8DAA8D;YAC9D,MAAMC,gBAAgBpB,OAAOqB,KAAK;YAClC,IAAIC,iBAAsC;YAE1CtB,OAAOqB,KAAK,GAAG9F,KAAKG,EAAE,CAAC,IAAO,CAAA;oBAC5BS,KAAK;oBACL,IAAIoF,UAAS;wBAAE,OAAOD;oBAAe;oBACrC,IAAIC,QAAOC,SAA+B;wBACxCF,iBAAiBE;oBACjB,uFAAuF;oBACzF;oBACAC,SAAS;oBACTC,OAAO;oBACPC,QAAQ;oBACRC,kBAAkBrG,KAAKG,EAAE;oBACzBmG,qBAAqBtG,KAAKG,EAAE;gBAC9B,CAAA;YAEA,gDAAgD;YAChD,MAAM6I,yBAAyB,CAAC1F,UAAkB2F;gBAChD,MAAM9H,MAAM,IAAI2E;gBAChB3E,IAAIP,GAAG,GAAG0C;YACV,wDAAwD;YAC1D;YAEA,0DAA0D;YAC1D0F,uBAAuB,kBAAkB;YAEzC,gEAAgE;YAChE9B,OAAOxB,YAAYwD,GAAG,CAAC/B,oBAAoB,CAAC,+BAA+BD,OAAOI,GAAG,CAAC6B;YAEtF,uCAAuC;YACvCjC,OAAOnB,gBAAgBqD,WAAW;YAElC1D,WAAW8B,WAAW;YACtB/C,OAAOqB,KAAK,GAAGD;QACjB;IACF;IAEAV,SAAS,2CAA2C;QAClDM,GAAG,2DAA2D;YAC5D,0BAA0B;YAC1B,MAAMgC,cAAc;gBAClBC,WAAW1H,KAAKG,EAAE;gBAClBwH,cAAc3H,KAAKG,EAAE;gBACrByH,cAAc5H,KAAKG,EAAE;YACvB;YACA,MAAM0H,aAAa;gBACjBC,YAAY9H,KAAKG,EAAE,CAAC,IAAMsH;gBAC1BM,WAAW/H,KAAKG,EAAE,CAAC,IAAM;gBACzBgG,OAAO;gBACPC,QAAQ;YACV;YAEA,8BAA8B;YAC9B,MAAM4B,wBAAwBtB,SAASuB,aAAa;YACpDvB,SAASuB,aAAa,GAAGjI,KAAKG,EAAE,CAAC,CAAC+H;gBAChC,IAAIA,YAAY,UAAU;oBACxB,OAAOL;gBACT;gBACA,OAAOG,sBAAsBG,IAAI,CAACzB,UAAUwB;YAC9C;YAEA,wDAAwD;YACxD,MAAMrC,gBAAgBpB,OAAOqB,KAAK;YAClC,IAAIC,iBAAsC;YAE1CtB,OAAOqB,KAAK,GAAG9F,KAAKG,EAAE,CAAC,IAAO,CAAA;oBAC5BS,KAAK;oBACL,IAAIoF,UAAS;wBAAE,OAAOD;oBAAe;oBACrC,IAAIC,QAAOC,SAA+B;wBACxCF,iBAAiBE;wBACjB,0DAA0D;wBAC1D,IAAIA,UAAU;4BACZA,WAAW,iDAAiD;;wBAC9D;oBACF;oBACAC,SAAS;oBACTC,OAAO;oBACPC,QAAQ;oBACRC,kBAAkBrG,KAAKG,EAAE;oBACzBmG,qBAAqBtG,KAAKG,EAAE;gBAC9B,CAAA;YAEA,uBAAuB;YACvBoG,IAAAA,aAAM,gBAAC,qBAACC,aAAU;YAElB,sBAAsB;YACtB,MAAMC,aAAaC,SAASC,gBAAgB,CAAC;YAC7C,MAAMC,gBAAgBH,UAAU,CAAC,EAAE;YACnC,MAAMI,eAAe,IAAIC,KAAK;gBAAC;aAAO,EAAE,YAAY;gBAAEhD,MAAM;YAAa;YAEzE,+DAA+D;YAC/D,MAAMiD,IAAAA,UAAG,EAAC;gBACRC,gBAAS,CAACC,MAAM,CAACL,eAAe;oBAAEzC,QAAQ;wBAAEC,OAAO;4BAACyC;yBAAa;oBAAC;gBAAE;YACtE;YAEA,iFAAiF;YACjFK,OAAOW,WAAWC,UAAU,EAAEX,oBAAoB,CAAC;YACnDD,OAAOO,YAAYC,SAAS,EAAEU,gBAAgB;YAC9ClB,OAAOW,WAAWE,SAAS,EAAEZ,oBAAoB,CAAC,cAAc;YAEhE,gBAAgB;YAChBT,SAASuB,aAAa,GAAGD;YACzBvD,OAAOqB,KAAK,GAAGD;QACjB;IACF;IAEAV,SAAS,6BAA6B;QACpCM,GAAG,mCAAmC;YACpCc,IAAAA,aAAM,gBAAC,qBAACC,aAAU;YAElB,MAAM,EAAEtG,YAAY,EAAEG,cAAc,EAAE,GAAGgI,QAAQ;YAC/CnI,aAA2BE,iBAAiB,CAAC;YAC7CC,eAA6BD,iBAAiB,CAAC;YAG/CqE,OAAOG,KAAK,CAAe0D,iBAAiB,CAAC,IAAI/H,MAAM;YAEzD,8BAA8B;YAC9B,MAAMkG,aAAaC,SAASC,gBAAgB,CAAC;YAC7C,MAAMC,gBAAgBH,UAAU,CAAC,EAAE;YACnC,MAAM8B,mBAAmB9B,UAAU,CAAC,EAAE;YAEtC,MAAMI,eAAe,IAAIC,KAAK;gBAAC;aAAO,EAAE,YAAY;gBAAEhD,MAAM;YAAa;YACzE,MAAM0E,kBAAkB,IAAI1B,KAAK;gBAAC;aAAO,EAAE,eAAe;gBAAEhD,MAAM;YAAa;YAE/E,MAAMiD,IAAAA,UAAG,EAAC;gBACRC,gBAAS,CAACC,MAAM,CAACL,eAAe;oBAAEzC,QAAQ;wBAAEC,OAAO;4BAACyC;yBAAa;oBAAC;gBAAE;gBACpEG,gBAAS,CAACC,MAAM,CAACsB,kBAAkB;oBAAEpE,QAAQ;wBAAEC,OAAO;4BAACoE;yBAAgB;oBAAC;gBAAE;YAC5E;YAEA,sBAAsB;YACtB,MAAMC,eAAeC,aAAM,CAACC,SAAS,CAAC,UAAU;gBAAEjI,MAAM;YAAyB;YACjF,MAAM4D,KAAKsE,KAAK,CAACH;YAEjB,2CAA2C;YAC3C,MAAMI,IAAAA,cAAO,EAAC;gBACZ3B,OAAOwB,aAAM,CAACI,SAAS,CAAC,sBAAsBC,iBAAiB;YACjE;QACF;QAEAtD,GAAG,+CAA+C;YAChDc,IAAAA,aAAM,gBAAC,qBAACC,aAAU;YAElB,MAAM,EAAEtG,YAAY,EAAEG,cAAc,EAAEC,sBAAsB,EAAE,GAAG+H,QAAQ;YACvEnI,aAA2BE,iBAAiB,CAAC;YAC7CC,eAA6BiI,iBAAiB,CAAC,IAAIhI,uBAAuB;YAE5E,8BAA8B;YAC9B,MAAMmG,aAAaC,SAASC,gBAAgB,CAAC;YAC7C,MAAMC,gBAAgBH,UAAU,CAAC,EAAE;YACnC,MAAM8B,mBAAmB9B,UAAU,CAAC,EAAE;YAEtC,MAAMI,eAAe,IAAIC,KAAK;gBAAC;aAAO,EAAE,YAAY;gBAAEhD,MAAM;YAAa;YACzE,MAAM0E,kBAAkB,IAAI1B,KAAK;gBAAC;aAAO,EAAE,eAAe;gBAAEhD,MAAM;YAAa;YAE/E,MAAMiD,IAAAA,UAAG,EAAC;gBACRC,gBAAS,CAACC,MAAM,CAACL,eAAe;oBAAEzC,QAAQ;wBAAEC,OAAO;4BAACyC;yBAAa;oBAAC;gBAAE;gBACpEG,gBAAS,CAACC,MAAM,CAACsB,kBAAkB;oBAAEpE,QAAQ;wBAAEC,OAAO;4BAACoE;yBAAgB;oBAAC;gBAAE;YAC5E;YAEA,sBAAsB;YACtB,MAAMC,eAAeC,aAAM,CAACC,SAAS,CAAC,UAAU;gBAAEjI,MAAM;YAAyB;YACjF,MAAM4D,KAAKsE,KAAK,CAACH;YAEjB,gCAAgC;YAChC,MAAMI,IAAAA,cAAO,EAAC;gBACZ3B,OAAOwB,aAAM,CAACI,SAAS,CAAC,8CAA8CC,iBAAiB;YACzF;QACF;IACF;AACF"}