{"version":3,"sources":["/Users/willstreeter/WebstormProjects/vibe-coding/those-people/The-Sus-Fit-gp/__tests__/business-layer/hooks/useTryonHistory.test.tsx"],"sourcesContent":["/**\n * @jest-environment jsdom\n */\n\nimport React from 'react';\nimport { renderHook, act, waitFor } from '@testing-library/react';\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\nimport { useTryonHistory, useTryonHistoryEntry, useTryonHistoryStats } from '../../../src/business-layer/hooks/useTryonHistory';\nimport type { \n  TryonHistoryService, \n  TryonHistoryEntry, \n  TryonHistoryCollection,\n  CreateTryonHistoryEntryOptions \n} from '../../../src/business-layer/types/history.types';\n\n// Mock history service\nconst mockHistoryService: TryonHistoryService = {\n  addEntry: jest.fn(),\n  getEntries: jest.fn(),\n  getEntry: jest.fn(),\n  updateEntry: jest.fn(),\n  deleteEntry: jest.fn(),\n  clearAll: jest.fn(),\n  getStorageStats: jest.fn(),\n  exportHistory: jest.fn(),\n  importHistory: jest.fn()\n};\n\n// Test data\nconst sampleHistoryEntry: TryonHistoryEntry = {\n  id: 'test-entry-1',\n  timestamp: '2023-01-01T00:00:00Z',\n  generatedImage: 'data:image/jpeg;base64,generated',\n  modelImage: 'data:image/jpeg;base64,model',\n  apparelImages: ['data:image/jpeg;base64,apparel'],\n  processingTime: 5000,\n  tags: ['test'],\n  notes: 'Test entry',\n  isFavorite: false\n};\n\nconst sampleHistoryCollection: TryonHistoryCollection = {\n  entries: [sampleHistoryEntry],\n  totalCount: 1,\n  currentPage: 0,\n  pageSize: 20,\n  hasMore: false,\n  lastUpdated: '2023-01-01T00:00:00Z'\n};\n\n// Test wrapper component\nconst createWrapper = () => {\n  const queryClient = new QueryClient({\n    defaultOptions: {\n      queries: { retry: false },\n      mutations: { retry: false }\n    }\n  });\n\n  return ({ children }: { children: React.ReactNode }) => (\n    <QueryClientProvider client={queryClient}>\n      {children}\n    </QueryClientProvider>\n  );\n};\n\ndescribe('useTryonHistory', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n    \n    // Setup default mock implementations\n    (mockHistoryService.getEntries as jest.Mock).mockResolvedValue(sampleHistoryCollection);\n    (mockHistoryService.addEntry as jest.Mock).mockResolvedValue(sampleHistoryEntry);\n    (mockHistoryService.updateEntry as jest.Mock).mockResolvedValue(sampleHistoryEntry);\n    (mockHistoryService.deleteEntry as jest.Mock).mockResolvedValue(true);\n    (mockHistoryService.clearAll as jest.Mock).mockResolvedValue(true);\n  });\n\n  describe('Basic Functionality', () => {\n    it('should initialize with default state', async () => {\n      const wrapper = createWrapper();\n      const { result } = renderHook(() => \n        useTryonHistory({}, { historyService: mockHistoryService }), \n        { wrapper }\n      );\n\n      expect(result.current.entries).toEqual([]);\n      expect(result.current.isLoading).toBe(true);\n      expect(result.current.error).toBe(null);\n      expect(result.current.hasMore).toBe(false);\n      expect(result.current.currentPage).toBe(0);\n      expect(result.current.totalCount).toBe(0);\n\n      // Wait for query to complete\n      await waitFor(() => {\n        expect(result.current.isLoading).toBe(false);\n      });\n\n      expect(result.current.entries).toEqual([sampleHistoryEntry]);\n      expect(result.current.totalCount).toBe(1);\n    });\n\n    it('should call getEntries with correct options', async () => {\n      const wrapper = createWrapper();\n      const queryOptions = {\n        page: 0,\n        pageSize: 10,\n        sortBy: 'timestamp' as const,\n        sortDirection: 'desc' as const\n      };\n\n      renderHook(() => \n        useTryonHistory(queryOptions, { historyService: mockHistoryService }),\n        { wrapper }\n      );\n\n      await waitFor(() => {\n        expect(mockHistoryService.getEntries).toHaveBeenCalledWith({\n          page: 0,\n          pageSize: 10,\n          sortBy: 'timestamp',\n          sortDirection: 'desc'\n        });\n      });\n    });\n\n    it('should handle loading states correctly', async () => {\n      const wrapper = createWrapper();\n      \n      // Make getEntries return a pending promise\n      let resolveGetEntries: (value: TryonHistoryCollection) => void;\n      const pendingPromise = new Promise<TryonHistoryCollection>((resolve) => {\n        resolveGetEntries = resolve;\n      });\n      (mockHistoryService.getEntries as jest.Mock).mockReturnValue(pendingPromise);\n\n      const { result } = renderHook(() => \n        useTryonHistory({}, { historyService: mockHistoryService }),\n        { wrapper }\n      );\n\n      expect(result.current.isLoading).toBe(true);\n\n      // Resolve the promise\n      act(() => {\n        resolveGetEntries!(sampleHistoryCollection);\n      });\n\n      await waitFor(() => {\n        expect(result.current.isLoading).toBe(false);\n      });\n\n      expect(result.current.entries).toEqual([sampleHistoryEntry]);\n    });\n  });\n\n  describe('Adding Entries', () => {\n    it('should add new entry successfully', async () => {\n      const wrapper = createWrapper();\n      const { result } = renderHook(() => \n        useTryonHistory({}, { historyService: mockHistoryService }),\n        { wrapper }\n      );\n\n      // Wait for initial load\n      await waitFor(() => {\n        expect(result.current.isLoading).toBe(false);\n      });\n\n      const newEntryOptions: CreateTryonHistoryEntryOptions = {\n        generatedImage: 'new-generated',\n        modelImage: 'new-model',\n        apparelImages: ['new-apparel'],\n        notes: 'New entry'\n      };\n\n      await act(async () => {\n        await result.current.addEntry(newEntryOptions);\n      });\n\n      expect(mockHistoryService.addEntry).toHaveBeenCalledWith(newEntryOptions);\n    });\n\n    it('should handle add entry errors', async () => {\n      const wrapper = createWrapper();\n      const { result } = renderHook(() => \n        useTryonHistory({}, { historyService: mockHistoryService }),\n        { wrapper }\n      );\n\n      const error = new Error('Failed to add entry');\n      (mockHistoryService.addEntry as jest.Mock).mockRejectedValue(error);\n\n      await waitFor(() => {\n        expect(result.current.isLoading).toBe(false);\n      });\n\n      const newEntryOptions: CreateTryonHistoryEntryOptions = {\n        generatedImage: 'new-generated',\n        modelImage: 'new-model',\n        apparelImages: ['new-apparel']\n      };\n\n      await expect(\n        act(async () => {\n          await result.current.addEntry(newEntryOptions);\n        })\n      ).rejects.toThrow('Failed to add entry');\n    });\n  });\n\n  describe('Updating Entries', () => {\n    it('should update entry successfully', async () => {\n      const wrapper = createWrapper();\n      const { result } = renderHook(() => \n        useTryonHistory({}, { historyService: mockHistoryService }),\n        { wrapper }\n      );\n\n      await waitFor(() => {\n        expect(result.current.isLoading).toBe(false);\n      });\n\n      const updates = { notes: 'Updated notes', isFavorite: true };\n\n      await act(async () => {\n        await result.current.updateEntry('test-entry-1', updates);\n      });\n\n      expect(mockHistoryService.updateEntry).toHaveBeenCalledWith('test-entry-1', updates);\n    });\n  });\n\n  describe('Deleting Entries', () => {\n    it('should delete entry successfully', async () => {\n      const wrapper = createWrapper();\n      const { result } = renderHook(() => \n        useTryonHistory({}, { historyService: mockHistoryService }),\n        { wrapper }\n      );\n\n      await waitFor(() => {\n        expect(result.current.isLoading).toBe(false);\n      });\n\n      await act(async () => {\n        await result.current.deleteEntry('test-entry-1');\n      });\n\n      expect(mockHistoryService.deleteEntry).toHaveBeenCalledWith('test-entry-1');\n    });\n  });\n\n  describe('Load More Functionality', () => {\n    it('should load more entries when hasMore is true', async () => {\n      const wrapper = createWrapper();\n      const collectionWithMore: TryonHistoryCollection = {\n        ...sampleHistoryCollection,\n        hasMore: true\n      };\n      \n      (mockHistoryService.getEntries as jest.Mock).mockResolvedValue(collectionWithMore);\n\n      const { result } = renderHook(() => \n        useTryonHistory({}, { historyService: mockHistoryService }),\n        { wrapper }\n      );\n\n      await waitFor(() => {\n        expect(result.current.isLoading).toBe(false);\n      });\n\n      expect(result.current.hasMore).toBe(true);\n\n      // Setup next page response\n      const nextPageCollection: TryonHistoryCollection = {\n        entries: [{ ...sampleHistoryEntry, id: 'test-entry-2' }],\n        totalCount: 2,\n        currentPage: 1,\n        pageSize: 20,\n        hasMore: false,\n        lastUpdated: '2023-01-01T00:00:00Z'\n      };\n      \n      (mockHistoryService.getEntries as jest.Mock).mockResolvedValueOnce(nextPageCollection);\n\n      await act(async () => {\n        await result.current.loadMore();\n      });\n\n      expect(mockHistoryService.getEntries).toHaveBeenCalledWith(\n        expect.objectContaining({ page: 1 })\n      );\n    });\n\n    it('should not load more when hasMore is false', async () => {\n      const wrapper = createWrapper();\n      const { result } = renderHook(() => \n        useTryonHistory({}, { historyService: mockHistoryService }),\n        { wrapper }\n      );\n\n      await waitFor(() => {\n        expect(result.current.isLoading).toBe(false);\n      });\n\n      expect(result.current.hasMore).toBe(false);\n\n      // Should not make additional calls\n      const initialCallCount = (mockHistoryService.getEntries as jest.Mock).mock.calls.length;\n\n      await act(async () => {\n        await result.current.loadMore();\n      });\n\n      expect((mockHistoryService.getEntries as jest.Mock).mock.calls.length).toBe(initialCallCount);\n    });\n  });\n\n  describe('Refresh Functionality', () => {\n    it('should refresh entries', async () => {\n      const wrapper = createWrapper();\n      const { result } = renderHook(() => \n        useTryonHistory({}, { historyService: mockHistoryService }),\n        { wrapper }\n      );\n\n      await waitFor(() => {\n        expect(result.current.isLoading).toBe(false);\n      });\n\n      await act(async () => {\n        await result.current.refresh();\n      });\n\n      // Should trigger a refetch\n      expect(mockHistoryService.getEntries).toHaveBeenCalledTimes(2);\n    });\n  });\n\n  describe('Clear All Functionality', () => {\n    it('should clear all entries', async () => {\n      const wrapper = createWrapper();\n      const { result } = renderHook(() => \n        useTryonHistory({}, { historyService: mockHistoryService }),\n        { wrapper }\n      );\n\n      await waitFor(() => {\n        expect(result.current.isLoading).toBe(false);\n      });\n\n      await act(async () => {\n        await result.current.clearAll();\n      });\n\n      expect(mockHistoryService.clearAll).toHaveBeenCalled();\n    });\n  });\n});\n\ndescribe('useTryonHistoryEntry', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n    (mockHistoryService.getEntry as jest.Mock).mockResolvedValue(sampleHistoryEntry);\n  });\n\n  it('should fetch single entry by ID', async () => {\n    const wrapper = createWrapper();\n    const { result } = renderHook(() => \n      useTryonHistoryEntry('test-entry-1', { historyService: mockHistoryService }),\n      { wrapper }\n    );\n\n    await waitFor(() => {\n      expect(result.current.isLoading).toBe(false);\n    });\n\n    expect(mockHistoryService.getEntry).toHaveBeenCalledWith('test-entry-1');\n    expect(result.current.data).toEqual(sampleHistoryEntry);\n  });\n\n  it('should not fetch when ID is empty', async () => {\n    const wrapper = createWrapper();\n    renderHook(() => \n      useTryonHistoryEntry('', { historyService: mockHistoryService }),\n      { wrapper }\n    );\n\n    // Should not make any calls when ID is empty\n    expect(mockHistoryService.getEntry).not.toHaveBeenCalled();\n  });\n\n  it('should handle entry not found', async () => {\n    const wrapper = createWrapper();\n    (mockHistoryService.getEntry as jest.Mock).mockResolvedValue(null);\n\n    const { result } = renderHook(() => \n      useTryonHistoryEntry('non-existent-id', { historyService: mockHistoryService }),\n      { wrapper }\n    );\n\n    await waitFor(() => {\n      expect(result.current.isLoading).toBe(false);\n    });\n\n    expect(result.current.data).toBe(null);\n  });\n});\n\ndescribe('useTryonHistoryStats', () => {\n  const mockStats = {\n    totalEntries: 10,\n    totalSizeKB: 1024,\n    oldestEntry: '2023-01-01T00:00:00Z',\n    newestEntry: '2023-01-02T00:00:00Z'\n  };\n\n  beforeEach(() => {\n    jest.clearAllMocks();\n    (mockHistoryService.getStorageStats as jest.Mock).mockResolvedValue(mockStats);\n  });\n\n  it('should fetch storage statistics', async () => {\n    const wrapper = createWrapper();\n    const { result } = renderHook(() => \n      useTryonHistoryStats({ historyService: mockHistoryService }),\n      { wrapper }\n    );\n\n    await waitFor(() => {\n      expect(result.current.isLoading).toBe(false);\n    });\n\n    expect(mockHistoryService.getStorageStats).toHaveBeenCalled();\n    expect(result.current.data).toEqual(mockStats);\n  });\n\n  it('should handle stats loading error', async () => {\n    const wrapper = createWrapper();\n    const error = new Error('Failed to get stats');\n    (mockHistoryService.getStorageStats as jest.Mock).mockRejectedValue(error);\n\n    const { result } = renderHook(() => \n      useTryonHistoryStats({ historyService: mockHistoryService }),\n      { wrapper }\n    );\n\n    await waitFor(() => {\n      expect(result.current.isLoading).toBe(false);\n    });\n\n    expect(result.current.error).toBeTruthy();\n  });\n});"],"names":["mockHistoryService","addEntry","jest","fn","getEntries","getEntry","updateEntry","deleteEntry","clearAll","getStorageStats","exportHistory","importHistory","sampleHistoryEntry","id","timestamp","generatedImage","modelImage","apparelImages","processingTime","tags","notes","isFavorite","sampleHistoryCollection","entries","totalCount","currentPage","pageSize","hasMore","lastUpdated","createWrapper","queryClient","QueryClient","defaultOptions","queries","retry","mutations","children","QueryClientProvider","client","describe","beforeEach","clearAllMocks","mockResolvedValue","it","wrapper","result","renderHook","useTryonHistory","historyService","expect","current","toEqual","isLoading","toBe","error","waitFor","queryOptions","page","sortBy","sortDirection","toHaveBeenCalledWith","resolveGetEntries","pendingPromise","Promise","resolve","mockReturnValue","act","newEntryOptions","Error","mockRejectedValue","rejects","toThrow","updates","collectionWithMore","nextPageCollection","mockResolvedValueOnce","loadMore","objectContaining","initialCallCount","mock","calls","length","refresh","toHaveBeenCalledTimes","toHaveBeenCalled","useTryonHistoryEntry","data","not","mockStats","totalEntries","totalSizeKB","oldestEntry","newestEntry","useTryonHistoryStats","toBeTruthy"],"mappings":"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"}