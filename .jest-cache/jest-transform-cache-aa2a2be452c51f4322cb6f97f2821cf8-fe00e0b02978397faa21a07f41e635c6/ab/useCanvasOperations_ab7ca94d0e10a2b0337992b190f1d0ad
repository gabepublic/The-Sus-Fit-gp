376d5b61eea66d921f045ac77f7ca863
'use client';
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    useAdvancedCanvasOperations: function() {
        return useAdvancedCanvasOperations;
    },
    useCanvasAnimation: function() {
        return useCanvasAnimation;
    },
    useCanvasHistory: function() {
        return useCanvasHistory;
    },
    useCanvasImageLoader: function() {
        return useCanvasImageLoader;
    },
    useCanvasPerformance: function() {
        return useCanvasPerformance;
    },
    useCanvasResize: function() {
        return useCanvasResize;
    }
});
const _react = require("react");
const _CanvasProvider = require("../providers/CanvasProvider");
const _canvasUtils = require("../utils/canvasUtils");
function useAdvancedCanvasOperations(width, height, canvasId) {
    const canvas = (0, _CanvasProvider.useManagedCanvas)(width, height, canvasId);
    const operationsRef = (0, _react.useRef)();
    if (!operationsRef.current) {
        operationsRef.current = (0, _canvasUtils.createAdvancedCanvasOperations)(canvas);
    }
    const saveState = (0, _react.useCallback)(()=>{
        return operationsRef.current.saveState();
    }, []);
    const restoreState = (0, _react.useCallback)((state)=>{
        operationsRef.current.restoreState(state);
    }, []);
    const clear = (0, _react.useCallback)(()=>{
        canvas.context.clearRect(0, 0, canvas.canvas.width, canvas.canvas.height);
    }, [
        canvas
    ]);
    return {
        canvas,
        operations: operationsRef.current,
        saveState,
        restoreState,
        clear
    };
}
function useCanvasAnimation() {
    const [isRunning, setIsRunning] = (0, _react.useState)(false);
    const animationUtilsRef = (0, _react.useRef)();
    if (!animationUtilsRef.current) {
        animationUtilsRef.current = (0, _canvasUtils.createCanvasAnimationUtils)();
    }
    const startAnimation = (0, _react.useCallback)((callback)=>{
        animationUtilsRef.current.startAnimation(callback);
        setIsRunning(true);
    }, []);
    const stopAnimation = (0, _react.useCallback)(()=>{
        animationUtilsRef.current.stopAnimation();
        setIsRunning(false);
    }, []);
    const animateProperty = (0, _react.useCallback)((from, to, duration, easing, onUpdate, onComplete)=>{
        return _canvasUtils.CanvasAnimationUtils.animateProperty(from, to, duration, easing, onUpdate, ()=>{
            onComplete?.();
            setIsRunning(false);
        });
    }, []);
    (0, _react.useEffect)(()=>{
        return ()=>{
            stopAnimation();
        };
    }, [
        stopAnimation
    ]);
    return {
        isRunning,
        startAnimation,
        stopAnimation,
        animateProperty
    };
}
function useCanvasHistory(canvas, maxHistorySize = 20) {
    const [history, setHistory] = (0, _react.useState)([]);
    const [currentIndex, setCurrentIndex] = (0, _react.useState)(-1);
    const operationsRef = (0, _react.useRef)((0, _canvasUtils.createAdvancedCanvasOperations)(canvas));
    const canUndo = currentIndex > 0;
    const canRedo = currentIndex < history.length - 1;
    const saveState = (0, _react.useCallback)(()=>{
        const state = operationsRef.current.saveState();
        setHistory((prev)=>{
            const newHistory = prev.slice(0, currentIndex + 1);
            newHistory.push(state);
            // Limit history size
            if (newHistory.length > maxHistorySize) {
                newHistory.shift();
                return newHistory;
            }
            return newHistory;
        });
        setCurrentIndex((prev)=>{
            const newIndex = prev + 1;
            return newIndex >= maxHistorySize ? maxHistorySize - 1 : newIndex;
        });
    }, [
        currentIndex,
        maxHistorySize
    ]);
    const undo = (0, _react.useCallback)(()=>{
        if (!canUndo) return;
        const newIndex = currentIndex - 1;
        const state = history[newIndex];
        if (state) {
            operationsRef.current.restoreState(state);
            setCurrentIndex(newIndex);
        }
    }, [
        canUndo,
        currentIndex,
        history
    ]);
    const redo = (0, _react.useCallback)(()=>{
        if (!canRedo) return;
        const newIndex = currentIndex + 1;
        const state = history[newIndex];
        if (state) {
            operationsRef.current.restoreState(state);
            setCurrentIndex(newIndex);
        }
    }, [
        canRedo,
        currentIndex,
        history
    ]);
    const clear = (0, _react.useCallback)(()=>{
        setHistory([]);
        setCurrentIndex(-1);
    }, []);
    // Save initial state
    (0, _react.useEffect)(()=>{
        if (history.length === 0) {
            saveState();
        }
    }, []);
    return {
        canUndo,
        canRedo,
        saveState,
        undo,
        redo,
        clear,
        historySize: history.length
    };
}
function useCanvasPerformance() {
    const measureOperation = (0, _react.useCallback)((operation, name)=>{
        return _canvasUtils.CanvasPerformanceUtils.measureOperation(operation, name);
    }, []);
    const debounce = (0, _react.useCallback)((func, wait)=>{
        return _canvasUtils.CanvasPerformanceUtils.debounce(func, wait);
    }, []);
    const throttle = (0, _react.useCallback)((func, limit)=>{
        return _canvasUtils.CanvasPerformanceUtils.throttle(func, limit);
    }, []);
    const isCanvasSizeSafe = (0, _react.useCallback)((width, height)=>{
        return _canvasUtils.CanvasPerformanceUtils.isCanvasSizeSafe(width, height);
    }, []);
    return {
        measureOperation,
        debounce,
        throttle,
        isCanvasSizeSafe
    };
}
function useCanvasImageLoader(canvas) {
    const [isLoading, setIsLoading] = (0, _react.useState)(false);
    const [error, setError] = (0, _react.useState)(null);
    const { utils } = (0, _CanvasProvider.useCanvas)();
    const operationsRef = (0, _react.useRef)((0, _canvasUtils.createAdvancedCanvasOperations)(canvas));
    const loadImage = (0, _react.useCallback)(async (url)=>{
        setIsLoading(true);
        setError(null);
        try {
            const img = new Image();
            img.crossOrigin = 'anonymous';
            await new Promise((resolve, reject)=>{
                img.onload = ()=>resolve();
                img.onerror = ()=>reject(new Error('Failed to load image'));
                img.src = url;
            });
            setIsLoading(false);
            return img;
        } catch (err) {
            const errorMessage = err instanceof Error ? err.message : 'Unknown error loading image';
            setError(errorMessage);
            setIsLoading(false);
            throw new Error(errorMessage);
        }
    }, []);
    const drawImage = (0, _react.useCallback)((image, x = 0, y = 0, width, height, blendMode = _canvasUtils.BlendMode.Normal, opacity = 1)=>{
        operationsRef.current.drawImageWithBlendMode(image, x, y, width, height, blendMode, opacity);
    }, []);
    const loadAndDrawImage = (0, _react.useCallback)(async (url, x = 0, y = 0, width, height, blendMode = _canvasUtils.BlendMode.Normal, opacity = 1)=>{
        const image = await loadImage(url);
        drawImage(image, x, y, width, height, blendMode, opacity);
    }, [
        loadImage,
        drawImage
    ]);
    return {
        loadImage,
        drawImage,
        loadAndDrawImage,
        isLoading,
        error
    };
}
function useCanvasResize(canvas, maintainContent = true) {
    const [dimensions, setDimensions] = (0, _react.useState)(canvas.dimensions);
    const { utils } = (0, _CanvasProvider.useCanvas)();
    const resize = (0, _react.useCallback)((newWidth, newHeight)=>{
        if (maintainContent) {
            utils.resizeCanvas(canvas.canvas, newWidth, newHeight);
        } else {
            canvas.canvas.width = newWidth;
            canvas.canvas.height = newHeight;
            canvas.canvas.style.width = `${newWidth}px`;
            canvas.canvas.style.height = `${newHeight}px`;
        }
        canvas.dimensions = {
            width: newWidth,
            height: newHeight
        };
        setDimensions({
            width: newWidth,
            height: newHeight
        });
    }, [
        canvas,
        maintainContent,
        utils
    ]);
    const autoResize = (0, _react.useCallback)((container)=>{
        const resizeObserver = new ResizeObserver((entries)=>{
            const entry = entries[0];
            if (entry) {
                const { width, height } = entry.contentRect;
                resize(width, height);
            }
        });
        resizeObserver.observe(container);
        return ()=>{
            resizeObserver.disconnect();
        };
    }, [
        resize
    ]);
    return {
        resize,
        autoResize,
        dimensions
    };
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy93aWxsc3RyZWV0ZXIvV2Vic3Rvcm1Qcm9qZWN0cy92aWJlLWNvZGluZy90aG9zZS1wZW9wbGUvVGhlLVN1cy1GaXQtZ3Avc3JjL2J1c2luZXNzLWxheWVyL2hvb2tzL3VzZUNhbnZhc09wZXJhdGlvbnMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBjbGllbnQnO1xuXG4vLyBDYW52YXMgT3BlcmF0aW9ucyBIb29rc1xuLy8gUmVhY3QgaG9va3MgZm9yIGNvbW1vbiBjYW52YXMgb3BlcmF0aW9ucyBhbmQgcGF0dGVybnNcblxuaW1wb3J0IHsgdXNlQ2FsbGJhY2ssIHVzZVJlZiwgdXNlRWZmZWN0LCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IFxuICB1c2VDYW52YXMsIFxuICB1c2VNYW5hZ2VkQ2FudmFzLCBcbiAgdHlwZSBNYW5hZ2VkQ2FudmFzIFxufSBmcm9tICcuLi9wcm92aWRlcnMvQ2FudmFzUHJvdmlkZXInO1xuaW1wb3J0IHsgXG4gIEFkdmFuY2VkQ2FudmFzT3BlcmF0aW9ucyxcbiAgQ2FudmFzQW5pbWF0aW9uVXRpbHMsXG4gIENhbnZhc1BlcmZvcm1hbmNlVXRpbHMsXG4gIGNyZWF0ZUFkdmFuY2VkQ2FudmFzT3BlcmF0aW9ucyxcbiAgY3JlYXRlQ2FudmFzQW5pbWF0aW9uVXRpbHMsXG4gIEJsZW5kTW9kZSxcbiAgdHlwZSBDYW52YXNTdGF0ZVxufSBmcm9tICcuLi91dGlscy9jYW52YXNVdGlscyc7XG5cbi8qKlxuICogSG9vayBmb3IgYWR2YW5jZWQgY2FudmFzIG9wZXJhdGlvbnNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZUFkdmFuY2VkQ2FudmFzT3BlcmF0aW9ucyhcbiAgd2lkdGg6IG51bWJlcixcbiAgaGVpZ2h0OiBudW1iZXIsXG4gIGNhbnZhc0lkPzogc3RyaW5nXG4pOiB7XG4gIGNhbnZhczogTWFuYWdlZENhbnZhcztcbiAgb3BlcmF0aW9uczogQWR2YW5jZWRDYW52YXNPcGVyYXRpb25zO1xuICBzYXZlU3RhdGU6ICgpID0+IENhbnZhc1N0YXRlO1xuICByZXN0b3JlU3RhdGU6IChzdGF0ZTogQ2FudmFzU3RhdGUpID0+IHZvaWQ7XG4gIGNsZWFyOiAoKSA9PiB2b2lkO1xufSB7XG4gIGNvbnN0IGNhbnZhcyA9IHVzZU1hbmFnZWRDYW52YXMod2lkdGgsIGhlaWdodCwgY2FudmFzSWQpO1xuICBjb25zdCBvcGVyYXRpb25zUmVmID0gdXNlUmVmPEFkdmFuY2VkQ2FudmFzT3BlcmF0aW9ucz4oKTtcbiAgXG4gIGlmICghb3BlcmF0aW9uc1JlZi5jdXJyZW50KSB7XG4gICAgb3BlcmF0aW9uc1JlZi5jdXJyZW50ID0gY3JlYXRlQWR2YW5jZWRDYW52YXNPcGVyYXRpb25zKGNhbnZhcyk7XG4gIH1cblxuICBjb25zdCBzYXZlU3RhdGUgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgcmV0dXJuIG9wZXJhdGlvbnNSZWYuY3VycmVudCEuc2F2ZVN0YXRlKCk7XG4gIH0sIFtdKTtcblxuICBjb25zdCByZXN0b3JlU3RhdGUgPSB1c2VDYWxsYmFjaygoc3RhdGU6IENhbnZhc1N0YXRlKSA9PiB7XG4gICAgb3BlcmF0aW9uc1JlZi5jdXJyZW50IS5yZXN0b3JlU3RhdGUoc3RhdGUpO1xuICB9LCBbXSk7XG5cbiAgY29uc3QgY2xlYXIgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgY2FudmFzLmNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIGNhbnZhcy5jYW52YXMud2lkdGgsIGNhbnZhcy5jYW52YXMuaGVpZ2h0KTtcbiAgfSwgW2NhbnZhc10pO1xuXG4gIHJldHVybiB7XG4gICAgY2FudmFzLFxuICAgIG9wZXJhdGlvbnM6IG9wZXJhdGlvbnNSZWYuY3VycmVudCxcbiAgICBzYXZlU3RhdGUsXG4gICAgcmVzdG9yZVN0YXRlLFxuICAgIGNsZWFyXG4gIH07XG59XG5cbi8qKlxuICogSG9vayBmb3IgY2FudmFzIGFuaW1hdGlvbiBzdXBwb3J0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1c2VDYW52YXNBbmltYXRpb24oKToge1xuICBpc1J1bm5pbmc6IGJvb2xlYW47XG4gIHN0YXJ0QW5pbWF0aW9uOiAoY2FsbGJhY2s6ICh0aW1lc3RhbXA6IG51bWJlcikgPT4gdm9pZCkgPT4gdm9pZDtcbiAgc3RvcEFuaW1hdGlvbjogKCkgPT4gdm9pZDtcbiAgYW5pbWF0ZVByb3BlcnR5OiAoXG4gICAgZnJvbTogbnVtYmVyLFxuICAgIHRvOiBudW1iZXIsXG4gICAgZHVyYXRpb246IG51bWJlcixcbiAgICBlYXNpbmc6ICh0OiBudW1iZXIpID0+IG51bWJlcixcbiAgICBvblVwZGF0ZTogKHZhbHVlOiBudW1iZXIpID0+IHZvaWQsXG4gICAgb25Db21wbGV0ZT86ICgpID0+IHZvaWRcbiAgKSA9PiAoKCkgPT4gdm9pZCk7XG59IHtcbiAgY29uc3QgW2lzUnVubmluZywgc2V0SXNSdW5uaW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgYW5pbWF0aW9uVXRpbHNSZWYgPSB1c2VSZWY8Q2FudmFzQW5pbWF0aW9uVXRpbHM+KCk7XG5cbiAgaWYgKCFhbmltYXRpb25VdGlsc1JlZi5jdXJyZW50KSB7XG4gICAgYW5pbWF0aW9uVXRpbHNSZWYuY3VycmVudCA9IGNyZWF0ZUNhbnZhc0FuaW1hdGlvblV0aWxzKCk7XG4gIH1cblxuICBjb25zdCBzdGFydEFuaW1hdGlvbiA9IHVzZUNhbGxiYWNrKChjYWxsYmFjazogKHRpbWVzdGFtcDogbnVtYmVyKSA9PiB2b2lkKSA9PiB7XG4gICAgYW5pbWF0aW9uVXRpbHNSZWYuY3VycmVudCEuc3RhcnRBbmltYXRpb24oY2FsbGJhY2spO1xuICAgIHNldElzUnVubmluZyh0cnVlKTtcbiAgfSwgW10pO1xuXG4gIGNvbnN0IHN0b3BBbmltYXRpb24gPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgYW5pbWF0aW9uVXRpbHNSZWYuY3VycmVudCEuc3RvcEFuaW1hdGlvbigpO1xuICAgIHNldElzUnVubmluZyhmYWxzZSk7XG4gIH0sIFtdKTtcblxuICBjb25zdCBhbmltYXRlUHJvcGVydHkgPSB1c2VDYWxsYmFjaygoXG4gICAgZnJvbTogbnVtYmVyLFxuICAgIHRvOiBudW1iZXIsXG4gICAgZHVyYXRpb246IG51bWJlcixcbiAgICBlYXNpbmc6ICh0OiBudW1iZXIpID0+IG51bWJlcixcbiAgICBvblVwZGF0ZTogKHZhbHVlOiBudW1iZXIpID0+IHZvaWQsXG4gICAgb25Db21wbGV0ZT86ICgpID0+IHZvaWRcbiAgKSA9PiB7XG4gICAgcmV0dXJuIENhbnZhc0FuaW1hdGlvblV0aWxzLmFuaW1hdGVQcm9wZXJ0eShcbiAgICAgIGZyb20sIHRvLCBkdXJhdGlvbiwgZWFzaW5nLCBvblVwZGF0ZSwgXG4gICAgICAoKSA9PiB7XG4gICAgICAgIG9uQ29tcGxldGU/LigpO1xuICAgICAgICBzZXRJc1J1bm5pbmcoZmFsc2UpO1xuICAgICAgfVxuICAgICk7XG4gIH0sIFtdKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBzdG9wQW5pbWF0aW9uKCk7XG4gICAgfTtcbiAgfSwgW3N0b3BBbmltYXRpb25dKTtcblxuICByZXR1cm4ge1xuICAgIGlzUnVubmluZyxcbiAgICBzdGFydEFuaW1hdGlvbixcbiAgICBzdG9wQW5pbWF0aW9uLFxuICAgIGFuaW1hdGVQcm9wZXJ0eVxuICB9O1xufVxuXG4vKipcbiAqIEhvb2sgZm9yIGNhbnZhcyBzdGF0ZSBtYW5hZ2VtZW50IHdpdGggdW5kby9yZWRvIGZ1bmN0aW9uYWxpdHlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZUNhbnZhc0hpc3RvcnkoXG4gIGNhbnZhczogTWFuYWdlZENhbnZhcyxcbiAgbWF4SGlzdG9yeVNpemU6IG51bWJlciA9IDIwXG4pOiB7XG4gIGNhblVuZG86IGJvb2xlYW47XG4gIGNhblJlZG86IGJvb2xlYW47XG4gIHNhdmVTdGF0ZTogKCkgPT4gdm9pZDtcbiAgdW5kbzogKCkgPT4gdm9pZDtcbiAgcmVkbzogKCkgPT4gdm9pZDtcbiAgY2xlYXI6ICgpID0+IHZvaWQ7XG4gIGhpc3RvcnlTaXplOiBudW1iZXI7XG59IHtcbiAgY29uc3QgW2hpc3RvcnksIHNldEhpc3RvcnldID0gdXNlU3RhdGU8Q2FudmFzU3RhdGVbXT4oW10pO1xuICBjb25zdCBbY3VycmVudEluZGV4LCBzZXRDdXJyZW50SW5kZXhdID0gdXNlU3RhdGUoLTEpO1xuICBjb25zdCBvcGVyYXRpb25zUmVmID0gdXNlUmVmPEFkdmFuY2VkQ2FudmFzT3BlcmF0aW9ucz4oXG4gICAgY3JlYXRlQWR2YW5jZWRDYW52YXNPcGVyYXRpb25zKGNhbnZhcylcbiAgKTtcblxuICBjb25zdCBjYW5VbmRvID0gY3VycmVudEluZGV4ID4gMDtcbiAgY29uc3QgY2FuUmVkbyA9IGN1cnJlbnRJbmRleCA8IGhpc3RvcnkubGVuZ3RoIC0gMTtcblxuICBjb25zdCBzYXZlU3RhdGUgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgY29uc3Qgc3RhdGUgPSBvcGVyYXRpb25zUmVmLmN1cnJlbnQuc2F2ZVN0YXRlKCk7XG4gICAgXG4gICAgc2V0SGlzdG9yeShwcmV2ID0+IHtcbiAgICAgIGNvbnN0IG5ld0hpc3RvcnkgPSBwcmV2LnNsaWNlKDAsIGN1cnJlbnRJbmRleCArIDEpO1xuICAgICAgbmV3SGlzdG9yeS5wdXNoKHN0YXRlKTtcbiAgICAgIFxuICAgICAgLy8gTGltaXQgaGlzdG9yeSBzaXplXG4gICAgICBpZiAobmV3SGlzdG9yeS5sZW5ndGggPiBtYXhIaXN0b3J5U2l6ZSkge1xuICAgICAgICBuZXdIaXN0b3J5LnNoaWZ0KCk7XG4gICAgICAgIHJldHVybiBuZXdIaXN0b3J5O1xuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gbmV3SGlzdG9yeTtcbiAgICB9KTtcbiAgICBcbiAgICBzZXRDdXJyZW50SW5kZXgocHJldiA9PiB7XG4gICAgICBjb25zdCBuZXdJbmRleCA9IHByZXYgKyAxO1xuICAgICAgcmV0dXJuIG5ld0luZGV4ID49IG1heEhpc3RvcnlTaXplID8gbWF4SGlzdG9yeVNpemUgLSAxIDogbmV3SW5kZXg7XG4gICAgfSk7XG4gIH0sIFtjdXJyZW50SW5kZXgsIG1heEhpc3RvcnlTaXplXSk7XG5cbiAgY29uc3QgdW5kbyA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBpZiAoIWNhblVuZG8pIHJldHVybjtcbiAgICBcbiAgICBjb25zdCBuZXdJbmRleCA9IGN1cnJlbnRJbmRleCAtIDE7XG4gICAgY29uc3Qgc3RhdGUgPSBoaXN0b3J5W25ld0luZGV4XTtcbiAgICBcbiAgICBpZiAoc3RhdGUpIHtcbiAgICAgIG9wZXJhdGlvbnNSZWYuY3VycmVudC5yZXN0b3JlU3RhdGUoc3RhdGUpO1xuICAgICAgc2V0Q3VycmVudEluZGV4KG5ld0luZGV4KTtcbiAgICB9XG4gIH0sIFtjYW5VbmRvLCBjdXJyZW50SW5kZXgsIGhpc3RvcnldKTtcblxuICBjb25zdCByZWRvID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGlmICghY2FuUmVkbykgcmV0dXJuO1xuICAgIFxuICAgIGNvbnN0IG5ld0luZGV4ID0gY3VycmVudEluZGV4ICsgMTtcbiAgICBjb25zdCBzdGF0ZSA9IGhpc3RvcnlbbmV3SW5kZXhdO1xuICAgIFxuICAgIGlmIChzdGF0ZSkge1xuICAgICAgb3BlcmF0aW9uc1JlZi5jdXJyZW50LnJlc3RvcmVTdGF0ZShzdGF0ZSk7XG4gICAgICBzZXRDdXJyZW50SW5kZXgobmV3SW5kZXgpO1xuICAgIH1cbiAgfSwgW2NhblJlZG8sIGN1cnJlbnRJbmRleCwgaGlzdG9yeV0pO1xuXG4gIGNvbnN0IGNsZWFyID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIHNldEhpc3RvcnkoW10pO1xuICAgIHNldEN1cnJlbnRJbmRleCgtMSk7XG4gIH0sIFtdKTtcblxuICAvLyBTYXZlIGluaXRpYWwgc3RhdGVcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoaGlzdG9yeS5sZW5ndGggPT09IDApIHtcbiAgICAgIHNhdmVTdGF0ZSgpO1xuICAgIH1cbiAgfSwgW10pO1xuXG4gIHJldHVybiB7XG4gICAgY2FuVW5kbyxcbiAgICBjYW5SZWRvLFxuICAgIHNhdmVTdGF0ZSxcbiAgICB1bmRvLFxuICAgIHJlZG8sXG4gICAgY2xlYXIsXG4gICAgaGlzdG9yeVNpemU6IGhpc3RvcnkubGVuZ3RoXG4gIH07XG59XG5cbi8qKlxuICogSG9vayBmb3IgcGVyZm9ybWFuY2UgbW9uaXRvcmluZyBvZiBjYW52YXMgb3BlcmF0aW9uc1xuICovXG5leHBvcnQgZnVuY3Rpb24gdXNlQ2FudmFzUGVyZm9ybWFuY2UoKToge1xuICBtZWFzdXJlT3BlcmF0aW9uOiA8VD4ob3BlcmF0aW9uOiAoKSA9PiBULCBuYW1lPzogc3RyaW5nKSA9PiBUO1xuICBkZWJvdW5jZTogPFQgZXh0ZW5kcyAoLi4uYXJnczogYW55W10pID0+IGFueT4oZnVuYzogVCwgd2FpdDogbnVtYmVyKSA9PiAoLi4uYXJnczogUGFyYW1ldGVyczxUPikgPT4gdm9pZDtcbiAgdGhyb3R0bGU6IDxUIGV4dGVuZHMgKC4uLmFyZ3M6IGFueVtdKSA9PiBhbnk+KGZ1bmM6IFQsIGxpbWl0OiBudW1iZXIpID0+ICguLi5hcmdzOiBQYXJhbWV0ZXJzPFQ+KSA9PiB2b2lkO1xuICBpc0NhbnZhc1NpemVTYWZlOiAod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpID0+IGJvb2xlYW47XG59IHtcbiAgY29uc3QgbWVhc3VyZU9wZXJhdGlvbiA9IHVzZUNhbGxiYWNrKDxUPihvcGVyYXRpb246ICgpID0+IFQsIG5hbWU/OiBzdHJpbmcpID0+IHtcbiAgICByZXR1cm4gQ2FudmFzUGVyZm9ybWFuY2VVdGlscy5tZWFzdXJlT3BlcmF0aW9uKG9wZXJhdGlvbiwgbmFtZSk7XG4gIH0sIFtdKTtcblxuICBjb25zdCBkZWJvdW5jZSA9IHVzZUNhbGxiYWNrKDxUIGV4dGVuZHMgKC4uLmFyZ3M6IGFueVtdKSA9PiBhbnk+KGZ1bmM6IFQsIHdhaXQ6IG51bWJlcikgPT4ge1xuICAgIHJldHVybiBDYW52YXNQZXJmb3JtYW5jZVV0aWxzLmRlYm91bmNlKGZ1bmMsIHdhaXQpO1xuICB9LCBbXSk7XG5cbiAgY29uc3QgdGhyb3R0bGUgPSB1c2VDYWxsYmFjayg8VCBleHRlbmRzICguLi5hcmdzOiBhbnlbXSkgPT4gYW55PihmdW5jOiBULCBsaW1pdDogbnVtYmVyKSA9PiB7XG4gICAgcmV0dXJuIENhbnZhc1BlcmZvcm1hbmNlVXRpbHMudGhyb3R0bGUoZnVuYywgbGltaXQpO1xuICB9LCBbXSk7XG5cbiAgY29uc3QgaXNDYW52YXNTaXplU2FmZSA9IHVzZUNhbGxiYWNrKCh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcikgPT4ge1xuICAgIHJldHVybiBDYW52YXNQZXJmb3JtYW5jZVV0aWxzLmlzQ2FudmFzU2l6ZVNhZmUod2lkdGgsIGhlaWdodCk7XG4gIH0sIFtdKTtcblxuICByZXR1cm4ge1xuICAgIG1lYXN1cmVPcGVyYXRpb24sXG4gICAgZGVib3VuY2UsXG4gICAgdGhyb3R0bGUsXG4gICAgaXNDYW52YXNTaXplU2FmZVxuICB9O1xufVxuXG4vKipcbiAqIEhvb2sgZm9yIGltYWdlIGxvYWRpbmcgYW5kIGRyYXdpbmcgb24gY2FudmFzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1c2VDYW52YXNJbWFnZUxvYWRlcihcbiAgY2FudmFzOiBNYW5hZ2VkQ2FudmFzXG4pOiB7XG4gIGxvYWRJbWFnZTogKHVybDogc3RyaW5nKSA9PiBQcm9taXNlPEhUTUxJbWFnZUVsZW1lbnQ+O1xuICBkcmF3SW1hZ2U6IChcbiAgICBpbWFnZTogSFRNTEltYWdlRWxlbWVudCxcbiAgICB4PzogbnVtYmVyLFxuICAgIHk/OiBudW1iZXIsXG4gICAgd2lkdGg/OiBudW1iZXIsXG4gICAgaGVpZ2h0PzogbnVtYmVyLFxuICAgIGJsZW5kTW9kZT86IEJsZW5kTW9kZSxcbiAgICBvcGFjaXR5PzogbnVtYmVyXG4gICkgPT4gdm9pZDtcbiAgbG9hZEFuZERyYXdJbWFnZTogKFxuICAgIHVybDogc3RyaW5nLFxuICAgIHg/OiBudW1iZXIsXG4gICAgeT86IG51bWJlcixcbiAgICB3aWR0aD86IG51bWJlcixcbiAgICBoZWlnaHQ/OiBudW1iZXIsXG4gICAgYmxlbmRNb2RlPzogQmxlbmRNb2RlLFxuICAgIG9wYWNpdHk/OiBudW1iZXJcbiAgKSA9PiBQcm9taXNlPHZvaWQ+O1xuICBpc0xvYWRpbmc6IGJvb2xlYW47XG4gIGVycm9yOiBzdHJpbmcgfCBudWxsO1xufSB7XG4gIGNvbnN0IFtpc0xvYWRpbmcsIHNldElzTG9hZGluZ10gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtlcnJvciwgc2V0RXJyb3JdID0gdXNlU3RhdGU8c3RyaW5nIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IHsgdXRpbHMgfSA9IHVzZUNhbnZhcygpO1xuICBjb25zdCBvcGVyYXRpb25zUmVmID0gdXNlUmVmPEFkdmFuY2VkQ2FudmFzT3BlcmF0aW9ucz4oXG4gICAgY3JlYXRlQWR2YW5jZWRDYW52YXNPcGVyYXRpb25zKGNhbnZhcylcbiAgKTtcblxuICBjb25zdCBsb2FkSW1hZ2UgPSB1c2VDYWxsYmFjayhhc3luYyAodXJsOiBzdHJpbmcpOiBQcm9taXNlPEhUTUxJbWFnZUVsZW1lbnQ+ID0+IHtcbiAgICBzZXRJc0xvYWRpbmcodHJ1ZSk7XG4gICAgc2V0RXJyb3IobnVsbCk7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgaW1nID0gbmV3IEltYWdlKCk7XG4gICAgICBpbWcuY3Jvc3NPcmlnaW4gPSAnYW5vbnltb3VzJztcbiAgICAgIFxuICAgICAgYXdhaXQgbmV3IFByb21pc2U8dm9pZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBpbWcub25sb2FkID0gKCkgPT4gcmVzb2x2ZSgpO1xuICAgICAgICBpbWcub25lcnJvciA9ICgpID0+IHJlamVjdChuZXcgRXJyb3IoJ0ZhaWxlZCB0byBsb2FkIGltYWdlJykpO1xuICAgICAgICBpbWcuc3JjID0gdXJsO1xuICAgICAgfSk7XG5cbiAgICAgIHNldElzTG9hZGluZyhmYWxzZSk7XG4gICAgICByZXR1cm4gaW1nO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyIGluc3RhbmNlb2YgRXJyb3IgPyBlcnIubWVzc2FnZSA6ICdVbmtub3duIGVycm9yIGxvYWRpbmcgaW1hZ2UnO1xuICAgICAgc2V0RXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgICAgIHNldElzTG9hZGluZyhmYWxzZSk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgICB9XG4gIH0sIFtdKTtcblxuICBjb25zdCBkcmF3SW1hZ2UgPSB1c2VDYWxsYmFjaygoXG4gICAgaW1hZ2U6IEhUTUxJbWFnZUVsZW1lbnQsXG4gICAgeDogbnVtYmVyID0gMCxcbiAgICB5OiBudW1iZXIgPSAwLFxuICAgIHdpZHRoPzogbnVtYmVyLFxuICAgIGhlaWdodD86IG51bWJlcixcbiAgICBibGVuZE1vZGU6IEJsZW5kTW9kZSA9IEJsZW5kTW9kZS5Ob3JtYWwsXG4gICAgb3BhY2l0eTogbnVtYmVyID0gMVxuICApID0+IHtcbiAgICBvcGVyYXRpb25zUmVmLmN1cnJlbnQuZHJhd0ltYWdlV2l0aEJsZW5kTW9kZShcbiAgICAgIGltYWdlLCB4LCB5LCB3aWR0aCwgaGVpZ2h0LCBibGVuZE1vZGUsIG9wYWNpdHlcbiAgICApO1xuICB9LCBbXSk7XG5cbiAgY29uc3QgbG9hZEFuZERyYXdJbWFnZSA9IHVzZUNhbGxiYWNrKGFzeW5jIChcbiAgICB1cmw6IHN0cmluZyxcbiAgICB4OiBudW1iZXIgPSAwLFxuICAgIHk6IG51bWJlciA9IDAsXG4gICAgd2lkdGg/OiBudW1iZXIsXG4gICAgaGVpZ2h0PzogbnVtYmVyLFxuICAgIGJsZW5kTW9kZTogQmxlbmRNb2RlID0gQmxlbmRNb2RlLk5vcm1hbCxcbiAgICBvcGFjaXR5OiBudW1iZXIgPSAxXG4gICkgPT4ge1xuICAgIGNvbnN0IGltYWdlID0gYXdhaXQgbG9hZEltYWdlKHVybCk7XG4gICAgZHJhd0ltYWdlKGltYWdlLCB4LCB5LCB3aWR0aCwgaGVpZ2h0LCBibGVuZE1vZGUsIG9wYWNpdHkpO1xuICB9LCBbbG9hZEltYWdlLCBkcmF3SW1hZ2VdKTtcblxuICByZXR1cm4ge1xuICAgIGxvYWRJbWFnZSxcbiAgICBkcmF3SW1hZ2UsXG4gICAgbG9hZEFuZERyYXdJbWFnZSxcbiAgICBpc0xvYWRpbmcsXG4gICAgZXJyb3JcbiAgfTtcbn1cblxuLyoqXG4gKiBIb29rIGZvciBjYW52YXMgcmVzaXplIGhhbmRsaW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1c2VDYW52YXNSZXNpemUoXG4gIGNhbnZhczogTWFuYWdlZENhbnZhcyxcbiAgbWFpbnRhaW5Db250ZW50OiBib29sZWFuID0gdHJ1ZVxuKToge1xuICByZXNpemU6IChuZXdXaWR0aDogbnVtYmVyLCBuZXdIZWlnaHQ6IG51bWJlcikgPT4gdm9pZDtcbiAgYXV0b1Jlc2l6ZTogKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpID0+IHZvaWQ7XG4gIGRpbWVuc2lvbnM6IHsgd2lkdGg6IG51bWJlcjsgaGVpZ2h0OiBudW1iZXIgfTtcbn0ge1xuICBjb25zdCBbZGltZW5zaW9ucywgc2V0RGltZW5zaW9uc10gPSB1c2VTdGF0ZShjYW52YXMuZGltZW5zaW9ucyk7XG4gIGNvbnN0IHsgdXRpbHMgfSA9IHVzZUNhbnZhcygpO1xuXG4gIGNvbnN0IHJlc2l6ZSA9IHVzZUNhbGxiYWNrKChuZXdXaWR0aDogbnVtYmVyLCBuZXdIZWlnaHQ6IG51bWJlcikgPT4ge1xuICAgIGlmIChtYWludGFpbkNvbnRlbnQpIHtcbiAgICAgIHV0aWxzLnJlc2l6ZUNhbnZhcyhjYW52YXMuY2FudmFzLCBuZXdXaWR0aCwgbmV3SGVpZ2h0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY2FudmFzLmNhbnZhcy53aWR0aCA9IG5ld1dpZHRoO1xuICAgICAgY2FudmFzLmNhbnZhcy5oZWlnaHQgPSBuZXdIZWlnaHQ7XG4gICAgICBjYW52YXMuY2FudmFzLnN0eWxlLndpZHRoID0gYCR7bmV3V2lkdGh9cHhgO1xuICAgICAgY2FudmFzLmNhbnZhcy5zdHlsZS5oZWlnaHQgPSBgJHtuZXdIZWlnaHR9cHhgO1xuICAgIH1cbiAgICBcbiAgICBjYW52YXMuZGltZW5zaW9ucyA9IHsgd2lkdGg6IG5ld1dpZHRoLCBoZWlnaHQ6IG5ld0hlaWdodCB9O1xuICAgIHNldERpbWVuc2lvbnMoeyB3aWR0aDogbmV3V2lkdGgsIGhlaWdodDogbmV3SGVpZ2h0IH0pO1xuICB9LCBbY2FudmFzLCBtYWludGFpbkNvbnRlbnQsIHV0aWxzXSk7XG5cbiAgY29uc3QgYXV0b1Jlc2l6ZSA9IHVzZUNhbGxiYWNrKChjb250YWluZXI6IEhUTUxFbGVtZW50KSA9PiB7XG4gICAgY29uc3QgcmVzaXplT2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIoZW50cmllcyA9PiB7XG4gICAgICBjb25zdCBlbnRyeSA9IGVudHJpZXNbMF07XG4gICAgICBpZiAoZW50cnkpIHtcbiAgICAgICAgY29uc3QgeyB3aWR0aCwgaGVpZ2h0IH0gPSBlbnRyeS5jb250ZW50UmVjdDtcbiAgICAgICAgcmVzaXplKHdpZHRoLCBoZWlnaHQpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmVzaXplT2JzZXJ2ZXIub2JzZXJ2ZShjb250YWluZXIpO1xuICAgIFxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICByZXNpemVPYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgfTtcbiAgfSwgW3Jlc2l6ZV0pO1xuXG4gIHJldHVybiB7XG4gICAgcmVzaXplLFxuICAgIGF1dG9SZXNpemUsXG4gICAgZGltZW5zaW9uc1xuICB9O1xufSJdLCJuYW1lcyI6WyJ1c2VBZHZhbmNlZENhbnZhc09wZXJhdGlvbnMiLCJ1c2VDYW52YXNBbmltYXRpb24iLCJ1c2VDYW52YXNIaXN0b3J5IiwidXNlQ2FudmFzSW1hZ2VMb2FkZXIiLCJ1c2VDYW52YXNQZXJmb3JtYW5jZSIsInVzZUNhbnZhc1Jlc2l6ZSIsIndpZHRoIiwiaGVpZ2h0IiwiY2FudmFzSWQiLCJjYW52YXMiLCJ1c2VNYW5hZ2VkQ2FudmFzIiwib3BlcmF0aW9uc1JlZiIsInVzZVJlZiIsImN1cnJlbnQiLCJjcmVhdGVBZHZhbmNlZENhbnZhc09wZXJhdGlvbnMiLCJzYXZlU3RhdGUiLCJ1c2VDYWxsYmFjayIsInJlc3RvcmVTdGF0ZSIsInN0YXRlIiwiY2xlYXIiLCJjb250ZXh0IiwiY2xlYXJSZWN0Iiwib3BlcmF0aW9ucyIsImlzUnVubmluZyIsInNldElzUnVubmluZyIsInVzZVN0YXRlIiwiYW5pbWF0aW9uVXRpbHNSZWYiLCJjcmVhdGVDYW52YXNBbmltYXRpb25VdGlscyIsInN0YXJ0QW5pbWF0aW9uIiwiY2FsbGJhY2siLCJzdG9wQW5pbWF0aW9uIiwiYW5pbWF0ZVByb3BlcnR5IiwiZnJvbSIsInRvIiwiZHVyYXRpb24iLCJlYXNpbmciLCJvblVwZGF0ZSIsIm9uQ29tcGxldGUiLCJDYW52YXNBbmltYXRpb25VdGlscyIsInVzZUVmZmVjdCIsIm1heEhpc3RvcnlTaXplIiwiaGlzdG9yeSIsInNldEhpc3RvcnkiLCJjdXJyZW50SW5kZXgiLCJzZXRDdXJyZW50SW5kZXgiLCJjYW5VbmRvIiwiY2FuUmVkbyIsImxlbmd0aCIsInByZXYiLCJuZXdIaXN0b3J5Iiwic2xpY2UiLCJwdXNoIiwic2hpZnQiLCJuZXdJbmRleCIsInVuZG8iLCJyZWRvIiwiaGlzdG9yeVNpemUiLCJtZWFzdXJlT3BlcmF0aW9uIiwib3BlcmF0aW9uIiwibmFtZSIsIkNhbnZhc1BlcmZvcm1hbmNlVXRpbHMiLCJkZWJvdW5jZSIsImZ1bmMiLCJ3YWl0IiwidGhyb3R0bGUiLCJsaW1pdCIsImlzQ2FudmFzU2l6ZVNhZmUiLCJpc0xvYWRpbmciLCJzZXRJc0xvYWRpbmciLCJlcnJvciIsInNldEVycm9yIiwidXRpbHMiLCJ1c2VDYW52YXMiLCJsb2FkSW1hZ2UiLCJ1cmwiLCJpbWciLCJJbWFnZSIsImNyb3NzT3JpZ2luIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJvbmxvYWQiLCJvbmVycm9yIiwiRXJyb3IiLCJzcmMiLCJlcnIiLCJlcnJvck1lc3NhZ2UiLCJtZXNzYWdlIiwiZHJhd0ltYWdlIiwiaW1hZ2UiLCJ4IiwieSIsImJsZW5kTW9kZSIsIkJsZW5kTW9kZSIsIk5vcm1hbCIsIm9wYWNpdHkiLCJkcmF3SW1hZ2VXaXRoQmxlbmRNb2RlIiwibG9hZEFuZERyYXdJbWFnZSIsIm1haW50YWluQ29udGVudCIsImRpbWVuc2lvbnMiLCJzZXREaW1lbnNpb25zIiwicmVzaXplIiwibmV3V2lkdGgiLCJuZXdIZWlnaHQiLCJyZXNpemVDYW52YXMiLCJzdHlsZSIsImF1dG9SZXNpemUiLCJjb250YWluZXIiLCJyZXNpemVPYnNlcnZlciIsIlJlc2l6ZU9ic2VydmVyIiwiZW50cmllcyIsImVudHJ5IiwiY29udGVudFJlY3QiLCJvYnNlcnZlIiwiZGlzY29ubmVjdCJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7OztJQXdCZ0JBLDJCQUEyQjtlQUEzQkE7O0lBMENBQyxrQkFBa0I7ZUFBbEJBOztJQWdFQUMsZ0JBQWdCO2VBQWhCQTs7SUE4SEFDLG9CQUFvQjtlQUFwQkE7O0lBakNBQyxvQkFBb0I7ZUFBcEJBOztJQWdJQUMsZUFBZTtlQUFmQTs7O3VCQTFWeUM7Z0NBS2xEOzZCQVNBO0FBS0EsU0FBU0wsNEJBQ2RNLEtBQWEsRUFDYkMsTUFBYyxFQUNkQyxRQUFpQjtJQVFqQixNQUFNQyxTQUFTQyxJQUFBQSxnQ0FBZ0IsRUFBQ0osT0FBT0MsUUFBUUM7SUFDL0MsTUFBTUcsZ0JBQWdCQyxJQUFBQSxhQUFNO0lBRTVCLElBQUksQ0FBQ0QsY0FBY0UsT0FBTyxFQUFFO1FBQzFCRixjQUFjRSxPQUFPLEdBQUdDLElBQUFBLDJDQUE4QixFQUFDTDtJQUN6RDtJQUVBLE1BQU1NLFlBQVlDLElBQUFBLGtCQUFXLEVBQUM7UUFDNUIsT0FBT0wsY0FBY0UsT0FBTyxDQUFFRSxTQUFTO0lBQ3pDLEdBQUcsRUFBRTtJQUVMLE1BQU1FLGVBQWVELElBQUFBLGtCQUFXLEVBQUMsQ0FBQ0U7UUFDaENQLGNBQWNFLE9BQU8sQ0FBRUksWUFBWSxDQUFDQztJQUN0QyxHQUFH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