{"version":3,"sources":["/Users/willstreeter/WebstormProjects/vibe-coding/those-people/The-Sus-Fit-gp/__tests__/business-layer/mutations/useTryonMutation.test.tsx"],"sourcesContent":["/**\n * @jest-environment jsdom\n */\nimport React from 'react';\nimport { render, screen, waitFor, act } from '@testing-library/react';\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\nimport { useTryonMutation } from '../../../src/business-layer/mutations/useTryonMutation';\nimport type { \n  TryonMutationVariables,\n  TryonMutationVariablesWithFiles, \n  TryonMutationResponse,\n  TryonMutationError,\n  UseTryonMutationConfig \n} from '../../../src/business-layer/types/tryon.types';\n\n// Mock fetch globally\nconst mockFetch = jest.fn();\nglobal.fetch = mockFetch;\n\n// Mock abort controller for timeout tests\nclass MockAbortController {\n  signal = { aborted: false };\n  abort = jest.fn(() => {\n    this.signal.aborted = true;\n  });\n}\nglobal.AbortController = MockAbortController as any;\n\ndescribe('useTryonMutation', () => {\n  let queryClient: QueryClient;\n\n  beforeEach(() => {\n    queryClient = new QueryClient({\n      defaultOptions: {\n        queries: { retry: false, gcTime: 0 },\n        mutations: { retry: false },\n      },\n    });\n    mockFetch.mockClear();\n    jest.clearAllTimers();\n    jest.useFakeTimers();\n  });\n\n  afterEach(() => {\n    jest.useRealTimers();\n    queryClient.clear();\n  });\n\n  const renderWithProvider = (children: React.ReactNode) => {\n    return render(\n      <QueryClientProvider client={queryClient}>\n        {children}\n      </QueryClientProvider>\n    );\n  };\n\n  const mockVariables: TryonMutationVariables = {\n    modelImage: 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD',\n    apparelImages: ['data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD']\n  };\n\n  const mockSuccessResponse: TryonMutationResponse = {\n    img_generated: 'data:image/jpeg;base64,generatedImageBase64Data',\n    metadata: {\n      processingTime: 5000,\n      modelVersion: 'v1.0',\n      timestamp: '2023-01-01T00:00:00Z'\n    }\n  };\n\n  describe('Basic Hook Functionality', () => {\n    it('should initialize with correct default state', () => {\n      const TestComponent = () => {\n        const mutation = useTryonMutation();\n        \n        return (\n          <div>\n            <div data-testid=\"status\">{mutation.status}</div>\n            <div data-testid=\"isLoading\">{mutation.isLoading.toString()}</div>\n            <div data-testid=\"isSuccess\">{mutation.isSuccess.toString()}</div>\n            <div data-testid=\"isError\">{mutation.isError.toString()}</div>\n            <div data-testid=\"isIdle\">{mutation.isIdle.toString()}</div>\n            <div data-testid=\"hasData\">{Boolean(mutation.data).toString()}</div>\n            <div data-testid=\"hasError\">{Boolean(mutation.error).toString()}</div>\n          </div>\n        );\n      };\n\n      renderWithProvider(<TestComponent />);\n\n      expect(screen.getByTestId('status')).toHaveTextContent('idle');\n      expect(screen.getByTestId('isLoading')).toHaveTextContent('false');\n      expect(screen.getByTestId('isSuccess')).toHaveTextContent('false');\n      expect(screen.getByTestId('isError')).toHaveTextContent('false');\n      expect(screen.getByTestId('isIdle')).toHaveTextContent('true');\n      expect(screen.getByTestId('hasData')).toHaveTextContent('false');\n      expect(screen.getByTestId('hasError')).toHaveTextContent('false');\n    });\n\n    it('should provide mutate and mutateAsync functions', () => {\n      const TestComponent = () => {\n        const mutation = useTryonMutation();\n        \n        return (\n          <div>\n            <div data-testid=\"hasMutate\">{typeof mutation.mutate === 'function' ? 'function' : 'not-function'}</div>\n            <div data-testid=\"hasMutateAsync\">{typeof mutation.mutateAsync === 'function' ? 'function' : 'not-function'}</div>\n            <div data-testid=\"hasReset\">{typeof mutation.reset === 'function' ? 'function' : 'not-function'}</div>\n          </div>\n        );\n      };\n\n      renderWithProvider(<TestComponent />);\n\n      expect(screen.getByTestId('hasMutate')).toHaveTextContent('function');\n      expect(screen.getByTestId('hasMutateAsync')).toHaveTextContent('function');\n      expect(screen.getByTestId('hasReset')).toHaveTextContent('function');\n    });\n  });\n\n  describe('Successful API Calls', () => {\n    it('should handle successful API response', async () => {\n      mockFetch.mockResolvedValueOnce({\n        ok: true,\n        json: async () => mockSuccessResponse,\n      });\n\n      const TestComponent = () => {\n        const mutation = useTryonMutation();\n        \n        React.useEffect(() => {\n          mutation.mutate(mockVariables);\n        }, []);\n\n        return (\n          <div>\n            <div data-testid=\"status\">{mutation.status}</div>\n            <div data-testid=\"data\">{mutation.data ? JSON.stringify(mutation.data) : 'null'}</div>\n          </div>\n        );\n      };\n\n      renderWithProvider(<TestComponent />);\n\n      await waitFor(() => {\n        expect(screen.getByTestId('status')).toHaveTextContent('success');\n      });\n\n      const dataContent = screen.getByTestId('data').textContent;\n      const parsedData = JSON.parse(dataContent!);\n      expect(parsedData.img_generated).toBe(mockSuccessResponse.img_generated);\n      expect(parsedData.metadata).toEqual(mockSuccessResponse.metadata);\n    });\n\n    it('should make correct API request with proper payload', async () => {\n      mockFetch.mockResolvedValueOnce({\n        ok: true,\n        json: async () => mockSuccessResponse,\n      });\n\n      const TestComponent = () => {\n        const mutation = useTryonMutation();\n        \n        React.useEffect(() => {\n          mutation.mutate(mockVariables);\n        }, []);\n\n        return <div data-testid=\"test\">test</div>;\n      };\n\n      renderWithProvider(<TestComponent />);\n\n      await waitFor(() => {\n        expect(mockFetch).toHaveBeenCalledTimes(1);\n      });\n\n      expect(mockFetch).toHaveBeenCalledWith('/api/tryon', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          modelImage: mockVariables.modelImage,\n          apparelImages: mockVariables.apparelImages,\n        }),\n      });\n    });\n\n    it('should include metadata in request when provided', async () => {\n      mockFetch.mockResolvedValueOnce({\n        ok: true,\n        json: async () => mockSuccessResponse,\n      });\n\n      const variablesWithMetadata: TryonMutationVariables = {\n        ...mockVariables,\n        options: {\n          metadata: { custom: 'data', userId: '123' }\n        }\n      };\n\n      const TestComponent = () => {\n        const mutation = useTryonMutation();\n        \n        React.useEffect(() => {\n          mutation.mutate(variablesWithMetadata);\n        }, []);\n\n        return <div data-testid=\"test\">test</div>;\n      };\n\n      renderWithProvider(<TestComponent />);\n\n      await waitFor(() => {\n        expect(mockFetch).toHaveBeenCalledTimes(1);\n      });\n\n      const [, requestInit] = mockFetch.mock.calls[0];\n      const requestBody = JSON.parse(requestInit.body);\n      expect(requestBody.metadata).toEqual({ custom: 'data', userId: '123' });\n    });\n  });\n\n  describe('Error Handling', () => {\n    it('should handle HTTP error responses', async () => {\n      const errorResponse = {\n        error: 'Validation failed',\n        details: [{ field: 'modelImage', message: 'Invalid format' }],\n        code: 'VALIDATION_ERROR'\n      };\n\n      mockFetch.mockResolvedValueOnce({\n        ok: false,\n        status: 400,\n        statusText: 'Bad Request',\n        json: async () => errorResponse,\n      });\n\n      const TestComponent = () => {\n        const mutation = useTryonMutation();\n        \n        React.useEffect(() => {\n          mutation.mutate(mockVariables);\n        }, []);\n\n        return (\n          <div>\n            <div data-testid=\"status\">{mutation.status}</div>\n            <div data-testid=\"error\">{mutation.error ? JSON.stringify(mutation.error) : 'null'}</div>\n          </div>\n        );\n      };\n\n      renderWithProvider(<TestComponent />);\n\n      await waitFor(() => {\n        expect(screen.getByTestId('status')).toHaveTextContent('error');\n      }, { timeout: 3000 });\n\n      const errorContent = screen.getByTestId('error').textContent;\n      const parsedError = JSON.parse(errorContent!);\n      expect(parsedError.error).toBe('Validation failed');\n      expect(parsedError.details).toEqual(errorResponse.details);\n      expect(parsedError.status).toBe(400);\n      expect(parsedError.retryable).toBe(false);\n    });\n\n    it('should handle network errors', async () => {\n      mockFetch.mockRejectedValueOnce(new Error('Network error'));\n\n      const TestComponent = () => {\n        const mutation = useTryonMutation({ enableRetry: false });\n        \n        React.useEffect(() => {\n          mutation.mutate(mockVariables);\n        }, []);\n\n        return (\n          <div>\n            <div data-testid=\"status\">{mutation.status}</div>\n            <div data-testid=\"hasError\">{mutation.isError.toString()}</div>\n            <div data-testid=\"errorType\">{mutation.error ? typeof mutation.error : 'null'}</div>\n            <div data-testid=\"errorMessage\">{mutation.error instanceof Error ? mutation.error.message : 'not-error'}</div>\n          </div>\n        );\n      };\n\n      renderWithProvider(<TestComponent />);\n\n      await waitFor(() => {\n        expect(screen.getByTestId('status')).toHaveTextContent('error');\n      }, { timeout: 3000 });\n\n      expect(screen.getByTestId('hasError')).toHaveTextContent('true');\n      expect(screen.getByTestId('errorMessage')).toHaveTextContent('Network error');\n    });\n\n    it('should handle invalid API response format', async () => {\n      mockFetch.mockResolvedValueOnce({\n        ok: true,\n        json: async () => ({ invalid: 'response' }), // Missing img_generated\n      });\n\n      const TestComponent = () => {\n        const mutation = useTryonMutation({ enableRetry: false });\n        \n        React.useEffect(() => {\n          mutation.mutate(mockVariables);\n        }, []);\n\n        return (\n          <div>\n            <div data-testid=\"status\">{mutation.status}</div>\n            <div data-testid=\"hasError\">{mutation.isError.toString()}</div>\n            <div data-testid=\"errorMessage\">{mutation.error instanceof Error ? mutation.error.message : 'not-error'}</div>\n          </div>\n        );\n      };\n\n      renderWithProvider(<TestComponent />);\n\n      await waitFor(() => {\n        expect(screen.getByTestId('status')).toHaveTextContent('error');\n      }, { timeout: 3000 });\n\n      expect(screen.getByTestId('hasError')).toHaveTextContent('true');\n      expect(screen.getByTestId('errorMessage')).toHaveTextContent('Invalid API response: missing img_generated field');\n    });\n  });\n\n  describe('Retry Logic', () => {\n    it('should retry on retryable errors with exponential backoff', async () => {\n      // First call fails with 500 error (retryable)\n      mockFetch\n        .mockResolvedValueOnce({\n          ok: false,\n          status: 500,\n          statusText: 'Internal Server Error',\n          json: async () => ({ error: 'Server error' }),\n        })\n        .mockResolvedValueOnce({\n          ok: false,\n          status: 500,\n          statusText: 'Internal Server Error',\n          json: async () => ({ error: 'Server error' }),\n        })\n        .mockResolvedValueOnce({\n          ok: true,\n          json: async () => mockSuccessResponse,\n        });\n\n      const TestComponent = () => {\n        const mutation = useTryonMutation({\n          enableRetry: true,\n          maxRetries: 3,\n          initialRetryDelay: 100\n        });\n        \n        React.useEffect(() => {\n          mutation.mutate(mockVariables);\n        }, []);\n\n        return (\n          <div>\n            <div data-testid=\"status\">{mutation.status}</div>\n          </div>\n        );\n      };\n\n      renderWithProvider(<TestComponent />);\n\n      // Fast-forward through retry delays\n      await act(async () => {\n        await jest.advanceTimersByTimeAsync(1000);\n      });\n\n      await waitFor(() => {\n        expect(screen.getByTestId('status')).toHaveTextContent('success');\n      });\n\n      expect(mockFetch).toHaveBeenCalledTimes(3);\n    });\n\n    it('should not retry on non-retryable errors', async () => {\n      mockFetch.mockResolvedValueOnce({\n        ok: false,\n        status: 400,\n        statusText: 'Bad Request',\n        json: async () => ({ error: 'Validation error' }),\n      });\n\n      const TestComponent = () => {\n        const mutation = useTryonMutation({\n          enableRetry: true,\n          maxRetries: 3\n        });\n        \n        React.useEffect(() => {\n          mutation.mutate(mockVariables);\n        }, []);\n\n        return (\n          <div>\n            <div data-testid=\"status\">{mutation.status}</div>\n          </div>\n        );\n      };\n\n      renderWithProvider(<TestComponent />);\n\n      await waitFor(() => {\n        expect(screen.getByTestId('status')).toHaveTextContent('error');\n      });\n\n      expect(mockFetch).toHaveBeenCalledTimes(1);\n    });\n\n    it('should respect maxRetries configuration', async () => {\n      mockFetch.mockResolvedValue({\n        ok: false,\n        status: 500,\n        statusText: 'Internal Server Error',\n        json: async () => ({ error: 'Server error' }),\n      });\n\n      const TestComponent = () => {\n        const mutation = useTryonMutation({\n          enableRetry: true,\n          maxRetries: 2,\n          initialRetryDelay: 50\n        });\n        \n        React.useEffect(() => {\n          mutation.mutate(mockVariables);\n        }, []);\n\n        return (\n          <div>\n            <div data-testid=\"status\">{mutation.status}</div>\n          </div>\n        );\n      };\n\n      renderWithProvider(<TestComponent />);\n\n      await act(async () => {\n        await jest.advanceTimersByTimeAsync(1000);\n      });\n\n      await waitFor(() => {\n        expect(screen.getByTestId('status')).toHaveTextContent('error');\n      });\n\n      expect(mockFetch).toHaveBeenCalledTimes(3); // 1 initial + 2 retries\n    });\n  });\n\n  describe('Timeout Handling', () => {\n    it('should handle request timeout', async () => {\n      const timeoutPromise = new Promise((_, reject) => {\n        setTimeout(() => reject(new Error('Request timeout')), 1000);\n      });\n\n      mockFetch.mockImplementationOnce(() => timeoutPromise);\n\n      const TestComponent = () => {\n        const mutation = useTryonMutation({ enableRetry: false });\n        \n        React.useEffect(() => {\n          mutation.mutate({\n            ...mockVariables,\n            options: { timeout: 500 }\n          });\n        }, []);\n\n        return (\n          <div>\n            <div data-testid=\"status\">{mutation.status}</div>\n          </div>\n        );\n      };\n\n      renderWithProvider(<TestComponent />);\n\n      await act(async () => {\n        await jest.advanceTimersByTimeAsync(600);\n      });\n\n      await waitFor(() => {\n        expect(screen.getByTestId('status')).toHaveTextContent('error');\n      }, { timeout: 3000 });\n    });\n  });\n\n  describe('Lifecycle Callbacks', () => {\n    it('should call onSuccess callback', async () => {\n      mockFetch.mockResolvedValueOnce({\n        ok: true,\n        json: async () => mockSuccessResponse,\n      });\n\n      const onSuccess = jest.fn();\n\n      const TestComponent = () => {\n        const mutation = useTryonMutation({ onSuccess });\n        \n        React.useEffect(() => {\n          mutation.mutate(mockVariables);\n        }, []);\n\n        return <div data-testid=\"status\">{mutation.status}</div>;\n      };\n\n      renderWithProvider(<TestComponent />);\n\n      await waitFor(() => {\n        expect(screen.getByTestId('status')).toHaveTextContent('success');\n      });\n\n      expect(onSuccess).toHaveBeenCalledWith(\n        mockSuccessResponse,\n        mockVariables,\n        expect.objectContaining({\n          variables: mockVariables,\n          startTime: expect.any(Number),\n          retryCount: 0\n        })\n      );\n    });\n\n    it('should call onError callback', async () => {\n      mockFetch.mockRejectedValueOnce(new Error('Network error'));\n\n      const onError = jest.fn();\n\n      const TestComponent = () => {\n        const mutation = useTryonMutation({ onError, enableRetry: false });\n        \n        React.useEffect(() => {\n          mutation.mutate(mockVariables);\n        }, []);\n\n        return <div data-testid=\"status\">{mutation.status}</div>;\n      };\n\n      renderWithProvider(<TestComponent />);\n\n      await waitFor(() => {\n        expect(screen.getByTestId('status')).toHaveTextContent('error');\n      }, { timeout: 3000 });\n\n      expect(onError).toHaveBeenCalledWith(\n        expect.objectContaining({\n          error: expect.stringContaining('Network connection'),\n          retryable: true,\n          category: 'network',\n          code: 'NETWORK_ERROR',\n          severity: 'medium',\n          recoveryActions: expect.arrayContaining([\n            expect.objectContaining({\n              type: 'check_connection'\n            })\n          ])\n        }),\n        mockVariables,\n        expect.objectContaining({\n          variables: mockVariables\n        })\n      );\n    });\n\n    it('should call onMutate callback and use returned context', async () => {\n      mockFetch.mockResolvedValueOnce({\n        ok: true,\n        json: async () => mockSuccessResponse,\n      });\n\n      const onMutate = jest.fn().mockReturnValue({ customData: 'test' });\n\n      const TestComponent = () => {\n        const mutation = useTryonMutation({ onMutate });\n        \n        React.useEffect(() => {\n          mutation.mutate(mockVariables);\n        }, []);\n\n        return <div data-testid=\"status\">{mutation.status}</div>;\n      };\n\n      renderWithProvider(<TestComponent />);\n\n      await waitFor(() => {\n        expect(screen.getByTestId('status')).toHaveTextContent('success');\n      });\n\n      expect(onMutate).toHaveBeenCalledWith(mockVariables);\n    });\n\n    it('should call onSettled callback on both success and error', async () => {\n      const onSettled = jest.fn();\n\n      // Test success case\n      mockFetch.mockResolvedValueOnce({\n        ok: true,\n        json: async () => mockSuccessResponse,\n      });\n\n      const TestComponent = () => {\n        const mutation = useTryonMutation({ onSettled });\n        \n        React.useEffect(() => {\n          mutation.mutate(mockVariables);\n        }, []);\n\n        return <div data-testid=\"status\">{mutation.status}</div>;\n      };\n\n      const { unmount } = renderWithProvider(<TestComponent />);\n\n      await waitFor(() => {\n        expect(screen.getByTestId('status')).toHaveTextContent('success');\n      });\n\n      expect(onSettled).toHaveBeenCalledWith(\n        mockSuccessResponse,\n        null,\n        mockVariables,\n        expect.objectContaining({\n          variables: mockVariables\n        })\n      );\n\n      unmount();\n      onSettled.mockClear();\n\n      // Test error case\n      mockFetch.mockRejectedValueOnce(new Error('Test error'));\n\n      const TestComponentError = () => {\n        const mutation = useTryonMutation({ onSettled, enableRetry: false });\n        \n        React.useEffect(() => {\n          mutation.mutate(mockVariables);\n        }, []);\n\n        return <div data-testid=\"status\">{mutation.status}</div>;\n      };\n\n      renderWithProvider(<TestComponentError />);\n\n      await waitFor(() => {\n        expect(screen.getByTestId('status')).toHaveTextContent('error');\n      }, { timeout: 5000 });\n\n      expect(onSettled).toHaveBeenCalledWith(\n        undefined,\n        expect.objectContaining({\n          error: expect.stringContaining('unexpected error'),\n          category: 'unknown',\n          code: 'UNKNOWN_ERROR',\n          severity: 'high',\n          retryable: true\n        }),\n        mockVariables,\n        expect.objectContaining({\n          variables: mockVariables\n        })\n      );\n    });\n  });\n\n  describe('Reset Functionality', () => {\n    it('should reset mutation state', async () => {\n      mockFetch.mockResolvedValueOnce({\n        ok: true,\n        json: async () => mockSuccessResponse,\n      });\n\n      const TestComponent = () => {\n        const mutation = useTryonMutation();\n        \n        React.useEffect(() => {\n          mutation.mutate(mockVariables);\n        }, []);\n\n        const handleReset = () => {\n          mutation.reset();\n        };\n\n        return (\n          <div>\n            <div data-testid=\"status\">{mutation.status}</div>\n            <button onClick={handleReset} data-testid=\"reset-button\">Reset</button>\n          </div>\n        );\n      };\n\n      renderWithProvider(<TestComponent />);\n\n      await waitFor(() => {\n        expect(screen.getByTestId('status')).toHaveTextContent('success');\n      }, { timeout: 5000 });\n\n      act(() => {\n        screen.getByTestId('reset-button').click();\n      });\n\n      await waitFor(() => {\n        expect(screen.getByTestId('status')).toHaveTextContent('idle');\n      });\n    });\n  });\n\n  describe('Configuration Options', () => {\n    it('should disable retry when enableRetry is false', async () => {\n      mockFetch.mockResolvedValue({\n        ok: false,\n        status: 500,\n        statusText: 'Internal Server Error',\n        json: async () => ({ error: 'Server error' }),\n      });\n\n      const TestComponent = () => {\n        const mutation = useTryonMutation({\n          enableRetry: false\n        });\n        \n        React.useEffect(() => {\n          mutation.mutate(mockVariables);\n        }, []);\n\n        return <div data-testid=\"status\">{mutation.status}</div>;\n      };\n\n      renderWithProvider(<TestComponent />);\n\n      await waitFor(() => {\n        expect(screen.getByTestId('status')).toHaveTextContent('error');\n      });\n\n      expect(mockFetch).toHaveBeenCalledTimes(1);\n    });\n  });\n\n  describe('Image Processing Integration', () => {\n    // Mock File constructor\n    const createMockFile = (name: string, type: string, content: string = 'test-image-data'): File => {\n      const blob = new Blob([content], { type });\n      return new File([blob], name, { type });\n    };\n\n    // Mock Canvas and Image for image processing\n    const mockCanvas = {\n      width: 0,\n      height: 0,\n      getContext: jest.fn(() => ({\n        drawImage: jest.fn(),\n        imageSmoothingEnabled: true,\n        imageSmoothingQuality: 'high'\n      })),\n      toDataURL: jest.fn(() => 'data:image/jpeg;base64,processed-image-data'),\n      toBlob: jest.fn((callback) => {\n        const blob = new Blob(['processed'], { type: 'image/jpeg' });\n        callback(blob);\n      })\n    };\n\n    beforeEach(() => {\n      global.HTMLCanvasElement.prototype.getContext = mockCanvas.getContext as any;\n      global.HTMLCanvasElement.prototype.toDataURL = mockCanvas.toDataURL as any;\n      global.HTMLCanvasElement.prototype.toBlob = mockCanvas.toBlob as any;\n      \n      // Mock Image constructor\n      global.Image = class MockImage {\n        onload: (() => void) | null = null;\n        onerror: (() => void) | null = null;\n        width = 1024;\n        height = 1536;\n        crossOrigin = '';\n        \n        set src(value: string) {\n          setTimeout(() => {\n            if (this.onload) this.onload();\n          }, 0);\n        }\n      } as any;\n    });\n\n    it('should process File objects through image processing pipeline', async () => {\n      mockFetch.mockResolvedValueOnce({\n        ok: true,\n        json: async () => mockSuccessResponse,\n      });\n\n      const mockFile = createMockFile('test-image.jpg', 'image/jpeg');\n      const mockApparelFile = createMockFile('apparel.png', 'image/png');\n\n      const variablesWithFiles: TryonMutationVariablesWithFiles = {\n        modelImage: mockFile,\n        apparelImages: [mockApparelFile]\n      };\n\n      const TestComponent = () => {\n        const mutation = useTryonMutation({\n          enableRetry: false,\n          imageProcessing: {\n            targetWidth: 1024,\n            targetHeight: 1536,\n            maxSizeKB: 1024\n          }\n        });\n        \n        React.useEffect(() => {\n          mutation.mutate(variablesWithFiles as any);\n        }, []);\n\n        return (\n          <div>\n            <div data-testid=\"status\">{mutation.status}</div>\n            <div data-testid=\"context\">{mutation.context ? 'has-context' : 'no-context'}</div>\n          </div>\n        );\n      };\n\n      renderWithProvider(<TestComponent />);\n\n      await waitFor(() => {\n        expect(screen.getByTestId('status')).toHaveTextContent('success');\n      }, { timeout: 5000 });\n\n      expect(screen.getByTestId('context')).toHaveTextContent('has-context');\n      expect(mockFetch).toHaveBeenCalledWith('/api/tryon', expect.objectContaining({\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: expect.stringContaining('processed-image-data')\n      }));\n    });\n\n    it('should handle mixed File and base64 inputs', async () => {\n      mockFetch.mockResolvedValueOnce({\n        ok: true,\n        json: async () => mockSuccessResponse,\n      });\n\n      const mockFile = createMockFile('test-image.jpg', 'image/jpeg');\n\n      const mixedVariables: TryonMutationVariablesWithFiles = {\n        modelImage: 'data:image/jpeg;base64,existing-base64-data',\n        apparelImages: [mockFile, 'data:image/png;base64,another-base64-image']\n      };\n\n      const TestComponent = () => {\n        const mutation = useTryonMutation({ enableRetry: false });\n        \n        React.useEffect(() => {\n          mutation.mutate(mixedVariables as any);\n        }, []);\n\n        return <div data-testid=\"status\">{mutation.status}</div>;\n      };\n\n      renderWithProvider(<TestComponent />);\n\n      await waitFor(() => {\n        expect(screen.getByTestId('status')).toHaveTextContent('success');\n      }, { timeout: 5000 });\n\n      expect(mockFetch).toHaveBeenCalledTimes(1);\n    });\n\n    it('should handle image processing errors gracefully', async () => {\n      // Mock FileReader to simulate file processing error\n      const originalFileReader = global.FileReader;\n      global.FileReader = class MockFileReader {\n        onload: ((event: any) => void) | null = null;\n        onerror: ((event: any) => void) | null = null;\n        result: string | null = null;\n        \n        readAsDataURL(file: File) {\n          setTimeout(() => {\n            if (this.onerror) {\n              this.onerror({ target: { error: new Error('File reading failed') } } as any);\n            }\n          }, 0);\n        }\n      } as any;\n\n      const mockFile = createMockFile('invalid.txt', 'text/plain');\n\n      const TestComponent = () => {\n        const mutation = useTryonMutation({ enableRetry: false });\n        \n        React.useEffect(() => {\n          mutation.mutate({\n            modelImage: mockFile,\n            apparelImages: []\n          } as any);\n        }, []);\n\n        return (\n          <div>\n            <div data-testid=\"status\">{mutation.status}</div>\n            <div data-testid=\"hasError\">{mutation.isError.toString()}</div>\n          </div>\n        );\n      };\n\n      renderWithProvider(<TestComponent />);\n\n      await waitFor(() => {\n        expect(screen.getByTestId('status')).toHaveTextContent('error');\n      }, { timeout: 3000 });\n\n      expect(screen.getByTestId('hasError')).toHaveTextContent('true');\n\n      // Restore FileReader\n      global.FileReader = originalFileReader;\n    });\n\n    it('should pass processed variables to API with correct format', async () => {\n      mockFetch.mockResolvedValueOnce({\n        ok: true,\n        json: async () => mockSuccessResponse,\n      });\n\n      const mockFile = createMockFile('test.jpg', 'image/jpeg');\n\n      const TestComponent = () => {\n        const mutation = useTryonMutation({ enableRetry: false });\n        \n        React.useEffect(() => {\n          mutation.mutate({\n            modelImage: mockFile,\n            apparelImages: [mockFile]\n          } as any);\n        }, []);\n\n        return <div data-testid=\"status\">{mutation.status}</div>;\n      };\n\n      renderWithProvider(<TestComponent />);\n\n      await waitFor(() => {\n        expect(screen.getByTestId('status')).toHaveTextContent('success');\n      });\n\n      const [url, requestInit] = mockFetch.mock.calls[0];\n      expect(url).toBe('/api/tryon');\n      \n      const requestBody = JSON.parse(requestInit.body);\n      expect(requestBody.modelImage).toMatch(/^data:image\\/jpeg;base64,/);\n      expect(requestBody.apparelImages).toHaveLength(1);\n      expect(requestBody.apparelImages[0]).toMatch(/^data:image\\/jpeg;base64,/);\n    });\n\n    it('should include image processing results in mutation context', async () => {\n      mockFetch.mockResolvedValueOnce({\n        ok: true,\n        json: async () => mockSuccessResponse,\n      });\n\n      const mockFile = createMockFile('test.jpg', 'image/jpeg');\n      let capturedContext: any = null;\n\n      const onSuccess = jest.fn((data, variables, context) => {\n        capturedContext = context;\n      });\n\n      const TestComponent = () => {\n        const mutation = useTryonMutation({ \n          enableRetry: false,\n          onSuccess\n        });\n        \n        React.useEffect(() => {\n          mutation.mutate({\n            modelImage: mockFile,\n            apparelImages: []\n          } as any);\n        }, []);\n\n        return <div data-testid=\"status\">{mutation.status}</div>;\n      };\n\n      renderWithProvider(<TestComponent />);\n\n      await waitFor(() => {\n        expect(screen.getByTestId('status')).toHaveTextContent('success');\n      });\n\n      expect(onSuccess).toHaveBeenCalled();\n      expect(capturedContext).toBeTruthy();\n      expect(capturedContext.imageProcessingResults).toBeTruthy();\n      expect(capturedContext.imageProcessingResults.totalProcessingTime).toBeGreaterThan(0);\n    });\n  });\n});"],"names":["mockFetch","jest","fn","global","fetch","MockAbortController","signal","aborted","abort","AbortController","describe","queryClient","beforeEach","QueryClient","defaultOptions","queries","retry","gcTime","mutations","mockClear","clearAllTimers","useFakeTimers","afterEach","useRealTimers","clear","renderWithProvider","children","render","QueryClientProvider","client","mockVariables","modelImage","apparelImages","mockSuccessResponse","img_generated","metadata","processingTime","modelVersion","timestamp","it","TestComponent","mutation","useTryonMutation","div","data-testid","status","isLoading","toString","isSuccess","isError","isIdle","Boolean","data","error","expect","screen","getByTestId","toHaveTextContent","mutate","mutateAsync","reset","mockResolvedValueOnce","ok","json","React","useEffect","JSON","stringify","waitFor","dataContent","textContent","parsedData","parse","toBe","toEqual","toHaveBeenCalledTimes","toHaveBeenCalledWith","method","headers","body","variablesWithMetadata","options","custom","userId","requestInit","mock","calls","requestBody","errorResponse","details","field","message","code","statusText","timeout","errorContent","parsedError","retryable","mockRejectedValueOnce","Error","enableRetry","invalid","maxRetries","initialRetryDelay","act","advanceTimersByTimeAsync","mockResolvedValue","timeoutPromise","Promise","_","reject","setTimeout","mockImplementationOnce","onSuccess","objectContaining","variables","startTime","any","Number","retryCount","onError","stringContaining","category","severity","recoveryActions","arrayContaining","type","onMutate","mockReturnValue","customData","onSettled","unmount","TestComponentError","undefined","handleReset","button","onClick","click","createMockFile","name","content","blob","Blob","File","mockCanvas","width","height","getContext","drawImage","imageSmoothingEnabled","imageSmoothingQuality","toDataURL","toBlob","callback","HTMLCanvasElement","prototype","Image","MockImage","src","value","onload","onerror","crossOrigin","mockFile","mockApparelFile","variablesWithFiles","imageProcessing","targetWidth","targetHeight","maxSizeKB","context","mixedVariables","originalFileReader","FileReader","MockFileReader","readAsDataURL","file","target","result","url","toMatch","toHaveLength","capturedContext","toHaveBeenCalled","toBeTruthy","imageProcessingResults","totalProcessingTime","toBeGreaterThan"],"mappings":"AAAA;;CAEC;;;;;8DACiB;wBAC2B;4BACI;kCAChB;;;;;;AASjC,sBAAsB;AACtB,MAAMA,YAAYC,KAAKC,EAAE;AACzBC,OAAOC,KAAK,GAAGJ;AAEf,0CAA0C;AAC1C,MAAMK;;aACJC,SAAS;YAAEC,SAAS;QAAM;aAC1BC,QAAQP,KAAKC,EAAE,CAAC;YACd,IAAI,CAACI,MAAM,CAACC,OAAO,GAAG;QACxB;;AACF;AACAJ,OAAOM,eAAe,GAAGJ;AAEzBK,SAAS,oBAAoB;IAC3B,IAAIC;IAEJC,WAAW;QACTD,cAAc,IAAIE,uBAAW,CAAC;YAC5BC,gBAAgB;gBACdC,SAAS;oBAAEC,OAAO;oBAAOC,QAAQ;gBAAE;gBACnCC,WAAW;oBAAEF,OAAO;gBAAM;YAC5B;QACF;QACAhB,UAAUmB,SAAS;QACnBlB,KAAKmB,cAAc;QACnBnB,KAAKoB,aAAa;IACpB;IAEAC,UAAU;QACRrB,KAAKsB,aAAa;QAClBZ,YAAYa,KAAK;IACnB;IAEA,MAAMC,qBAAqB,CAACC;QAC1B,OAAOC,IAAAA,cAAM,gBACX,qBAACC,+BAAmB;YAACC,QAAQlB;sBAC1Be;;IAGP;IAEA,MAAMI,gBAAwC;QAC5CC,YAAY;QACZC,eAAe;YAAC;SAAqD;IACvE;IAEA,MAAMC,sBAA6C;QACjDC,eAAe;QACfC,UAAU;YACRC,gBAAgB;YAChBC,cAAc;YACdC,WAAW;QACb;IACF;IAEA5B,SAAS,4BAA4B;QACnC6B,GAAG,gDAAgD;YACjD,MAAMC,gBAAgB;gBACpB,MAAMC,WAAWC,IAAAA,kCAAgB;gBAEjC,qBACE,sBAACC;;sCACC,qBAACA;4BAAIC,eAAY;sCAAUH,SAASI,MAAM;;sCAC1C,qBAACF;4BAAIC,eAAY;sCAAaH,SAASK,SAAS,CAACC,QAAQ;;sCACzD,qBAACJ;4BAAIC,eAAY;sCAAaH,SAASO,SAAS,CAACD,QAAQ;;sCACzD,qBAACJ;4BAAIC,eAAY;sCAAWH,SAASQ,OAAO,CAACF,QAAQ;;sCACrD,qBAACJ;4BAAIC,eAAY;sCAAUH,SAASS,MAAM,CAACH,QAAQ;;sCACnD,qBAACJ;4BAAIC,eAAY;sCAAWO,QAAQV,SAASW,IAAI,EAAEL,QAAQ;;sCAC3D,qBAACJ;4BAAIC,eAAY;sCAAYO,QAAQV,SAASY,KAAK,EAAEN,QAAQ;;;;YAGnE;YAEAtB,iCAAmB,qBAACe;YAEpBc,OAAOC,cAAM,CAACC,WAAW,CAAC,WAAWC,iBAAiB,CAAC;YACvDH,OAAOC,cAAM,CAACC,WAAW,CAAC,cAAcC,iBAAiB,CAAC;YAC1DH,OAAOC,cAAM,CAACC,WAAW,CAAC,cAAcC,iBAAiB,CAAC;YAC1DH,OAAOC,cAAM,CAACC,WAAW,CAAC,YAAYC,iBAAiB,CAAC;YACxDH,OAAOC,cAAM,CAACC,WAAW,CAAC,WAAWC,iBAAiB,CAAC;YACvDH,OAAOC,cAAM,CAACC,WAAW,CAAC,YAAYC,iBAAiB,CAAC;YACxDH,OAAOC,cAAM,CAACC,WAAW,CAAC,aAAaC,iBAAiB,CAAC;QAC3D;QAEAlB,GAAG,mDAAmD;YACpD,MAAMC,gBAAgB;gBACpB,MAAMC,WAAWC,IAAAA,kCAAgB;gBAEjC,qBACE,sBAACC;;sCACC,qBAACA;4BAAIC,eAAY;sCAAa,OAAOH,SAASiB,MAAM,KAAK,aAAa,aAAa;;sCACnF,qBAACf;4BAAIC,eAAY;sCAAkB,OAAOH,SAASkB,WAAW,KAAK,aAAa,aAAa;;sCAC7F,qBAAChB;4BAAIC,eAAY;sCAAY,OAAOH,SAASmB,KAAK,KAAK,aAAa,aAAa;;;;YAGvF;YAEAnC,iCAAmB,qBAACe;YAEpBc,OAAOC,cAAM,CAACC,WAAW,CAAC,cAAcC,iBAAiB,CAAC;YAC1DH,OAAOC,cAAM,CAACC,WAAW,CAAC,mBAAmBC,iBAAiB,CAAC;YAC/DH,OAAOC,cAAM,CAACC,WAAW,CAAC,aAAaC,iBAAiB,CAAC;QAC3D;IACF;IAEA/C,SAAS,wBAAwB;QAC/B6B,GAAG,yCAAyC;YAC1CvC,UAAU6D,qBAAqB,CAAC;gBAC9BC,IAAI;gBACJC,MAAM,UAAY9B;YACpB;YAEA,MAAMO,gBAAgB;gBACpB,MAAMC,WAAWC,IAAAA,kCAAgB;gBAEjCsB,cAAK,CAACC,SAAS,CAAC;oBACdxB,SAASiB,MAAM,CAAC5B;gBAClB,GAAG,EAAE;gBAEL,qBACE,sBAACa;;sCACC,qBAACA;4BAAIC,eAAY;sCAAUH,SAASI,MAAM;;sCAC1C,qBAACF;4BAAIC,eAAY;sCAAQH,SAASW,IAAI,GAAGc,KAAKC,SAAS,CAAC1B,SAASW,IAAI,IAAI;;;;YAG/E;YAEA3B,iCAAmB,qBAACe;YAEpB,MAAM4B,IAAAA,eAAO,EAAC;gBACZd,OAAOC,cAAM,CAACC,WAAW,CAAC,WAAWC,iBAAiB,CAAC;YACzD;YAEA,MAAMY,cAAcd,cAAM,CAACC,WAAW,CAAC,QAAQc,WAAW;YAC1D,MAAMC,aAAaL,KAAKM,KAAK,CAACH;YAC9Bf,OAAOiB,WAAWrC,aAAa,EAAEuC,IAAI,CAACxC,oBAAoBC,aAAa;YACvEoB,OAAOiB,WAAWpC,QAAQ,EAAEuC,OAAO,CAACzC,oBAAoBE,QAAQ;QAClE;QAEAI,GAAG,uDAAuD;YACxDvC,UAAU6D,qBAAqB,CAAC;gBAC9BC,IAAI;gBACJC,MAAM,UAAY9B;YACpB;YAEA,MAAMO,gBAAgB;gBACpB,MAAMC,WAAWC,IAAAA,kCAAgB;gBAEjCsB,cAAK,CAACC,SAAS,CAAC;oBACdxB,SAASiB,MAAM,CAAC5B;gBAClB,GAAG,EAAE;gBAEL,qBAAO,qBAACa;oBAAIC,eAAY;8BAAO;;YACjC;YAEAnB,iCAAmB,qBAACe;YAEpB,MAAM4B,IAAAA,eAAO,EAAC;gBACZd,OAAOtD,WAAW2E,qBAAqB,CAAC;YAC1C;YAEArB,OAAOtD,WAAW4E,oBAAoB,CAAC,cAAc;gBACnDC,QAAQ;gBACRC,SAAS;oBACP,gBAAgB;gBAClB;gBACAC,MAAMb,KAAKC,SAAS,CAAC;oBACnBpC,YAAYD,cAAcC,UAAU;oBACpCC,eAAeF,cAAcE,aAAa;gBAC5C;YACF;QACF;QAEAO,GAAG,oDAAoD;YACrDvC,UAAU6D,qBAAqB,CAAC;gBAC9BC,IAAI;gBACJC,MAAM,UAAY9B;YACpB;YAEA,MAAM+C,wBAAgD;gBACpD,GAAGlD,aAAa;gBAChBmD,SAAS;oBACP9C,UAAU;wBAAE+C,QAAQ;wBAAQC,QAAQ;oBAAM;gBAC5C;YACF;YAEA,MAAM3C,gBAAgB;gBACpB,MAAMC,WAAWC,IAAAA,kCAAgB;gBAEjCsB,cAAK,CAACC,SAAS,CAAC;oBACdxB,SAASiB,MAAM,CAACsB;gBAClB,GAAG,EAAE;gBAEL,qBAAO,qBAACrC;oBAAIC,eAAY;8BAAO;;YACjC;YAEAnB,iCAAmB,qBAACe;YAEpB,MAAM4B,IAAAA,eAAO,EAAC;gBACZd,OAAOtD,WAAW2E,qBAAqB,CAAC;YAC1C;YAEA,MAAM,GAAGS,YAAY,GAAGpF,UAAUqF,IAAI,CAACC,KAAK,CAAC,EAAE;YAC/C,MAAMC,cAAcrB,KAAKM,KAAK,CAACY,YAAYL,IAAI;YAC/CzB,OAAOiC,YAAYpD,QAAQ,EAAEuC,OAAO,CAAC;gBAAEQ,QAAQ;gBAAQC,QAAQ;YAAM;QACvE;IACF;IAEAzE,SAAS,kBAAkB;QACzB6B,GAAG,sCAAsC;YACvC,MAAMiD,gBAAgB;gBACpBnC,OAAO;gBACPoC,SAAS;oBAAC;wBAAEC,OAAO;wBAAcC,SAAS;oBAAiB;iBAAE;gBAC7DC,MAAM;YACR;YAEA5F,UAAU6D,qBAAqB,CAAC;gBAC9BC,IAAI;gBACJjB,QAAQ;gBACRgD,YAAY;gBACZ9B,MAAM,UAAYyB;YACpB;YAEA,MAAMhD,gBAAgB;gBACpB,MAAMC,WAAWC,IAAAA,kCAAgB;gBAEjCsB,cAAK,CAACC,SAAS,CAAC;oBACdxB,SAASiB,MAAM,CAAC5B;gBAClB,GAAG,EAAE;gBAEL,qBACE,sBAACa;;sCACC,qBAACA;4BAAIC,eAAY;sCAAUH,SAASI,MAAM;;sCAC1C,qBAACF;4BAAIC,eAAY;sCAASH,SAASY,KAAK,GAAGa,KAAKC,SAAS,CAAC1B,SAASY,KAAK,IAAI;;;;YAGlF;YAEA5B,iCAAmB,qBAACe;YAEpB,MAAM4B,IAAAA,eAAO,EAAC;gBACZd,OAAOC,cAAM,CAACC,WAAW,CAAC,WAAWC,iBAAiB,CAAC;YACzD,GAAG;gBAAEqC,SAAS;YAAK;YAEnB,MAAMC,eAAexC,cAAM,CAACC,WAAW,CAAC,SAASc,WAAW;YAC5D,MAAM0B,cAAc9B,KAAKM,KAAK,CAACuB;YAC/BzC,OAAO0C,YAAY3C,KAAK,EAAEoB,IAAI,CAAC;YAC/BnB,OAAO0C,YAAYP,OAAO,EAAEf,OAAO,CAACc,cAAcC,OAAO;YACzDnC,OAAO0C,YAAYnD,MAAM,EAAE4B,IAAI,CAAC;YAChCnB,OAAO0C,YAAYC,SAAS,EAAExB,IAAI,CAAC;QACrC;QAEAlC,GAAG,gCAAgC;YACjCvC,UAAUkG,qBAAqB,CAAC,IAAIC,MAAM;YAE1C,MAAM3D,gBAAgB;gBACpB,MAAMC,WAAWC,IAAAA,kCAAgB,EAAC;oBAAE0D,aAAa;gBAAM;gBAEvDpC,cAAK,CAACC,SAAS,CAAC;oBACdxB,SAASiB,MAAM,CAAC5B;gBAClB,GAAG,EAAE;gBAEL,qBACE,sBAACa;;sCACC,qBAACA;4BAAIC,eAAY;sCAAUH,SAASI,MAAM;;sCAC1C,qBAACF;4BAAIC,eAAY;sCAAYH,SAASQ,OAAO,CAACF,QAAQ;;sCACtD,qBAACJ;4BAAIC,eAAY;sCAAaH,SAASY,KAAK,GAAG,OAAOZ,SAASY,KAAK,GAAG;;sCACvE,qBAACV;4BAAIC,eAAY;sCAAgBH,SAASY,KAAK,YAAY8C,QAAQ1D,SAASY,KAAK,CAACsC,OAAO,GAAG;;;;YAGlG;YAEAlE,iCAAmB,qBAACe;YAEpB,MAAM4B,IAAAA,eAAO,EAAC;gBACZd,OAAOC,cAAM,CAACC,WAAW,CAAC,WAAWC,iBAAiB,CAAC;YACzD,GAAG;gBAAEqC,SAAS;YAAK;YAEnBxC,OAAOC,cAAM,CAACC,WAAW,CAAC,aAAaC,iBAAiB,CAAC;YACzDH,OAAOC,cAAM,CAACC,WAAW,CAAC,iBAAiBC,iBAAiB,CAAC;QAC/D;QAEAlB,GAAG,6CAA6C;YAC9CvC,UAAU6D,qBAAqB,CAAC;gBAC9BC,IAAI;gBACJC,MAAM,UAAa,CAAA;wBAAEsC,SAAS;oBAAW,CAAA;YAC3C;YAEA,MAAM7D,gBAAgB;gBACpB,MAAMC,WAAWC,IAAAA,kCAAgB,EAAC;oBAAE0D,aAAa;gBAAM;gBAEvDpC,cAAK,CAACC,SAAS,CAAC;oBACdxB,SAASiB,MAAM,CAAC5B;gBAClB,GAAG,EAAE;gBAEL,qBACE,sBAACa;;sCACC,qBAACA;4BAAIC,eAAY;sCAAUH,SAASI,MAAM;;sCAC1C,qBAACF;4BAAIC,eAAY;sCAAYH,SAASQ,OAAO,CAACF,QAAQ;;sCACtD,qBAACJ;4BAAIC,eAAY;sCAAgBH,SAASY,KAAK,YAAY8C,QAAQ1D,SAASY,KAAK,CAACsC,OAAO,GAAG;;;;YAGlG;YAEAlE,iCAAmB,qBAACe;YAEpB,MAAM4B,IAAAA,eAAO,EAAC;gBACZd,OAAOC,cAAM,CAACC,WAAW,CAAC,WAAWC,iBAAiB,CAAC;YACzD,GAAG;gBAAEqC,SAAS;YAAK;YAEnBxC,OAAOC,cAAM,CAACC,WAAW,CAAC,aAAaC,iBAAiB,CAAC;YACzDH,OAAOC,cAAM,CAACC,WAAW,CAAC,iBAAiBC,iBAAiB,CAAC;QAC/D;IACF;IAEA/C,SAAS,eAAe;QACtB6B,GAAG,6DAA6D;YAC9D,8CAA8C;YAC9CvC,UACG6D,qBAAqB,CAAC;gBACrBC,IAAI;gBACJjB,QAAQ;gBACRgD,YAAY;gBACZ9B,MAAM,UAAa,CAAA;wBAAEV,OAAO;oBAAe,CAAA;YAC7C,GACCQ,qBAAqB,CAAC;gBACrBC,IAAI;gBACJjB,QAAQ;gBACRgD,YAAY;gBACZ9B,MAAM,UAAa,CAAA;wBAAEV,OAAO;oBAAe,CAAA;YAC7C,GACCQ,qBAAqB,CAAC;gBACrBC,IAAI;gBACJC,MAAM,UAAY9B;YACpB;YAEF,MAAMO,gBAAgB;gBACpB,MAAMC,WAAWC,IAAAA,kCAAgB,EAAC;oBAChC0D,aAAa;oBACbE,YAAY;oBACZC,mBAAmB;gBACrB;gBAEAvC,cAAK,CAACC,SAAS,CAAC;oBACdxB,SAASiB,MAAM,CAAC5B;gBAClB,GAAG,EAAE;gBAEL,qBACE,qBAACa;8BACC,cAAA,qBAACA;wBAAIC,eAAY;kCAAUH,SAASI,MAAM;;;YAGhD;YAEApB,iCAAmB,qBAACe;YAEpB,oCAAoC;YACpC,MAAMgE,IAAAA,WAAG,EAAC;gBACR,MAAMvG,KAAKwG,wBAAwB,CAAC;YACtC;YAEA,MAAMrC,IAAAA,eAAO,EAAC;gBACZd,OAAOC,cAAM,CAACC,WAAW,CAAC,WAAWC,iBAAiB,CAAC;YACzD;YAEAH,OAAOtD,WAAW2E,qBAAqB,CAAC;QAC1C;QAEApC,GAAG,4CAA4C;YAC7CvC,UAAU6D,qBAAqB,CAAC;gBAC9BC,IAAI;gBACJjB,QAAQ;gBACRgD,YAAY;gBACZ9B,MAAM,UAAa,CAAA;wBAAEV,OAAO;oBAAmB,CAAA;YACjD;YAEA,MAAMb,gBAAgB;gBACpB,MAAMC,WAAWC,IAAAA,kCAAgB,EAAC;oBAChC0D,aAAa;oBACbE,YAAY;gBACd;gBAEAtC,cAAK,CAACC,SAAS,CAAC;oBACdxB,SAASiB,MAAM,CAAC5B;gBAClB,GAAG,EAAE;gBAEL,qBACE,qBAACa;8BACC,cAAA,qBAACA;wBAAIC,eAAY;kCAAUH,SAASI,MAAM;;;YAGhD;YAEApB,iCAAmB,qBAACe;YAEpB,MAAM4B,IAAAA,eAAO,EAAC;gBACZd,OAAOC,cAAM,CAACC,WAAW,CAAC,WAAWC,iBAAiB,CAAC;YACzD;YAEAH,OAAOtD,WAAW2E,qBAAqB,CAAC;QAC1C;QAEApC,GAAG,2CAA2C;YAC5CvC,UAAU0G,iBAAiB,CAAC;gBAC1B5C,IAAI;gBACJjB,QAAQ;gBACRgD,YAAY;gBACZ9B,MAAM,UAAa,CAAA;wBAAEV,OAAO;oBAAe,CAAA;YAC7C;YAEA,MAAMb,gBAAgB;gBACpB,MAAMC,WAAWC,IAAAA,kCAAgB,EAAC;oBAChC0D,aAAa;oBACbE,YAAY;oBACZC,mBAAmB;gBACrB;gBAEAvC,cAAK,CAACC,SAAS,CAAC;oBACdxB,SAASiB,MAAM,CAAC5B;gBAClB,GAAG,EAAE;gBAEL,qBACE,qBAACa;8BACC,cAAA,qBAACA;wBAAIC,eAAY;kCAAUH,SAASI,MAAM;;;YAGhD;YAEApB,iCAAmB,qBAACe;YAEpB,MAAMgE,IAAAA,WAAG,EAAC;gBACR,MAAMvG,KAAKwG,wBAAwB,CAAC;YACtC;YAEA,MAAMrC,IAAAA,eAAO,EAAC;gBACZd,OAAOC,cAAM,CAACC,WAAW,CAAC,WAAWC,iBAAiB,CAAC;YACzD;YAEAH,OAAOtD,WAAW2E,qBAAqB,CAAC,IAAI,wBAAwB;QACtE;IACF;IAEAjE,SAAS,oBAAoB;QAC3B6B,GAAG,iCAAiC;YAClC,MAAMoE,iBAAiB,IAAIC,QAAQ,CAACC,GAAGC;gBACrCC,WAAW,IAAMD,OAAO,IAAIX,MAAM,qBAAqB;YACzD;YAEAnG,UAAUgH,sBAAsB,CAAC,IAAML;YAEvC,MAAMnE,gBAAgB;gBACpB,MAAMC,WAAWC,IAAAA,kCAAgB,EAAC;oBAAE0D,aAAa;gBAAM;gBAEvDpC,cAAK,CAACC,SAAS,CAAC;oBACdxB,SAASiB,MAAM,CAAC;wBACd,GAAG5B,aAAa;wBAChBmD,SAAS;4BAAEa,SAAS;wBAAI;oBAC1B;gBACF,GAAG,EAAE;gBAEL,qBACE,qBAACnD;8BACC,cAAA,qBAACA;wBAAIC,eAAY;kCAAUH,SAASI,MAAM;;;YAGhD;YAEApB,iCAAmB,qBAACe;YAEpB,MAAMgE,IAAAA,WAAG,EAAC;gBACR,MAAMvG,KAAKwG,wBAAwB,CAAC;YACtC;YAEA,MAAMrC,IAAAA,eAAO,EAAC;gBACZd,OAAOC,cAAM,CAACC,WAAW,CAAC,WAAWC,iBAAiB,CAAC;YACzD,GAAG;gBAAEqC,SAAS;YAAK;QACrB;IACF;IAEApF,SAAS,uBAAuB;QAC9B6B,GAAG,kCAAkC;YACnCvC,UAAU6D,qBAAqB,CAAC;gBAC9BC,IAAI;gBACJC,MAAM,UAAY9B;YACpB;YAEA,MAAMgF,YAAYhH,KAAKC,EAAE;YAEzB,MAAMsC,gBAAgB;gBACpB,MAAMC,WAAWC,IAAAA,kCAAgB,EAAC;oBAAEuE;gBAAU;gBAE9CjD,cAAK,CAACC,SAAS,CAAC;oBACdxB,SAASiB,MAAM,CAAC5B;gBAClB,GAAG,EAAE;gBAEL,qBAAO,qBAACa;oBAAIC,eAAY;8BAAUH,SAASI,MAAM;;YACnD;YAEApB,iCAAmB,qBAACe;YAEpB,MAAM4B,IAAAA,eAAO,EAAC;gBACZd,OAAOC,cAAM,CAACC,WAAW,CAAC,WAAWC,iBAAiB,CAAC;YACzD;YAEAH,OAAO2D,WAAWrC,oBAAoB,CACpC3C,qBACAH,eACAwB,OAAO4D,gBAAgB,CAAC;gBACtBC,WAAWrF;gBACXsF,WAAW9D,OAAO+D,GAAG,CAACC;gBACtBC,YAAY;YACd;QAEJ;QAEAhF,GAAG,gCAAgC;YACjCvC,UAAUkG,qBAAqB,CAAC,IAAIC,MAAM;YAE1C,MAAMqB,UAAUvH,KAAKC,EAAE;YAEvB,MAAMsC,gBAAgB;gBACpB,MAAMC,WAAWC,IAAAA,kCAAgB,EAAC;oBAAE8E;oBAASpB,aAAa;gBAAM;gBAEhEpC,cAAK,CAACC,SAAS,CAAC;oBACdxB,SAASiB,MAAM,CAAC5B;gBAClB,GAAG,EAAE;gBAEL,qBAAO,qBAACa;oBAAIC,eAAY;8BAAUH,SAASI,MAAM;;YACnD;YAEApB,iCAAmB,qBAACe;YAEpB,MAAM4B,IAAAA,eAAO,EAAC;gBACZd,OAAOC,cAAM,CAACC,WAAW,CAAC,WAAWC,iBAAiB,CAAC;YACzD,GAAG;gBAAEqC,SAAS;YAAK;YAEnBxC,OAAOkE,SAAS5C,oBAAoB,CAClCtB,OAAO4D,gBAAgB,CAAC;gBACtB7D,OAAOC,OAAOmE,gBAAgB,CAAC;gBAC/BxB,WAAW;gBACXyB,UAAU;gBACV9B,MAAM;gBACN+B,UAAU;gBACVC,iBAAiBtE,OAAOuE,eAAe,CAAC;oBACtCvE,OAAO4D,gBAAgB,CAAC;wBACtBY,MAAM;oBACR;iBACD;YACH,IACAhG,eACAwB,OAAO4D,gBAAgB,CAAC;gBACtBC,WAAWrF;YACb;QAEJ;QAEAS,GAAG,0DAA0D;YAC3DvC,UAAU6D,qBAAqB,CAAC;gBAC9BC,IAAI;gBACJC,MAAM,UAAY9B;YACpB;YAEA,MAAM8F,WAAW9H,KAAKC,EAAE,GAAG8H,eAAe,CAAC;gBAAEC,YAAY;YAAO;YAEhE,MAAMzF,gBAAgB;gBACpB,MAAMC,WAAWC,IAAAA,kCAAgB,EAAC;oBAAEqF;gBAAS;gBAE7C/D,cAAK,CAACC,SAAS,CAAC;oBACdxB,SAASiB,MAAM,CAAC5B;gBAClB,GAAG,EAAE;gBAEL,qBAAO,qBAACa;oBAAIC,eAAY;8BAAUH,SAASI,MAAM;;YACnD;YAEApB,iCAAmB,qBAACe;YAEpB,MAAM4B,IAAAA,eAAO,EAAC;gBACZd,OAAOC,cAAM,CAACC,WAAW,CAAC,WAAWC,iBAAiB,CAAC;YACzD;YAEAH,OAAOyE,UAAUnD,oBAAoB,CAAC9C;QACxC;QAEAS,GAAG,4DAA4D;YAC7D,MAAM2F,YAAYjI,KAAKC,EAAE;YAEzB,oBAAoB;YACpBF,UAAU6D,qBAAqB,CAAC;gBAC9BC,IAAI;gBACJC,MAAM,UAAY9B;YACpB;YAEA,MAAMO,gBAAgB;gBACpB,MAAMC,WAAWC,IAAAA,kCAAgB,EAAC;oBAAEwF;gBAAU;gBAE9ClE,cAAK,CAACC,SAAS,CAAC;oBACdxB,SAASiB,MAAM,CAAC5B;gBAClB,GAAG,EAAE;gBAEL,qBAAO,qBAACa;oBAAIC,eAAY;8BAAUH,SAASI,MAAM;;YACnD;YAEA,MAAM,EAAEsF,OAAO,EAAE,GAAG1G,iCAAmB,qBAACe;YAExC,MAAM4B,IAAAA,eAAO,EAAC;gBACZd,OAAOC,cAAM,CAACC,WAAW,CAAC,WAAWC,iBAAiB,CAAC;YACzD;YAEAH,OAAO4E,WAAWtD,oBAAoB,CACpC3C,qBACA,MACAH,eACAwB,OAAO4D,gBAAgB,CAAC;gBACtBC,WAAWrF;YACb;YAGFqG;YACAD,UAAU/G,SAAS;YAEnB,kBAAkB;YAClBnB,UAAUkG,qBAAqB,CAAC,IAAIC,MAAM;YAE1C,MAAMiC,qBAAqB;gBACzB,MAAM3F,WAAWC,IAAAA,kCAAgB,EAAC;oBAAEwF;oBAAW9B,aAAa;gBAAM;gBAElEpC,cAAK,CAACC,SAAS,CAAC;oBACdxB,SAASiB,MAAM,CAAC5B;gBAClB,GAAG,EAAE;gBAEL,qBAAO,qBAACa;oBAAIC,eAAY;8BAAUH,SAASI,MAAM;;YACnD;YAEApB,iCAAmB,qBAAC2G;YAEpB,MAAMhE,IAAAA,eAAO,EAAC;gBACZd,OAAOC,cAAM,CAACC,WAAW,CAAC,WAAWC,iBAAiB,CAAC;YACzD,GAAG;gBAAEqC,SAAS;YAAK;YAEnBxC,OAAO4E,WAAWtD,oBAAoB,CACpCyD,WACA/E,OAAO4D,gBAAgB,CAAC;gBACtB7D,OAAOC,OAAOmE,gBAAgB,CAAC;gBAC/BC,UAAU;gBACV9B,MAAM;gBACN+B,UAAU;gBACV1B,WAAW;YACb,IACAnE,eACAwB,OAAO4D,gBAAgB,CAAC;gBACtBC,WAAWrF;YACb;QAEJ;IACF;IAEApB,SAAS,uBAAuB;QAC9B6B,GAAG,+BAA+B;YAChCvC,UAAU6D,qBAAqB,CAAC;gBAC9BC,IAAI;gBACJC,MAAM,UAAY9B;YACpB;YAEA,MAAMO,gBAAgB;gBACpB,MAAMC,WAAWC,IAAAA,kCAAgB;gBAEjCsB,cAAK,CAACC,SAAS,CAAC;oBACdxB,SAASiB,MAAM,CAAC5B;gBAClB,GAAG,EAAE;gBAEL,MAAMwG,cAAc;oBAClB7F,SAASmB,KAAK;gBAChB;gBAEA,qBACE,sBAACjB;;sCACC,qBAACA;4BAAIC,eAAY;sCAAUH,SAASI,MAAM;;sCAC1C,qBAAC0F;4BAAOC,SAASF;4BAAa1F,eAAY;sCAAe;;;;YAG/D;YAEAnB,iCAAmB,qBAACe;YAEpB,MAAM4B,IAAAA,eAAO,EAAC;gBACZd,OAAOC,cAAM,CAACC,WAAW,CAAC,WAAWC,iBAAiB,CAAC;YACzD,GAAG;gBAAEqC,SAAS;YAAK;YAEnBU,IAAAA,WAAG,EAAC;gBACFjD,cAAM,CAACC,WAAW,CAAC,gBAAgBiF,KAAK;YAC1C;YAEA,MAAMrE,IAAAA,eAAO,EAAC;gBACZd,OAAOC,cAAM,CAACC,WAAW,CAAC,WAAWC,iBAAiB,CAAC;YACzD;QACF;IACF;IAEA/C,SAAS,yBAAyB;QAChC6B,GAAG,kDAAkD;YACnDvC,UAAU0G,iBAAiB,CAAC;gBAC1B5C,IAAI;gBACJjB,QAAQ;gBACRgD,YAAY;gBACZ9B,MAAM,UAAa,CAAA;wBAAEV,OAAO;oBAAe,CAAA;YAC7C;YAEA,MAAMb,gBAAgB;gBACpB,MAAMC,WAAWC,IAAAA,kCAAgB,EAAC;oBAChC0D,aAAa;gBACf;gBAEApC,cAAK,CAACC,SAAS,CAAC;oBACdxB,SAASiB,MAAM,CAAC5B;gBAClB,GAAG,EAAE;gBAEL,qBAAO,qBAACa;oBAAIC,eAAY;8BAAUH,SAASI,MAAM;;YACnD;YAEApB,iCAAmB,qBAACe;YAEpB,MAAM4B,IAAAA,eAAO,EAAC;gBACZd,OAAOC,cAAM,CAACC,WAAW,CAAC,WAAWC,iBAAiB,CAAC;YACzD;YAEAH,OAAOtD,WAAW2E,qBAAqB,CAAC;QAC1C;IACF;IAEAjE,SAAS,gCAAgC;QACvC,wBAAwB;QACxB,MAAMgI,iBAAiB,CAACC,MAAcb,MAAcc,UAAkB,iBAAiB;YACrF,MAAMC,OAAO,IAAIC,KAAK;gBAACF;aAAQ,EAAE;gBAAEd;YAAK;YACxC,OAAO,IAAIiB,KAAK;gBAACF;aAAK,EAAEF,MAAM;gBAAEb;YAAK;QACvC;QAEA,6CAA6C;QAC7C,MAAMkB,aAAa;YACjBC,OAAO;YACPC,QAAQ;YACRC,YAAYlJ,KAAKC,EAAE,CAAC,IAAO,CAAA;oBACzBkJ,WAAWnJ,KAAKC,EAAE;oBAClBmJ,uBAAuB;oBACvBC,uBAAuB;gBACzB,CAAA;YACAC,WAAWtJ,KAAKC,EAAE,CAAC,IAAM;YACzBsJ,QAAQvJ,KAAKC,EAAE,CAAC,CAACuJ;gBACf,MAAMZ,OAAO,IAAIC,KAAK;oBAAC;iBAAY,EAAE;oBAAEhB,MAAM;gBAAa;gBAC1D2B,SAASZ;YACX;QACF;QAEAjI,WAAW;YACTT,OAAOuJ,iBAAiB,CAACC,SAAS,CAACR,UAAU,GAAGH,WAAWG,UAAU;YACrEhJ,OAAOuJ,iBAAiB,CAACC,SAAS,CAACJ,SAAS,GAAGP,WAAWO,SAAS;YACnEpJ,OAAOuJ,iBAAiB,CAACC,SAAS,CAACH,MAAM,GAAGR,WAAWQ,MAAM;YAE7D,yBAAyB;YACzBrJ,OAAOyJ,KAAK,GAAG,MAAMC;gBAOnB,IAAIC,IAAIC,KAAa,EAAE;oBACrBhD,WAAW;wBACT,IAAI,IAAI,CAACiD,MAAM,EAAE,IAAI,CAACA,MAAM;oBAC9B,GAAG;gBACL;;yBAVAA,SAA8B;yBAC9BC,UAA+B;yBAC/BhB,QAAQ;yBACRC,SAAS;yBACTgB,cAAc;;YAOhB;QACF;QAEA3H,GAAG,iEAAiE;YAClEvC,UAAU6D,qBAAqB,CAAC;gBAC9BC,IAAI;gBACJC,MAAM,UAAY9B;YACpB;YAEA,MAAMkI,WAAWzB,eAAe,kBAAkB;YAClD,MAAM0B,kBAAkB1B,eAAe,eAAe;YAEtD,MAAM2B,qBAAsD;gBAC1DtI,YAAYoI;gBACZnI,eAAe;oBAACoI;iBAAgB;YAClC;YAEA,MAAM5H,gBAAgB;gBACpB,MAAMC,WAAWC,IAAAA,kCAAgB,EAAC;oBAChC0D,aAAa;oBACbkE,iBAAiB;wBACfC,aAAa;wBACbC,cAAc;wBACdC,WAAW;oBACb;gBACF;gBAEAzG,cAAK,CAACC,SAAS,CAAC;oBACdxB,SAASiB,MAAM,CAAC2G;gBAClB,GAAG,EAAE;gBAEL,qBACE,sBAAC1H;;sCACC,qBAACA;4BAAIC,eAAY;sCAAUH,SAASI,MAAM;;sCAC1C,qBAACF;4BAAIC,eAAY;sCAAWH,SAASiI,OAAO,GAAG,gBAAgB;;;;YAGrE;YAEAjJ,iCAAmB,qBAACe;YAEpB,MAAM4B,IAAAA,eAAO,EAAC;gBACZd,OAAOC,cAAM,CAACC,WAAW,CAAC,WAAWC,iBAAiB,CAAC;YACzD,GAAG;gBAAEqC,SAAS;YAAK;YAEnBxC,OAAOC,cAAM,CAACC,WAAW,CAAC,YAAYC,iBAAiB,CAAC;YACxDH,OAAOtD,WAAW4E,oBAAoB,CAAC,cAActB,OAAO4D,gBAAgB,CAAC;gBAC3ErC,QAAQ;gBACRC,SAAS;oBACP,gBAAgB;gBAClB;gBACAC,MAAMzB,OAAOmE,gBAAgB,CAAC;YAChC;QACF;QAEAlF,GAAG,8CAA8C;YAC/CvC,UAAU6D,qBAAqB,CAAC;gBAC9BC,IAAI;gBACJC,MAAM,UAAY9B;YACpB;YAEA,MAAMkI,WAAWzB,eAAe,kBAAkB;YAElD,MAAMiC,iBAAkD;gBACtD5I,YAAY;gBACZC,eAAe;oBAACmI;oBAAU;iBAA6C;YACzE;YAEA,MAAM3H,gBAAgB;gBACpB,MAAMC,WAAWC,IAAAA,kCAAgB,EAAC;oBAAE0D,aAAa;gBAAM;gBAEvDpC,cAAK,CAACC,SAAS,CAAC;oBACdxB,SAASiB,MAAM,CAACiH;gBAClB,GAAG,EAAE;gBAEL,qBAAO,qBAAChI;oBAAIC,eAAY;8BAAUH,SAASI,MAAM;;YACnD;YAEApB,iCAAmB,qBAACe;YAEpB,MAAM4B,IAAAA,eAAO,EAAC;gBACZd,OAAOC,cAAM,CAACC,WAAW,CAAC,WAAWC,iBAAiB,CAAC;YACzD,GAAG;gBAAEqC,SAAS;YAAK;YAEnBxC,OAAOtD,WAAW2E,qBAAqB,CAAC;QAC1C;QAEApC,GAAG,oDAAoD;YACrD,oDAAoD;YACpD,MAAMqI,qBAAqBzK,OAAO0K,UAAU;YAC5C1K,OAAO0K,UAAU,GAAG,MAAMC;gBAKxBC,cAAcC,IAAU,EAAE;oBACxBjE,WAAW;wBACT,IAAI,IAAI,CAACkD,OAAO,EAAE;4BAChB,IAAI,CAACA,OAAO,CAAC;gCAAEgB,QAAQ;oCAAE5H,OAAO,IAAI8C,MAAM;gCAAuB;4BAAE;wBACrE;oBACF,GAAG;gBACL;;yBAVA6D,SAAwC;yBACxCC,UAAyC;yBACzCiB,SAAwB;;YAS1B;YAEA,MAAMf,WAAWzB,eAAe,eAAe;YAE/C,MAAMlG,gBAAgB;gBACpB,MAAMC,WAAWC,IAAAA,kCAAgB,EAAC;oBAAE0D,aAAa;gBAAM;gBAEvDpC,cAAK,CAACC,SAAS,CAAC;oBACdxB,SAASiB,MAAM,CAAC;wBACd3B,YAAYoI;wBACZnI,eAAe,EAAE;oBACnB;gBACF,GAAG,EAAE;gBAEL,qBACE,sBAACW;;sCACC,qBAACA;4BAAIC,eAAY;sCAAUH,SAASI,MAAM;;sCAC1C,qBAACF;4BAAIC,eAAY;sCAAYH,SAASQ,OAAO,CAACF,QAAQ;;;;YAG5D;YAEAtB,iCAAmB,qBAACe;YAEpB,MAAM4B,IAAAA,eAAO,EAAC;gBACZd,OAAOC,cAAM,CAACC,WAAW,CAAC,WAAWC,iBAAiB,CAAC;YACzD,GAAG;gBAAEqC,SAAS;YAAK;YAEnBxC,OAAOC,cAAM,CAACC,WAAW,CAAC,aAAaC,iBAAiB,CAAC;YAEzD,qBAAqB;YACrBtD,OAAO0K,UAAU,GAAGD;QACtB;QAEArI,GAAG,8DAA8D;YAC/DvC,UAAU6D,qBAAqB,CAAC;gBAC9BC,IAAI;gBACJC,MAAM,UAAY9B;YACpB;YAEA,MAAMkI,WAAWzB,eAAe,YAAY;YAE5C,MAAMlG,gBAAgB;gBACpB,MAAMC,WAAWC,IAAAA,kCAAgB,EAAC;oBAAE0D,aAAa;gBAAM;gBAEvDpC,cAAK,CAACC,SAAS,CAAC;oBACdxB,SAASiB,MAAM,CAAC;wBACd3B,YAAYoI;wBACZnI,eAAe;4BAACmI;yBAAS;oBAC3B;gBACF,GAAG,EAAE;gBAEL,qBAAO,qBAACxH;oBAAIC,eAAY;8BAAUH,SAASI,MAAM;;YACnD;YAEApB,iCAAmB,qBAACe;YAEpB,MAAM4B,IAAAA,eAAO,EAAC;gBACZd,OAAOC,cAAM,CAACC,WAAW,CAAC,WAAWC,iBAAiB,CAAC;YACzD;YAEA,MAAM,CAAC0H,KAAK/F,YAAY,GAAGpF,UAAUqF,IAAI,CAACC,KAAK,CAAC,EAAE;YAClDhC,OAAO6H,KAAK1G,IAAI,CAAC;YAEjB,MAAMc,cAAcrB,KAAKM,KAAK,CAACY,YAAYL,IAAI;YAC/CzB,OAAOiC,YAAYxD,UAAU,EAAEqJ,OAAO,CAAC;YACvC9H,OAAOiC,YAAYvD,aAAa,EAAEqJ,YAAY,CAAC;YAC/C/H,OAAOiC,YAAYvD,aAAa,CAAC,EAAE,EAAEoJ,OAAO,CAAC;QAC/C;QAEA7I,GAAG,+DAA+D;YAChEvC,UAAU6D,qBAAqB,CAAC;gBAC9BC,IAAI;gBACJC,MAAM,UAAY9B;YACpB;YAEA,MAAMkI,WAAWzB,eAAe,YAAY;YAC5C,IAAI4C,kBAAuB;YAE3B,MAAMrE,YAAYhH,KAAKC,EAAE,CAAC,CAACkD,MAAM+D,WAAWuD;gBAC1CY,kBAAkBZ;YACpB;YAEA,MAAMlI,gBAAgB;gBACpB,MAAMC,WAAWC,IAAAA,kCAAgB,EAAC;oBAChC0D,aAAa;oBACba;gBACF;gBAEAjD,cAAK,CAACC,SAAS,CAAC;oBACdxB,SAASiB,MAAM,CAAC;wBACd3B,YAAYoI;wBACZnI,eAAe,EAAE;oBACnB;gBACF,GAAG,EAAE;gBAEL,qBAAO,qBAACW;oBAAIC,eAAY;8BAAUH,SAASI,MAAM;;YACnD;YAEApB,iCAAmB,qBAACe;YAEpB,MAAM4B,IAAAA,eAAO,EAAC;gBACZd,OAAOC,cAAM,CAACC,WAAW,CAAC,WAAWC,iBAAiB,CAAC;YACzD;YAEAH,OAAO2D,WAAWsE,gBAAgB;YAClCjI,OAAOgI,iBAAiBE,UAAU;YAClClI,OAAOgI,gBAAgBG,sBAAsB,EAAED,UAAU;YACzDlI,OAAOgI,gBAAgBG,sBAAsB,CAACC,mBAAmB,EAAEC,eAAe,CAAC;QACrF;IACF;AACF"}