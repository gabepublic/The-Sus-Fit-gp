{"version":3,"sources":["/Users/willstreeter/WebstormProjects/vibe-coding/those-people/The-Sus-Fit-gp/__tests__/api/tryon/route.integration.test.ts"],"sourcesContent":["import { POST, OPTIONS } from '../../../src/app/api/tryon/route';\n\n// Mock generateTryOn function\njest.mock('../../../src/lib/openaiClient', () => ({\n  generateTryOn: jest.fn()\n}));\n\n// Mock Next.js server components\njest.mock('next/server', () => {\n  const mockNextResponse = jest.fn((body, options) => ({\n    status: options?.status || 200,\n    headers: options?.headers || {},\n    json: jest.fn().mockResolvedValue(body)\n  }));\n  \n  (mockNextResponse as any).json = jest.fn((data, options) => ({\n    status: options?.status || 200,\n    json: jest.fn().mockResolvedValue(data),\n    headers: options?.headers || {}\n  }));\n  \n  return {\n    NextRequest: jest.fn(),\n    NextResponse: mockNextResponse\n  };\n});\n\ndescribe('/api/tryon Integration Tests', () => {\n  const { generateTryOn } = require('../../../src/lib/openaiClient');\n\n  // Valid base64 test data (1x1 pixel PNG)\n  const validBase64Image = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==';\n\n  const createMockRequest = (body: any, origin?: string | null) => {\n    return {\n      json: jest.fn().mockResolvedValue(body),\n      headers: {\n        get: jest.fn().mockReturnValue(origin)\n      }\n    } as any;\n  };\n\n  beforeEach(() => {\n    jest.clearAllMocks();\n    // Reset environment variables\n    delete (process.env as any).NEXT_PUBLIC_BASE_URL;\n    delete (process.env as any).NODE_ENV;\n  });\n\n  describe('POST /api/tryon - Success Cases', () => {\n    it('should return 200 with generated image for valid payload', async () => {\n      const mockGeneratedImage = 'img123';\n      (generateTryOn as jest.Mock).mockResolvedValue(mockGeneratedImage);\n\n      const validPayload = {\n        modelImage: validBase64Image,\n        apparelImages: [validBase64Image]\n      };\n\n      const request = createMockRequest(validPayload, 'http://localhost:3000');\n      const response = await POST(request);\n\n      expect(response.status).toBe(200);\n      const responseData = await response.json();\n      expect(responseData).toEqual({\n        img_generated: mockGeneratedImage\n      });\n\n      expect(generateTryOn).toHaveBeenCalledTimes(1);\n      expect(generateTryOn).toHaveBeenCalledWith({\n        modelImage: validPayload.modelImage,\n        apparelImages: validPayload.apparelImages\n      });\n\n      // Verify CORS headers are present\n      expect(response.headers).toMatchObject({\n        'Access-Control-Allow-Origin': 'http://localhost:3000',\n        'Access-Control-Allow-Methods': 'POST, OPTIONS',\n        'Access-Control-Allow-Headers': 'Content-Type'\n      });\n    });\n\n    it('should handle multiple apparel images correctly', async () => {\n      const mockGeneratedImage = 'img456';\n      (generateTryOn as jest.Mock).mockResolvedValue(mockGeneratedImage);\n\n      const validPayload = {\n        modelImage: validBase64Image,\n        apparelImages: [validBase64Image, validBase64Image]\n      };\n\n      const request = createMockRequest(validPayload, 'http://localhost:3000');\n      const response = await POST(request);\n\n      expect(response.status).toBe(200);\n      const responseData = await response.json();\n      expect(responseData).toEqual({\n        img_generated: mockGeneratedImage\n      });\n\n      expect(generateTryOn).toHaveBeenCalledWith({\n        modelImage: validPayload.modelImage,\n        apparelImages: validPayload.apparelImages\n      });\n    });\n  });\n\n  describe('POST /api/tryon - Validation Error Cases', () => {\n    it('should return 400 for missing apparelImages with Zod error', async () => {\n      const invalidPayload = {\n        modelImage: 'invalid-base64-data'\n        // Missing apparelImages\n      };\n\n      const request = createMockRequest(invalidPayload, 'http://localhost:3000');\n      const response = await POST(request);\n\n      expect(response.status).toBe(400);\n      const responseData = await response.json();\n      expect(responseData).toMatchObject({\n        error: 'Validation failed'\n      });\n\n      // Test Zod error message snapshot\n      expect(responseData.details).toMatchSnapshot();\n      expect(responseData.details).toHaveLength(2);\n      expect(responseData.details[0].field).toBe('modelImage');\n    });\n\n    it('should return 400 for empty apparelImages array', async () => {\n      const invalidPayload = {\n        modelImage: 'invalid-base64-data',\n        apparelImages: []\n      };\n\n      const request = createMockRequest(invalidPayload, 'http://localhost:3000');\n      const response = await POST(request);\n\n      expect(response.status).toBe(400);\n      const responseData = await response.json();\n      expect(responseData).toMatchObject({\n        error: 'Validation failed'\n      });\n\n      expect(responseData.details).toMatchSnapshot();\n      expect(responseData.details).toHaveLength(2);\n      expect(responseData.details[0].field).toBe('modelImage');\n    });\n\n    it('should return 400 for missing modelImage', async () => {\n      const invalidPayload = {\n        apparelImages: ['invalid-base64-data']\n        // Missing modelImage\n      };\n\n      const request = createMockRequest(invalidPayload, 'http://localhost:3000');\n      const response = await POST(request);\n\n      expect(response.status).toBe(400);\n      const responseData = await response.json();\n      expect(responseData).toMatchObject({\n        error: 'Validation failed'\n      });\n\n      expect(responseData.details).toMatchSnapshot();\n      expect(responseData.details).toHaveLength(2);\n      expect(responseData.details[0].field).toBe('modelImage');\n    });\n\n    it('should return 400 for invalid base64 data', async () => {\n      const invalidPayload = {\n        modelImage: 'invalid-base64-data',\n        apparelImages: ['invalid-base64-data']\n      };\n\n      const request = createMockRequest(invalidPayload, 'http://localhost:3000');\n      const response = await POST(request);\n\n      expect(response.status).toBe(400);\n      const responseData = await response.json();\n      expect(responseData).toMatchObject({\n        error: 'Validation failed'\n      });\n\n      expect(responseData.details).toMatchSnapshot();\n    });\n  });\n\n  describe('POST /api/tryon - Internal Error Cases', () => {\n    it('should return 500 when generateTryOn throws an error', async () => {\n      const validPayload = {\n        modelImage: validBase64Image,\n        apparelImages: [validBase64Image]\n      };\n\n      (generateTryOn as jest.Mock).mockRejectedValue(new Error('OpenAI API error'));\n\n      const request = createMockRequest(validPayload, 'http://localhost:3000');\n      const response = await POST(request);\n\n      expect(response.status).toBe(500);\n      const responseData = await response.json();\n      expect(responseData).toMatchObject({\n        error: 'Internal Server Error'\n      });\n\n      expect(generateTryOn).toHaveBeenCalledTimes(1);\n    });\n\n    it('should return 500 for malformed JSON', async () => {\n      const request = {\n        json: jest.fn().mockRejectedValue(new Error('Invalid JSON')),\n        headers: {\n          get: jest.fn().mockReturnValue('http://localhost:3000')\n        }\n      } as any;\n\n      const response = await POST(request);\n\n      expect(response.status).toBe(500);\n      const responseData = await response.json();\n      expect(responseData).toMatchObject({\n        error: 'Internal Server Error'\n      });\n    });\n\n    it('should return detailed error message in development environment', async () => {\n      (process.env as any).NODE_ENV = 'development';\n      \n      const validPayload = {\n        modelImage: validBase64Image,\n        apparelImages: [validBase64Image]\n      };\n\n      const errorMessage = 'Development error message';\n      (generateTryOn as jest.Mock).mockRejectedValue(new Error(errorMessage));\n\n      const request = createMockRequest(validPayload, 'http://localhost:3000');\n      const response = await POST(request);\n\n      expect(response.status).toBe(500);\n      const responseData = await response.json();\n      expect(responseData).toMatchObject({\n        error: errorMessage\n      });\n    });\n\n    it('should return generic error message in production environment', async () => {\n      (process.env as any).NODE_ENV = 'production';\n      \n      const validPayload = {\n        modelImage: validBase64Image,\n        apparelImages: [validBase64Image]\n      };\n\n      (generateTryOn as jest.Mock).mockRejectedValue(new Error('Production error message'));\n\n      const request = createMockRequest(validPayload, 'http://localhost:3000');\n      const response = await POST(request);\n\n      expect(response.status).toBe(500);\n      const responseData = await response.json();\n      expect(responseData).toMatchObject({\n        error: 'Internal Server Error'\n      });\n    });\n  });\n\n  describe('OPTIONS /api/tryon - CORS Preflight', () => {\n    it('should return 200 for OPTIONS preflight request', async () => {\n      const request = createMockRequest({}, 'http://localhost:3000');\n      const response = await OPTIONS(request);\n\n      expect(response.status).toBe(200);\n      expect(response.headers).toMatchObject({\n        'Access-Control-Allow-Origin': 'http://localhost:3000',\n        'Access-Control-Allow-Methods': 'POST, OPTIONS',\n        'Access-Control-Allow-Headers': 'Content-Type'\n      });\n    });\n\n    it('should use NEXT_PUBLIC_BASE_URL when origin header is null', async () => {\n      (process.env as any).NEXT_PUBLIC_BASE_URL = 'https://example.com';\n      \n      const request = createMockRequest({}, null);\n      const response = await OPTIONS(request);\n\n      expect(response.status).toBe(200);\n      expect(response.headers).toMatchObject({\n        'Access-Control-Allow-Origin': 'https://example.com',\n        'Access-Control-Allow-Methods': 'POST, OPTIONS',\n        'Access-Control-Allow-Headers': 'Content-Type'\n      });\n    });\n\n    it('should use empty string when both origin header and NEXT_PUBLIC_BASE_URL are null/undefined', async () => {\n      const request = createMockRequest({}, null);\n      const response = await OPTIONS(request);\n\n      expect(response.status).toBe(200);\n      expect(response.headers).toMatchObject({\n        'Access-Control-Allow-Origin': '',\n        'Access-Control-Allow-Methods': 'POST, OPTIONS',\n        'Access-Control-Allow-Headers': 'Content-Type'\n      });\n    });\n  });\n\n  describe('CORS Headers in POST Responses', () => {\n    it('should include CORS headers in successful POST response', async () => {\n      const mockGeneratedImage = 'img123';\n      (generateTryOn as jest.Mock).mockResolvedValue(mockGeneratedImage);\n\n      const validPayload = {\n        modelImage: validBase64Image,\n        apparelImages: [validBase64Image]\n      };\n\n      const request = createMockRequest(validPayload, 'http://localhost:3000');\n      const response = await POST(request);\n\n      expect(response.status).toBe(200);\n      expect(response.headers).toMatchObject({\n        'Access-Control-Allow-Origin': 'http://localhost:3000',\n        'Access-Control-Allow-Methods': 'POST, OPTIONS',\n        'Access-Control-Allow-Headers': 'Content-Type'\n      });\n    });\n\n    it('should include CORS headers in error responses', async () => {\n      const invalidPayload = {\n        modelImage: validBase64Image\n        // Missing apparelImages\n      };\n\n      const request = createMockRequest(invalidPayload, 'http://localhost:3000');\n      const response = await POST(request);\n\n      expect(response.status).toBe(400);\n      expect(response.headers).toMatchObject({\n        'Access-Control-Allow-Origin': 'http://localhost:3000',\n        'Access-Control-Allow-Methods': 'POST, OPTIONS',\n        'Access-Control-Allow-Headers': 'Content-Type'\n      });\n    });\n\n    it('should include CORS headers in internal error responses', async () => {\n      const validPayload = {\n        modelImage: validBase64Image,\n        apparelImages: [validBase64Image]\n      };\n\n      (generateTryOn as jest.Mock).mockRejectedValue(new Error('Test error'));\n\n      const request = createMockRequest(validPayload, 'http://localhost:3000');\n      const response = await POST(request);\n\n      expect(response.status).toBe(500);\n      expect(response.headers).toMatchObject({\n        'Access-Control-Allow-Origin': 'http://localhost:3000',\n        'Access-Control-Allow-Methods': 'POST, OPTIONS',\n        'Access-Control-Allow-Headers': 'Content-Type'\n      });\n    });\n  });\n});\n"],"names":["jest","mock","generateTryOn","fn","mockNextResponse","body","options","status","headers","json","mockResolvedValue","data","NextRequest","NextResponse","describe","require","validBase64Image","createMockRequest","origin","get","mockReturnValue","beforeEach","clearAllMocks","process","env","NEXT_PUBLIC_BASE_URL","NODE_ENV","it","mockGeneratedImage","validPayload","modelImage","apparelImages","request","response","POST","expect","toBe","responseData","toEqual","img_generated","toHaveBeenCalledTimes","toHaveBeenCalledWith","toMatchObject","invalidPayload","error","details","toMatchSnapshot","toHaveLength","field","mockRejectedValue","Error","errorMessage","OPTIONS"],"mappings":";AAEA,8BAA8B;AAC9BA,KAAKC,IAAI,CAAC,iCAAiC,IAAO,CAAA;QAChDC,eAAeF,KAAKG,EAAE;IACxB,CAAA;AAEA,iCAAiC;AACjCH,KAAKC,IAAI,CAAC,eAAe;IACvB,MAAMG,mBAAmBJ,KAAKG,EAAE,CAAC,CAACE,MAAMC,UAAa,CAAA;YACnDC,QAAQD,SAASC,UAAU;YAC3BC,SAASF,SAASE,WAAW,CAAC;YAC9BC,MAAMT,KAAKG,EAAE,GAAGO,iBAAiB,CAACL;QACpC,CAAA;IAECD,iBAAyBK,IAAI,GAAGT,KAAKG,EAAE,CAAC,CAACQ,MAAML,UAAa,CAAA;YAC3DC,QAAQD,SAASC,UAAU;YAC3BE,MAAMT,KAAKG,EAAE,GAAGO,iBAAiB,CAACC;YAClCH,SAASF,SAASE,WAAW,CAAC;QAChC,CAAA;IAEA,OAAO;QACLI,aAAaZ,KAAKG,EAAE;QACpBU,cAAcT;IAChB;AACF;;;;uBAzB8B;AA2B9BU,SAAS,gCAAgC;IACvC,MAAM,EAAEZ,aAAa,EAAE,GAAGa,QAAQ;IAElC,yCAAyC;IACzC,MAAMC,mBAAmB;IAEzB,MAAMC,oBAAoB,CAACZ,MAAWa;QACpC,OAAO;YACLT,MAAMT,KAAKG,EAAE,GAAGO,iBAAiB,CAACL;YAClCG,SAAS;gBACPW,KAAKnB,KAAKG,EAAE,GAAGiB,eAAe,CAACF;YACjC;QACF;IACF;IAEAG,WAAW;QACTrB,KAAKsB,aAAa;QAClB,8BAA8B;QAC9B,OAAO,AAACC,QAAQC,GAAG,CAASC,oBAAoB;QAChD,OAAO,AAACF,QAAQC,GAAG,CAASE,QAAQ;IACtC;IAEAZ,SAAS,mCAAmC;QAC1Ca,GAAG,4DAA4D;YAC7D,MAAMC,qBAAqB;YAC1B1B,cAA4BQ,iBAAiB,CAACkB;YAE/C,MAAMC,eAAe;gBACnBC,YAAYd;gBACZe,eAAe;oBAACf;iBAAiB;YACnC;YAEA,MAAMgB,UAAUf,kBAAkBY,cAAc;YAChD,MAAMI,WAAW,MAAMC,IAAAA,WAAI,EAACF;YAE5BG,OAAOF,SAAS1B,MAAM,EAAE6B,IAAI,CAAC;YAC7B,MAAMC,eAAe,MAAMJ,SAASxB,IAAI;YACxC0B,OAAOE,cAAcC,OAAO,CAAC;gBAC3BC,eAAeX;YACjB;YAEAO,OAAOjC,eAAesC,qBAAqB,CAAC;YAC5CL,OAAOjC,eAAeuC,oBAAoB,CAAC;gBACzCX,YAAYD,aAAaC,UAAU;gBACnCC,eAAeF,aAAaE,aAAa;YAC3C;YAEA,kCAAkC;YAClCI,OAAOF,SAASzB,OAAO,EAAEkC,aAAa,CAAC;gBACrC,+BAA+B;gBAC/B,gCAAgC;gBAChC,gCAAgC;YAClC;QACF;QAEAf,GAAG,mDAAmD;YACpD,MAAMC,qBAAqB;YAC1B1B,cAA4BQ,iBAAiB,CAACkB;YAE/C,MAAMC,eAAe;gBACnBC,YAAYd;gBACZe,eAAe;oBAACf;oBAAkBA;iBAAiB;YACrD;YAEA,MAAMgB,UAAUf,kBAAkBY,cAAc;YAChD,MAAMI,WAAW,MAAMC,IAAAA,WAAI,EAACF;YAE5BG,OAAOF,SAAS1B,MAAM,EAAE6B,IAAI,CAAC;YAC7B,MAAMC,eAAe,MAAMJ,SAASxB,IAAI;YACxC0B,OAAOE,cAAcC,OAAO,CAAC;gBAC3BC,eAAeX;YACjB;YAEAO,OAAOjC,eAAeuC,oBAAoB,CAAC;gBACzCX,YAAYD,aAAaC,UAAU;gBACnCC,eAAeF,aAAaE,aAAa;YAC3C;QACF;IACF;IAEAjB,SAAS,4CAA4C;QACnDa,GAAG,8DAA8D;YAC/D,MAAMgB,iBAAiB;gBACrBb,YAAY;YAEd;YAEA,MAAME,UAAUf,kBAAkB0B,gBAAgB;YAClD,MAAMV,WAAW,MAAMC,IAAAA,WAAI,EAACF;YAE5BG,OAAOF,SAAS1B,MAAM,EAAE6B,IAAI,CAAC;YAC7B,MAAMC,eAAe,MAAMJ,SAASxB,IAAI;YACxC0B,OAAOE,cAAcK,aAAa,CAAC;gBACjCE,OAAO;YACT;YAEA,kCAAkC;YAClCT,OAAOE,aAAaQ,OAAO,EAAEC,eAAe;YAC5CX,OAAOE,aAAaQ,OAAO,EAAEE,YAAY,CAAC;YAC1CZ,OAAOE,aAAaQ,OAAO,CAAC,EAAE,CAACG,KAAK,EAAEZ,IAAI,CAAC;QAC7C;QAEAT,GAAG,mDAAmD;YACpD,MAAMgB,iBAAiB;gBACrBb,YAAY;gBACZC,eAAe,EAAE;YACnB;YAEA,MAAMC,UAAUf,kBAAkB0B,gBAAgB;YAClD,MAAMV,WAAW,MAAMC,IAAAA,WAAI,EAACF;YAE5BG,OAAOF,SAAS1B,MAAM,EAAE6B,IAAI,CAAC;YAC7B,MAAMC,eAAe,MAAMJ,SAASxB,IAAI;YACxC0B,OAAOE,cAAcK,aAAa,CAAC;gBACjCE,OAAO;YACT;YAEAT,OAAOE,aAAaQ,OAAO,EAAEC,eAAe;YAC5CX,OAAOE,aAAaQ,OAAO,EAAEE,YAAY,CAAC;YAC1CZ,OAAOE,aAAaQ,OAAO,CAAC,EAAE,CAACG,KAAK,EAAEZ,IAAI,CAAC;QAC7C;QAEAT,GAAG,4CAA4C;YAC7C,MAAMgB,iBAAiB;gBACrBZ,eAAe;oBAAC;iBAAsB;YAExC;YAEA,MAAMC,UAAUf,kBAAkB0B,gBAAgB;YAClD,MAAMV,WAAW,MAAMC,IAAAA,WAAI,EAACF;YAE5BG,OAAOF,SAAS1B,MAAM,EAAE6B,IAAI,CAAC;YAC7B,MAAMC,eAAe,MAAMJ,SAASxB,IAAI;YACxC0B,OAAOE,cAAcK,aAAa,CAAC;gBACjCE,OAAO;YACT;YAEAT,OAAOE,aAAaQ,OAAO,EAAEC,eAAe;YAC5CX,OAAOE,aAAaQ,OAAO,EAAEE,YAAY,CAAC;YAC1CZ,OAAOE,aAAaQ,OAAO,CAAC,EAAE,CAACG,KAAK,EAAEZ,IAAI,CAAC;QAC7C;QAEAT,GAAG,6CAA6C;YAC9C,MAAMgB,iBAAiB;gBACrBb,YAAY;gBACZC,eAAe;oBAAC;iBAAsB;YACxC;YAEA,MAAMC,UAAUf,kBAAkB0B,gBAAgB;YAClD,MAAMV,WAAW,MAAMC,IAAAA,WAAI,EAACF;YAE5BG,OAAOF,SAAS1B,MAAM,EAAE6B,IAAI,CAAC;YAC7B,MAAMC,eAAe,MAAMJ,SAASxB,IAAI;YACxC0B,OAAOE,cAAcK,aAAa,CAAC;gBACjCE,OAAO;YACT;YAEAT,OAAOE,aAAaQ,OAAO,EAAEC,eAAe;QAC9C;IACF;IAEAhC,SAAS,0CAA0C;QACjDa,GAAG,wDAAwD;YACzD,MAAME,eAAe;gBACnBC,YAAYd;gBACZe,eAAe;oBAACf;iBAAiB;YACnC;YAECd,cAA4B+C,iBAAiB,CAAC,IAAIC,MAAM;YAEzD,MAAMlB,UAAUf,kBAAkBY,cAAc;YAChD,MAAMI,WAAW,MAAMC,IAAAA,WAAI,EAACF;YAE5BG,OAAOF,SAAS1B,MAAM,EAAE6B,IAAI,CAAC;YAC7B,MAAMC,eAAe,MAAMJ,SAASxB,IAAI;YACxC0B,OAAOE,cAAcK,aAAa,CAAC;gBACjCE,OAAO;YACT;YAEAT,OAAOjC,eAAesC,qBAAqB,CAAC;QAC9C;QAEAb,GAAG,wCAAwC;YACzC,MAAMK,UAAU;gBACdvB,MAAMT,KAAKG,EAAE,GAAG8C,iBAAiB,CAAC,IAAIC,MAAM;gBAC5C1C,SAAS;oBACPW,KAAKnB,KAAKG,EAAE,GAAGiB,eAAe,CAAC;gBACjC;YACF;YAEA,MAAMa,WAAW,MAAMC,IAAAA,WAAI,EAACF;YAE5BG,OAAOF,SAAS1B,MAAM,EAAE6B,IAAI,CAAC;YAC7B,MAAMC,eAAe,MAAMJ,SAASxB,IAAI;YACxC0B,OAAOE,cAAcK,aAAa,CAAC;gBACjCE,OAAO;YACT;QACF;QAEAjB,GAAG,mEAAmE;YACnEJ,QAAQC,GAAG,CAASE,QAAQ,GAAG;YAEhC,MAAMG,eAAe;gBACnBC,YAAYd;gBACZe,eAAe;oBAACf;iBAAiB;YACnC;YAEA,MAAMmC,eAAe;YACpBjD,cAA4B+C,iBAAiB,CAAC,IAAIC,MAAMC;YAEzD,MAAMnB,UAAUf,kBAAkBY,cAAc;YAChD,MAAMI,WAAW,MAAMC,IAAAA,WAAI,EAACF;YAE5BG,OAAOF,SAAS1B,MAAM,EAAE6B,IAAI,CAAC;YAC7B,MAAMC,eAAe,MAAMJ,SAASxB,IAAI;YACxC0B,OAAOE,cAAcK,aAAa,CAAC;gBACjCE,OAAOO;YACT;QACF;QAEAxB,GAAG,iEAAiE;YACjEJ,QAAQC,GAAG,CAASE,QAAQ,GAAG;YAEhC,MAAMG,eAAe;gBACnBC,YAAYd;gBACZe,eAAe;oBAACf;iBAAiB;YACnC;YAECd,cAA4B+C,iBAAiB,CAAC,IAAIC,MAAM;YAEzD,MAAMlB,UAAUf,kBAAkBY,cAAc;YAChD,MAAMI,WAAW,MAAMC,IAAAA,WAAI,EAACF;YAE5BG,OAAOF,SAAS1B,MAAM,EAAE6B,IAAI,CAAC;YAC7B,MAAMC,eAAe,MAAMJ,SAASxB,IAAI;YACxC0B,OAAOE,cAAcK,aAAa,CAAC;gBACjCE,OAAO;YACT;QACF;IACF;IAEA9B,SAAS,uCAAuC;QAC9Ca,GAAG,mDAAmD;YACpD,MAAMK,UAAUf,kBAAkB,CAAC,GAAG;YACtC,MAAMgB,WAAW,MAAMmB,IAAAA,cAAO,EAACpB;YAE/BG,OAAOF,SAAS1B,MAAM,EAAE6B,IAAI,CAAC;YAC7BD,OAAOF,SAASzB,OAAO,EAAEkC,aAAa,CAAC;gBACrC,+BAA+B;gBAC/B,gCAAgC;gBAChC,gCAAgC;YAClC;QACF;QAEAf,GAAG,8DAA8D;YAC9DJ,QAAQC,GAAG,CAASC,oBAAoB,GAAG;YAE5C,MAAMO,UAAUf,kBAAkB,CAAC,GAAG;YACtC,MAAMgB,WAAW,MAAMmB,IAAAA,cAAO,EAACpB;YAE/BG,OAAOF,SAAS1B,MAAM,EAAE6B,IAAI,CAAC;YAC7BD,OAAOF,SAASzB,OAAO,EAAEkC,aAAa,CAAC;gBACrC,+BAA+B;gBAC/B,gCAAgC;gBAChC,gCAAgC;YAClC;QACF;QAEAf,GAAG,+FAA+F;YAChG,MAAMK,UAAUf,kBAAkB,CAAC,GAAG;YACtC,MAAMgB,WAAW,MAAMmB,IAAAA,cAAO,EAACpB;YAE/BG,OAAOF,SAAS1B,MAAM,EAAE6B,IAAI,CAAC;YAC7BD,OAAOF,SAASzB,OAAO,EAAEkC,aAAa,CAAC;gBACrC,+BAA+B;gBAC/B,gCAAgC;gBAChC,gCAAgC;YAClC;QACF;IACF;IAEA5B,SAAS,kCAAkC;QACzCa,GAAG,2DAA2D;YAC5D,MAAMC,qBAAqB;YAC1B1B,cAA4BQ,iBAAiB,CAACkB;YAE/C,MAAMC,eAAe;gBACnBC,YAAYd;gBACZe,eAAe;oBAACf;iBAAiB;YACnC;YAEA,MAAMgB,UAAUf,kBAAkBY,cAAc;YAChD,MAAMI,WAAW,MAAMC,IAAAA,WAAI,EAACF;YAE5BG,OAAOF,SAAS1B,MAAM,EAAE6B,IAAI,CAAC;YAC7BD,OAAOF,SAASzB,OAAO,EAAEkC,aAAa,CAAC;gBACrC,+BAA+B;gBAC/B,gCAAgC;gBAChC,gCAAgC;YAClC;QACF;QAEAf,GAAG,kDAAkD;YACnD,MAAMgB,iBAAiB;gBACrBb,YAAYd;YAEd;YAEA,MAAMgB,UAAUf,kBAAkB0B,gBAAgB;YAClD,MAAMV,WAAW,MAAMC,IAAAA,WAAI,EAACF;YAE5BG,OAAOF,SAAS1B,MAAM,EAAE6B,IAAI,CAAC;YAC7BD,OAAOF,SAASzB,OAAO,EAAEkC,aAAa,CAAC;gBACrC,+BAA+B;gBAC/B,gCAAgC;gBAChC,gCAAgC;YAClC;QACF;QAEAf,GAAG,2DAA2D;YAC5D,MAAME,eAAe;gBACnBC,YAAYd;gBACZe,eAAe;oBAACf;iBAAiB;YACnC;YAECd,cAA4B+C,iBAAiB,CAAC,IAAIC,MAAM;YAEzD,MAAMlB,UAAUf,kBAAkBY,cAAc;YAChD,MAAMI,WAAW,MAAMC,IAAAA,WAAI,EAACF;YAE5BG,OAAOF,SAAS1B,MAAM,EAAE6B,IAAI,CAAC;YAC7BD,OAAOF,SAASzB,OAAO,EAAEkC,aAAa,CAAC;gBACrC,+BAA+B;gBAC/B,gCAAgC;gBAChC,gCAAgC;YAClC;QACF;IACF;AACF"}